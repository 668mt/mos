(function(e){function t(t){for(var n,s,o=t[0],c=t[1],l=t[2],d=0,h=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&h.push(r[s][0]),r[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(h.length)h.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,o=1;o<a.length;o++){var c=a[o];0!==r[c]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},r={app:0},i=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var n=a("85ec"),r=a.n(n);r.a},"06be":function(e,t,a){},"0a78":function(e,t,a){"use strict";var n=a("7fb9"),r=a.n(n);r.a},"0e76":function(e,t,a){},"11e2":function(e,t,a){"use strict";var n=a("7e3e"),r=a.n(n);r.a},"18d9":function(e,t,a){"use strict";var n=a("06be"),r=a.n(n);r.a},"18ee":function(e,t,a){"use strict";var n=a("b6b7"),r=a.n(n);r.a},"1a47":function(e,t,a){a("fb6a"),a("d3b7"),a("25f0");var n=function(e){var t="";for(var a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t.length>0&&(t=t.substring(0,t.length-1)),t},r=function(e){return Object.prototype.toString.call(e).slice(8,-1)},i=function e(t){var a,n=r(t);if("Object"===n)a={};else{if("Array"!==n)return t;a=[]}for(var i in t){var s=t[i];"Object"===r(s)||"Array"===r(s)?a[i]=e(s):a[i]=s}return a},s=function e(t){var a,n=r(t);if("array"===n)a=[];else{if("object"!==n)return t;a={}}if("array"===n)for(var i=0,s=t.length;i<s;i++)a.push(e(t[i]));else if("object"===n)for(var o in t)a[o]=e(t[o]);return a},o=function(e,t){if(!e)return!1;for(var a=0;a<e.length;a++)if(e[a]===t)return!0;return!1};e.exports={transformFormData:n,deepClone:s,deepCopy:i,contains:o}},"2bcd":function(e,t,a){"use strict";var n=a("4fa0"),r=a.n(n);r.a},3148:function(e,t,a){a("99af");var n=["left","right"],r=["down","up","left","right"],i=["downBig","upBig","leftBig","rightBig"],s=["topLeft","bottomRight","topRight","bottomLeft"],o=["downLeft","upRight","downRight","upLeft"];e.exports=[{name:"back",alias:"后位",directions:r},{name:"bounce",alias:"弹跳",directions:r.concat("default")},{name:"fade",alias:"淡化",directions:r.concat(i).concat(s).concat("default")},{name:"flip",alias:"翻转",directions:["x","y","default"]},{name:"lightSpeed",alias:"光速",directions:n},{name:"rotate",alias:"旋转",directions:o.concat("default")},{name:"roll",alias:"翻滚",directions:["default"]},{name:"zoom",alias:"缩放",directions:r.concat("default")},{name:"slide",alias:"滑动",directions:r}]},"314d":function(e,t,a){},"37a7":function(e,t,a){"use strict";var n=a("8121"),r=a.n(n);r.a},"39be":function(e,t,a){"use strict";var n=a("46bb"),r=a.n(n);r.a},"3be6":function(e,t,a){},4635:function(e,t,a){"use strict";var n=a("90bc"),r=a.n(n);r.a},4678:function(e,t,a){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function r(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id="4678"},"46bb":function(e,t,a){},"4fa0":function(e,t,a){},"4ffd":function(e,t,a){e.exports=a.p+"img/logo.18513d71.png"},"51d3":function(e,t,a){"use strict";var n=a("d1f9"),r=a.n(n);r.a},5573:function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("d3b7"),a("ac1f"),a("8a79"),a("5319");var n,r=a("b85c"),i=(a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("2b0e")),s=a("f23d"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},c=[],l={name:"App",components:{}},u=l,d=(a("034f"),a("2877")),h=Object(d["a"])(u,o,c,!1,null,null,null),p=h.exports,m=(a("202f"),a("8c4f")),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"content"},[e._m(0),a("div",{staticClass:"login"},[a("a-form",{staticClass:"login-form",attrs:{id:"components-form-demo-normal-login",form:e.form},on:{submit:e.handleSubmit}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",{rules:[{required:!0,message:"请输入用户名!"}]}],expression:"['username',{ rules: [{ required: true, message: '请输入用户名!' }] },]"}],attrs:{placeholder:"用户名"},on:{change:e.usernameChange}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"请输入密码!"}]}],expression:"['password',{ rules: [{ required: true, message: '请输入密码!' }] },]"}],attrs:{type:"password",placeholder:"密码"}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),e.needCode?a("a-form-item",[a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{span:14}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["code",{rules:[{required:!0,message:"请输入验证码!"}]}],expression:"['code',{ rules: [{ required: true, message: '请输入验证码!' }] },]"}],attrs:{type:"text",placeholder:"验证码"}})],1),a("a-col",{attrs:{span:10}},[a("img",{attrs:{src:e.codeSrc},on:{click:e.changeCode}})])],1)],1):e._e(),a("a-form-item",[a("a-button",{staticClass:"login-form-button",attrs:{type:"primary","html-type":"submit"}},[e._v(" 登录 ")])],1)],1)],1)])])},g=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"top"},[n("div",{staticClass:"header"},[n("img",{staticClass:"logo",attrs:{alt:"logo",src:a("4ffd")}}),n("span",{staticClass:"title"},[e._v("MOS")])]),n("div",{staticClass:"desc"},[e._v("对象存储服务")])])}],b=a("5530"),v={beforeCreate:function(){this.form=this.$form.createForm(this,{name:"normal_login"})},data:function(){return{codeSrc:"/kaptcha",needCode:!1}},methods:{changeCode:function(){this.codeSrc="/kaptcha?t="+Math.random()},usernameChange:function(e){var t=e.target.value;this.checkNeedCode(t)},checkNeedCode:function(e){var t=this;this.$http.get("/kaptcha/check/"+e).then((function(e){t.needCode=e.data.result}))},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,a){e||t.$http.post("/login",Object(b["a"])({},a),{transformRequest:[t.$mt.transformFormData]}).then((function(e){"ok"===e.data.status?(window.localStorage.setItem("currentUser",JSON.stringify(e.data.result)),t.$message.success(e.data.message),t.refreshPerm(),t.$router.replace({path:"/home"})):(t.$message.error(e.data.message),t.checkNeedCode(a.username),t.changeCode())}),(function(e){t.checkNeedCode(a.username),t.changeCode()}))}))}}},y=v,k=(a("b6d5"),Object(d["a"])(y,f,g,!1,null,"484807ed",null)),x=k.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("global-layout",[a("contextmenu",{attrs:{itemList:e.menuItemList,visible:e.menuVisible},on:{"update:visible":function(t){e.menuVisible=t},select:e.onMenuSelect}}),e.multiPage?a("a-tabs",{staticStyle:{"margin-top":"-8px","margin-bottom":"8px"},attrs:{"active-key":e.activePage,"hide-add":!0,type:"editable-card"},on:{change:e.changePage,edit:e.editPage},nativeOn:{contextmenu:function(t){return function(t){return e.onContextmenu(t)}(t)}}},e._l(e.pageList,(function(t){return a("a-tab-pane",{key:t.fullPath},[a("span",{attrs:{slot:"tab",pagekey:t.fullPath},slot:"tab"},[e._v(e._s(t.name))])])})),1):e._e(),a("div",{staticClass:"menu-view-content"},[a("page-toggle-transition",{attrs:{animate:e.animate.name,direction:e.animate.direction}},[e.multiPage?a("keep-alive",[a("router-view")],1):a("router-view")],1)],1)],1)},_=[],S=(a("4de4"),a("c975"),a("fb6a"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-config-provider",{attrs:{locale:e.locale}},[a("a-layout",{staticClass:"global-layout"},[e.isMobile?a("drawer",{attrs:{openDrawer:e.collapsed},on:{change:e.onDrawerChange}},[a("sider-menu",{attrs:{theme:e.theme,menuData:e.menuData,collapsed:!1,collapsible:!1},on:{menuSelect:e.onMenuSelect}})],1):"side"===e.layout?a("sider-menu",{attrs:{theme:e.theme,menuData:e.menuData,collapsed:e.collapsed,collapsible:!0}}):e._e(),a("a-layout",{staticClass:"global-layout-main"},[a("global-header",{attrs:{menuData:e.menuData,collapsed:e.collapsed},on:{toggleCollapse:e.toggleCollapse}}),a("a-layout-content",{staticClass:"global-layout-content",style:{minHeight:e.minHeight,padding:"24px 24px 0",position:"relative"}},[e._t("default")],2)],1)],1)],1)}),C=[],D=(a("7db0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-layout-header",{class:[e.theme,"global-header"]},[n("div",{class:["global-header-wide",e.layout]},[e.isMobile||"head"===e.layout?n("router-link",{class:["logo",e.isMobile?null:"pc",e.theme],attrs:{to:"/"}},[n("img",{attrs:{width:"32",src:a("4ffd")}}),e.isMobile?e._e():n("h1",[e._v(e._s(e.systemName))])]):e._e(),e.isMobile?n("a-divider",{attrs:{type:"vertical"}}):e._e(),"side"===e.layout?n("a-icon",{staticClass:"trigger",attrs:{type:e.collapsed?"menu-unfold":"menu-fold"},on:{click:e.toggleCollapse}}):e._e(),"head"===e.layout?n("div",{staticClass:"global-header-menu"},[n("i-menu",{staticStyle:{height:"64px","line-height":"64px"},attrs:{theme:e.theme,mode:"horizontal",menuData:e.menuData},on:{select:e.onSelect}})],1):e._e(),n("div",{class:["global-header-right",e.theme]},[n("header-avatar",{staticClass:"header-item"})],1)],1)])}),P=[],j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"header-search"},[a("a-icon",{staticClass:"search-icon",attrs:{type:"search"},on:{click:e.enterSearchMode}}),a("a-auto-complete",{ref:"input",class:["search-input",e.searchMode?"enter":"leave"],attrs:{dataSource:e.dataSource,placeholder:"站内搜索"},on:{blur:e.leaveSearchMode}})],1)},F=[],$={name:"HeaderSearch",data:function(){return{dataSource:["选项一","选项二"],searchMode:!1}},methods:{enterSearchMode:function(){var e=this;this.searchMode=!0,setTimeout((function(){return e.$refs.input.focus()}),300)},leaveSearchMode:function(){this.searchMode=!1}}},I=$,O=(a("bf50"),Object(d["a"])(I,j,F,!1,null,null,null)),L=(O.exports,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-dropdown",{attrs:{trigger:["click"]}},[a("template",{slot:"overlay"},[a("a-spin",{attrs:{spinning:e.loadding}},[a("a-tabs",{style:{backgroundColor:"white",width:"297px"},attrs:{tabBarStyle:{textAlign:"center"}}},[a("a-tab-pane",{key:"1",style:{padding:"0 24px"},attrs:{tab:"通知"}},[a("a-list",[a("a-list-item",[a("a-list-item-meta",{attrs:{title:"你收到了 14 份新周报",description:"一年前"}},[a("a-avatar",{staticStyle:{"background-color":"white"},attrs:{slot:"avatar",src:"https://gw.alipayobjects.com/zos/rmsportal/ThXAXghbEsBCCSDihZxY.png"},slot:"avatar"})],1)],1),a("a-list-item",[a("a-list-item-meta",{attrs:{title:"你推荐的 曲妮妮 已通过第三轮面试",description:"一年前"}},[a("a-avatar",{staticStyle:{"background-color":"white"},attrs:{slot:"avatar",src:"https://gw.alipayobjects.com/zos/rmsportal/OKJXDXrmkNshAMvwtvhu.png"},slot:"avatar"})],1)],1),a("a-list-item",[a("a-list-item-meta",{attrs:{title:"这种模板可以区分多种通知类型",description:"一年前"}},[a("a-avatar",{staticStyle:{"background-color":"white"},attrs:{slot:"avatar",src:"https://gw.alipayobjects.com/zos/rmsportal/kISTdvpyTAhtGxpovNWd.png"},slot:"avatar"})],1)],1)],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:"消息"}},[e._v(" 暂无消息 ")]),a("a-tab-pane",{key:"3",attrs:{tab:"待办"}},[e._v(" 暂无待办 ")])],1)],1)],1),a("span",{staticClass:"header-notice",on:{click:e.fetchNotice}},[a("a-badge",{attrs:{count:"12"}},[a("a-icon",{class:["header-notice-icon",e.theme],attrs:{type:"bell"}})],1)],1)],2)}),N=[],R={name:"HeaderNotice",data:function(){return{loadding:!1}},computed:{theme:function(){return"side"===this.$store.state.setting.layout?"light":this.$store.state.setting.theme}},methods:{fetchNotice:function(){var e=this;this.loadding?this.loadding=!1:(this.loadding=!0,setTimeout((function(){e.loadding=!1}),2e3))}}},B=R,E=(a("0a78"),Object(d["a"])(B,L,N,!1,null,null,null)),T=(E.exports,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-dropdown",{staticStyle:{display:"inline-block",height:"100%","vertical-align":"initial"}},[a("span",{staticStyle:{cursor:"pointer"}},[a("a-avatar",{staticStyle:{backgroundColor:"#f56a00"},attrs:{size:"large"}},[e._v(" "+e._s(e.currentName)+" ")])],1),a("a-menu",{staticStyle:{width:"150px"},attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{on:{click:e.onEditUser}},[a("a-icon",{attrs:{type:"user"}}),a("span",[e._v("个人中心")])],1),a("a-menu-item",[a("router-link",{attrs:{to:"/login"}},[a("a-icon",{attrs:{type:"poweroff"}}),a("span",[e._v("退出登录")])],1)],1)],1)],1),a("a-modal",{attrs:{title:"用户详情",cancelText:"取消",okText:"保存"},on:{ok:e.editHandleOk},model:{value:e.editVisible,callback:function(t){e.editVisible=t},expression:"editVisible"}},[a("a-form-model",{ref:"ruleForm",attrs:{rules:e.rules,"label-col":{span:6},"wrapper-col":{span:12},model:e.form}},[a("a-form-model-item",{attrs:{label:"姓名",prop:"name"}},[a("a-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("a-form-model-item",{attrs:{label:"用户名",prop:"username"}},[a("a-input",{attrs:{disabled:!0},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("a-form-model-item",{attrs:{label:"当前密码",prop:"currentPassword"}},[a("a-input",{attrs:{type:"password",placeholder:"不填写表示不修改"},model:{value:e.form.currentPassword,callback:function(t){e.$set(e.form,"currentPassword",t)},expression:"form.currentPassword"}})],1),a("a-form-model-item",{attrs:{label:"密码",prop:"password"}},[a("a-input",{attrs:{type:"password",placeholder:"不填写表示不修改"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("a-form-model-item",{attrs:{label:"确认密码",prop:"confirm_password"}},[a("a-input",{attrs:{type:"password",placeholder:"不填写表示不修改"},model:{value:e.form.confirm_password,callback:function(t){e.$set(e.form,"confirm_password",t)},expression:"form.confirm_password"}})],1)],1)],1)],1)}),z=[],M=(a("b0c0"),a("498a"),{name:"HeaderAvatar",data:function(){var e=this;return{fieldsEquals:function(t,a,n){a&&""!==a.trim()||n(),e.form[t.equalTo]!==a?n(new Error(t.message)):(e.$refs.ruleForm.validateField(t.equalTo),n())},editVisible:!1,form:{username:null,name:null,currentPassword:null,password:null,confirm_password:null},rules:null,currentName:null,currUser:null}},mounted:function(){this.currUser=JSON.parse(window.localStorage.getItem("currentUser"));var e=this.currUser;e.name?this.currentName=e.name.substring(e.name.length>=2?e.name.length-2:0):this.currentName=e.username},methods:{onEditUser:function(){this.editVisible=!0,this.form={username:this.currUser.username,name:this.currUser.name,password:null,confirm_password:null},this.rules={name:[{required:!0,message:"请输入姓名",trigger:"blur"}],password:[{validator:this.fieldsEquals,equalTo:"confirm_password",message:"两次密码不相等",trigger:"change"}],confirm_password:[{validator:this.fieldsEquals,equalTo:"password",message:"两次密码不相等",trigger:"change"}]}},editHandleOk:function(){var e=this,t=Object(b["a"])({},this.form);this.$refs.ruleForm.validate((function(a){a&&e.$http.put("/member/user",t).then((function(a){e.$message.success("修改成功"),e.currUser=t,window.localStorage.setItem("currentUser",JSON.stringify(t)),t.name?e.currentName=t.name.substring(t.name.length>=2?t.name.length-2:0):e.currentName=t.username,e.editVisible=!1}))}))}}}),q=M,U=(a("6f00"),Object(d["a"])(q,T,z,!1,null,"a5629d66",null)),K=U.exports,A=(a("99af"),a("4160"),a("159b"),a("55f1")),V=a("0c63"),H=A["a"].Item,W=A["a"].SubMenu,G=["dashboard","user","form","setting","message","safety","bell","delete","code-o","poweroff","eye-o","hourglass"],J={name:"IMenu",props:{menuData:{type:Array,required:!0},theme:{type:String,required:!1,default:"dark"},mode:{type:String,required:!1,default:"inline"},collapsed:{type:Boolean,required:!1,default:!1}},data:function(){return{openKeys:[],selectedKeys:[],cachedOpenKeys:[]}},computed:{rootSubmenuKeys:function(e){var t=[];return e.menuData.forEach((function(e){t.push(e.path)})),t}},created:function(){this.updateMenu()},watch:{collapsed:function(e){e?(this.cachedOpenKeys=this.openKeys,this.openKeys=[]):this.openKeys=this.cachedOpenKeys},$route:function(){this.updateMenu()}},methods:{renderIcon:function(e,t){return"none"===t?null:e(V["a"],{props:{type:void 0!==t?t:G[Math.floor(Math.random()*G.length)]}})},renderMenuItem:function(e,t,a,n){return e(H,{key:t.path?t.path:"item_"+a+"_"+n},[e("RouterLink",{attrs:{to:t.path}},[this.renderIcon(e,t.icon),e("span",[t.name])])])},renderSubMenu:function(e,t,a,n){var r=this,i=[e("span",{slot:"title"},[this.renderIcon(e,t.icon),e("span",[t.name])])],s=[],o=a+"_"+n;return t.children.forEach((function(t,a){s.push(r.renderItem(e,t,o,a))})),e(W,{key:t.path?t.path:"submenu_"+a+"_"+n},i.concat(s))},renderItem:function(e,t,a,n){if(!t.invisible)return t.children?this.renderSubMenu(e,t,a,n):this.renderMenuItem(e,t,a,n)},renderMenu:function(e,t){var a=this,n=[];return t.forEach((function(t,r){n.push(a.renderItem(e,t,"0",r))})),n},onOpenChange:function(e){var t=this,a=e.find((function(e){return-1===t.openKeys.indexOf(e)}));-1===this.rootSubmenuKeys.indexOf(a)?this.openKeys=e:this.openKeys=a?[a]:[]},updateMenu:function(){var e=this.$route.matched.concat();this.selectedKeys=[e.pop().path];var t=[];e.forEach((function(e){t.push(e.path)})),this.collapsed||"horizontal"===this.mode?this.cachedOpenKeys=t:this.openKeys=t}},render:function(e){var t=this;return e(A["a"],{props:{theme:this.$props.theme,mode:this.$props.mode,openKeys:this.openKeys,selectedKeys:this.selectedKeys},on:{openChange:this.onOpenChange,select:function(e){t.selectedKeys=e.selectedKeys,t.$emit("select",e)}}},this.renderMenu(e,this.menuData))}},X={name:"GlobalHeader",components:{IMenu:J,HeaderAvatar:K},props:["collapsed","menuData"],computed:{isMobile:function(){return this.$store.state.setting.isMobile},layout:function(){return this.$store.state.setting.layout},theme:function(){return"side"===this.layout?"light":this.$store.state.setting.theme},systemName:function(){return this.$store.state.setting.systemName}},methods:{toggleCollapse:function(){this.$emit("toggleCollapse")},onSelect:function(e){this.$emit("menuSelect",e)}}},Y=X,Z=(a("18d9"),Object(d["a"])(Y,D,P,!1,null,"12964e74",null)),Q=Z.exports,ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"footer"},[a("div",{staticClass:"links"},e._l(e.linkList,(function(t,n){return a("a",{key:n,attrs:{target:"_blank",href:t.link?t.link:"javascript: void(0)"}},[t.icon?a("a-icon",{attrs:{type:t.icon}}):e._e(),e._v(e._s(t.name)+" ")],1)})),0),a("div",{staticClass:"copyright"},[e._v(" Copyright"),a("a-icon",{attrs:{type:"copyright"}}),e._v(e._s(e.copyright)+" ")],1)])},te=[],ae={name:"GlobalFooter",props:["copyright","linkList"]},ne=ae,re=(a("51d3"),Object(d["a"])(ne,ee,te,!1,null,"f76e51f4",null)),ie=(re.exports,a("eb60")),se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-layout-sider",{class:[e.theme,"sider",e.isMobile?null:"shadow"],attrs:{width:"256px",collapsible:e.collapsible,trigger:null},model:{value:e.collapsed,callback:function(t){e.collapsed=t},expression:"collapsed"}},[n("div",{class:["logo",e.theme]},[n("router-link",{attrs:{to:"/dashboard/workplace"}},[n("img",{attrs:{src:a("4ffd")}}),n("h1",[e._v(e._s(e.systemName))])])],1),n("i-menu",{staticClass:"menu",attrs:{theme:e.theme,collapsed:e.collapsed,menuData:e.menuData},on:{select:e.onSelect}})],1)},oe=[],ce={name:"SiderMenu",components:{IMenu:J},props:{collapsible:{type:Boolean,required:!1,default:!1},collapsed:{type:Boolean,required:!1,default:!1},menuData:{type:Array,required:!0},theme:{type:String,required:!1,default:"dark"}},computed:{isMobile:function(){return this.$store.state.setting.isMobile},systemName:function(){return this.$store.state.setting.systemName}},methods:{onSelect:function(e){this.$emit("menuSelect",e)}}},le=ce,ue=(a("11e2"),Object(d["a"])(le,se,oe,!1,null,"47ac19b3",null)),de=ue.exports,he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-layout-sider",{staticClass:"sider",attrs:{width:"273"}},[a("setting-item",{attrs:{title:"整体风格设置"}},[a("img-checkbox-group",{on:{change:e.setTheme}},[a("img-checkbox",{attrs:{img:"https://gw.alipayobjects.com/zos/rmsportal/LCkqqYNmvBEbokSDscrm.svg",checked:!0,value:"dark"}}),a("img-checkbox",{attrs:{img:"https://gw.alipayobjects.com/zos/rmsportal/jpRkZQMyYRryryPNtyIC.svg",value:"light"}})],1)],1),a("setting-item",{attrs:{title:"主题色"}},[a("color-checkbox-group",{attrs:{defaultValues:[5],multiple:!1},on:{change:e.onColorChange}},e._l(e.colors,(function(e,t){return a("color-checkbox",{key:t,attrs:{color:e,value:t}})})),1)],1),a("a-divider"),a("setting-item",{attrs:{title:"导航设置"}},[a("img-checkbox-group",{on:{change:e.setLayout}},[a("img-checkbox",{attrs:{img:"https://gw.alipayobjects.com/zos/rmsportal/JopDzEhOqwOjeNTXkoje.svg",checked:!0,value:"side"}}),a("img-checkbox",{attrs:{img:"https://gw.alipayobjects.com/zos/rmsportal/KDNDBbriJhLwuqMoxcAr.svg",value:"head"}})],1)],1),a("setting-item",[a("a-list",{attrs:{split:!1}},[a("a-list-item",[e._v(" 栅格模式 "),a("a-select",{staticStyle:{width:"80px"},attrs:{slot:"actions",size:"small",defaultValue:"1"},slot:"actions"},[a("a-select-option",{attrs:{value:"1"}},[e._v("流式")]),a("a-select-option",{attrs:{value:"2"}},[e._v("定宽")])],1)],1),a("a-list-item",[e._v(" 固定Header "),a("a-switch",{attrs:{slot:"actions",size:"small"},slot:"actions"})],1),a("a-list-item",[e._v(" 固定Siderbar "),a("a-switch",{attrs:{slot:"actions",size:"small"},slot:"actions"})],1)],1)],1),a("a-divider"),a("setting-item",{attrs:{title:"其他设置"}},[a("a-list",{attrs:{split:!1}},[a("a-list-item",[e._v(" 色弱模式 "),a("a-switch",{attrs:{slot:"actions",size:"small"},slot:"actions"})],1),a("a-list-item",[e._v(" 显示抽屉按钮 "),a("a-switch",{attrs:{slot:"actions",size:"small"},slot:"actions"})],1),a("a-list-item",[e._v(" 多页签模式 "),a("a-switch",{attrs:{slot:"actions",checked:e.multiPage,size:"small"},on:{change:e.setMultiPage},slot:"actions"})],1)],1)],1),a("a-divider"),a("setting-item",{attrs:{title:"页面切换动画"}},[a("a-list",{attrs:{split:!1}},[a("a-list-item",[e._v(" 动画效果 "),a("a-select",{staticClass:"select-item",attrs:{slot:"actions",size:"small"},on:{change:e.setAnimate},slot:"actions",model:{value:e.animate,callback:function(t){e.animate=t},expression:"animate"}},e._l(e.animates,(function(t,n){return a("a-select-option",{key:n,attrs:{value:n}},[e._v(e._s(t.alias))])})),1)],1),a("a-list-item",[e._v(" 动画方向 "),a("a-select",{staticClass:"select-item",attrs:{slot:"actions",size:"small"},on:{change:e.setAnimate},slot:"actions",model:{value:e.direction,callback:function(t){e.direction=t},expression:"direction"}},e._l(e.animateCfg.directions,(function(t,n){return a("a-select-option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1)],1)],1),a("a-button",{staticStyle:{width:"100%"},attrs:{id:"copyBtn","data-clipboard-text":"Sorry, you have copied nothing O(∩_∩)O~",icon:"copy"},on:{click:e.copyCode}},[e._v("拷贝代码")])],1)},pe=[],me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"setting-item"},[a("h3",{staticClass:"title"},[e._v(e._s(e.title))]),e._t("default")],2)},fe=[],ge={name:"SettingItem",props:["title"]},be=ge,ve=(a("a14d"),Object(d["a"])(be,me,fe,!1,null,"1f3cc0b5",null)),ye=ve.exports,ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"theme-color",style:{backgroundColor:e.color},on:{click:e.toggle}},[e.sChecked?a("a-icon",{attrs:{type:"check"}}):e._e()],1)},xe=[],we=(a("a9e3"),a("ddb0"),{name:"ColorCheckboxGroup",props:{defaultValues:{type:Array,required:!1,default:function(){return[]}},multiple:{type:Boolean,required:!1,default:!1}},data:function(){return{values:[],options:[]}},computed:{colors:function(){var e=[];return this.options.forEach((function(t){t.sChecked&&e.push(t.color)})),e}},provide:function(){return{groupContext:this}},watch:{values:function(){this.$emit("change",this.values,this.colors)},defaultValues:function(e){this.multiple?this.options.forEach((function(t){t.sChecked=e.indexOf(t.value)>-1})):this.options.forEach((function(t){var a=e[0];t.sChecked=a&&a==t.value}))}},methods:{handleChange:function(e){e.checked?this.multiple?this.values.push(e.value):this.options.forEach((function(t){t.value!=e.value&&(t.sChecked=!1)})):this.values=this.values.filter((function(t){return t!==e.value}))}},render:function(e){var t=e("div",{attrs:{style:"clear: both"}});return e("div",{},[this.$slots.default,t])}}),_e={name:"ColorCheckbox",Group:we,props:{color:{type:String,required:!0},value:{type:[String,Number],required:!0},checked:{type:Boolean,required:!1,default:!1}},data:function(){return{sChecked:this.initChecked()}},computed:{},inject:["groupContext"],watch:{sChecked:function(){var e={value:this.value,color:this.color,checked:this.sChecked};this.$emit("change",e);var t=this.groupContext;t&&t.handleChange(e)}},created:function(){var e=this.groupContext;e&&e.options.push(this)},methods:{toggle:function(){this.sChecked=!this.sChecked},initChecked:function(){var e=this.groupContext;return e?e.multiple?e.defaultValues.indexOf(this.value)>-1:e.defaultValues[0]==this.value:this.check}}},Se=_e,Ce=(a("f1b2"),Object(d["a"])(Se,ke,xe,!1,null,"2f0f620e",null)),De=Ce.exports,Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"img-check-box",on:{click:e.toggle}},[a("img",{attrs:{src:e.img}}),e.sChecked?a("div",{staticClass:"check-item"},[a("a-icon",{attrs:{type:"check"}})],1):e._e()])},je=[],Fe={name:"ImgCheckboxGroup",props:{multiple:{type:Boolean,required:!1,default:!1},defaultValues:{type:Array,required:!1,default:function(){return[]}}},data:function(){return{values:[],options:[]}},provide:function(){return{groupContext:this}},watch:{values:function(e,t){1===e.length&&1===t.length&&e[0]===t[0]||this.$emit("change",this.values)}},methods:{handleChange:function(e){e.checked?this.multiple?this.values.push(e.value):(this.values=[e.value],this.options.forEach((function(t){t.value!==e.value&&(t.sChecked=!1)}))):this.values=this.values.filter((function(t){return t!==e.value}))}},render:function(e){return e("div",{attrs:{style:"display: flex"}},[this.$slots.default])}},$e={name:"ImgCheckbox",Group:Fe,props:{checked:{type:Boolean,required:!1,default:!1},img:{type:String,required:!0},value:{required:!0}},data:function(){return{sChecked:this.checked}},inject:["groupContext"],watch:{sChecked:function(){var e={value:this.value,checked:this.sChecked};this.$emit("change",e);var t=this.groupContext;t&&t.handleChange(e)}},created:function(){var e=this.groupContext;e&&(this.sChecked=e.defaultValues.length>0?e.defaultValues.indexOf(this.value)>=0:this.sChecked,e.options.push(this))},methods:{toggle:function(){this.sChecked=!this.sChecked}}},Ie=$e,Oe=(a("b644"),Object(d["a"])(Ie,Pe,je,!1,null,"642400c4",null)),Le=Oe.exports,Ne=a("b311"),Re=a.n(Ne),Be=a("9d12"),Ee=a.n(Be),Te=a("2f62"),ze=De.Group,Me=Le.Group,qe={name:"Setting",components:{ImgCheckboxGroup:Me,ImgCheckbox:Le,ColorCheckboxGroup:ze,ColorCheckbox:De,SettingItem:ye},data:function(){return{animate:0,direction:0,colors:["#f5222d","#fa541c","#faad14","#13c2c2","#52c41a","#1d92ff","#2f54eb","#722ed1"]}},watch:{animate:function(){this.direction=0}},computed:Object(b["a"])({animateCfg:function(){return this.animates[this.animate]}},Object(Te["b"])("setting",["animates","multiPage"])),methods:{onColorChange:function(e,t){if(t.length>0){var a=this.$message.loading("您选择了主题色 ".concat(t,", 正在切换..."));Ee.a.changeThemeColor(t[0]).then(a)}},setTheme:function(e){this.$store.commit("setting/setTheme",e[0])},setLayout:function(e){this.$store.commit("setting/setLayout",e[0])},copyCode:function(){var e=new Re.a("#copyBtn"),t=this;e.on("success",(function(){t.$message.success("复制成功"),e.destroy()}))},setMultiPage:function(e){this.$store.commit("setting/setMultiPage",e)},setAnimate:function(){var e=this.animates[this.animate],t={name:e.name,direction:e.directions[this.direction]};this.$store.commit("setting/setAnimate",t)}}},Ue=qe,Ke=(a("6050"),Object(d["a"])(Ue,he,pe,!1,null,"e3bfc2c0",null)),Ae=(Ke.exports,window.innerHeight-64-122),Ve=[],He={name:"GlobalLayout",components:{SiderMenu:de,GlobalHeader:Q},data:function(){return{locale:ie["a"],minHeight:Ae+"px",collapsed:!1,menuData:Ve,showSetting:!1}},provide:function(){return{layoutMinHeight:Ae}},computed:{isMobile:function(){return this.$store.state.setting.isMobile},theme:function(){return this.$store.state.setting.theme},layout:function(){return this.$store.state.setting.layout},linkList:function(){return this.$store.state.setting.footerLinks},copyright:function(){return this.$store.state.setting.copyright}},methods:{toggleCollapse:function(){this.collapsed=!this.collapsed},onDrawerChange:function(e){this.collapsed=e},onMenuSelect:function(){this.toggleCollapse()},onSettingDrawerChange:function(e){this.showSetting=e}},beforeCreate:function(){Ve=this.$router.options.routes.find((function(e){return"/"===e.path})).children}},We=He,Ge=(a("5924"),Object(d["a"])(We,S,C,!1,null,"5fb1e77c",null)),Je=Ge.exports,Xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-menu",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"contextmenu",style:e.style,attrs:{selectedKeys:e.selectedKeys},on:{click:e.handleClick}},e._l(e.itemList,(function(t){return a("a-menu-item",{key:t.key},[t.icon?a("a-icon",{attrs:{role:"menuitemicon",type:t.icon}}):e._e(),e._v(e._s(t.text)+" ")],1)})),1)},Ye=[],Ze={name:"Contextmenu",props:{visible:{type:Boolean,required:!1,default:!1},itemList:{type:Array,required:!0,default:function(){return[]}}},data:function(){return{left:0,top:0,target:null,selectedKeys:[]}},computed:{style:function(){return{left:this.left+"px",top:this.top+"px"}}},created:function(){var e=this;window.addEventListener("mousedown",(function(t){return e.closeMenu(t)})),window.addEventListener("contextmenu",(function(t){return e.setPosition(t)}))},methods:{closeMenu:function(e){["menuitemicon","menuitem"].indexOf(e.target.getAttribute("role"))<0&&this.$emit("update:visible",!1)},setPosition:function(e){this.left=e.clientX,this.top=e.clientY,this.target=e.target},handleClick:function(e){var t=e.key;this.$emit("select",t,this.target),this.$emit("update:visible",!1)}}},Qe=Ze,et=(a("4635"),Object(d["a"])(Qe,Xe,Ye,!1,null,"73dd8bda",null)),tt=et.exports,at=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{"enter-active-class":"animated "+e.enterAnimate+" page-toggle-enter-active","leave-active-class":"animated "+e.leaveAnimate+" page-toggle-leave-active"}},[e._t("default")],2)},nt=[],rt=a("f121"),it={name:"PageToggleTransition",props:{animate:{type:String,validator:function(e){return-1!=rt["animates"].find((function(t){return t.name==e}))},default:"bounce"},direction:{type:String,validator:function(e){return["x","y","left","right","up","down","downLeft","upRight","downRight","upLeft","downBig","upBig","downLeft","downRight","topRight","bottomLeft","topLeft","bottomRight","default"].indexOf(e)>-1}},reverse:{type:Boolean,default:!0}},computed:{enterAnimate:function(){return this.activeClass(!1)},leaveAnimate:function(){return this.activeClass(!0)}},methods:{activeClass:function(e){var t=this,a=rt["animates"].find((function(e){return t.animate==e.name}));if(void 0==a)return"";var n="";n=void 0==this.direction?a.directions[0]:a.directions.find((function(e){return e==t.direction})),n=void 0==n||"default"===n?"":n,""!=n&&(n=e&&this.reverse?this.reversePosition(n,a.directions):n,n=n[0].toUpperCase()+n.substring(1));var r=e?"Out":"In";return a.name+r+n},reversePosition:function(e,t){if(0==e.length||"x"==e||"y"==e)return e;var a=t.indexOf(e);return a=a%2==1?a-1:a+1,t[a]}}},st=it,ot=(a("39be"),Object(d["a"])(st,at,nt,!1,null,null,null)),ct=ot.exports,lt={name:"MenuView",components:{PageToggleTransition:ct,Contextmenu:tt,GlobalLayout:Je},data:function(){return{pageList:[],linkList:[],activePage:"",menuVisible:!1,menuItemList:[{key:"1",icon:"arrow-left",text:"关闭左侧"},{key:"2",icon:"arrow-right",text:"关闭右侧"},{key:"3",icon:"close",text:"关闭其它"}]}},computed:Object(b["a"])({},Object(Te["b"])("setting",["multiPage","animate"])),created:function(){this.pageList.push(this.$route),this.linkList.push(this.$route.fullPath),this.activePage=this.$route.fullPath},watch:{$route:function(e){this.activePage=e.fullPath,this.multiPage?this.linkList.indexOf(e.fullPath)<0&&(this.linkList.push(e.fullPath),this.pageList.push(e)):(this.linkList=[e.fullPath],this.pageList=[e])},activePage:function(){},multiPage:function(e){e||(this.linkList=[this.$route.fullPath],this.pageList=[this.$route])}},methods:{changePage:function(e){this.$router.push(e),this.activePage=e},editPage:function(e,t){this[t](e)},remove:function(e){if(1!==this.pageList.length){this.pageList=this.pageList.filter((function(t){return t.fullPath!==e}));var t=this.linkList.indexOf(e);this.linkList=this.linkList.filter((function(t){return t!==e})),t=t>=this.linkList.length?this.linkList.length-1:t,this.activePage=this.linkList[t]}else this.$message.warning("这是最后一页，不能再关闭了啦")},onContextmenu:function(e){var t=this.getPageKey(e.target);null!==t&&(e.preventDefault(),this.menuVisible=!0)},getPageKey:function(e,t){if(t=t||0,t>2)return null;var a=e.getAttribute("pagekey");return a=a||(e.previousElementSibling?e.previousElementSibling.getAttribute("pagekey"):null),a||(e.firstElementChild?this.getPageKey(e.firstElementChild,++t):null)},onMenuSelect:function(e,t){var a=this.getPageKey(t);switch(e){case"1":this.closeLeft(a);break;case"2":this.closeRight(a);break;case"3":this.closeOthers(a);break;default:break}},closeOthers:function(e){var t=this.linkList.indexOf(e);this.linkList=this.linkList.slice(t,t+1),this.pageList=this.pageList.slice(t,t+1),this.activePage=this.linkList[0]},closeLeft:function(e){var t=this.linkList.indexOf(e);this.linkList=this.linkList.slice(t),this.pageList=this.pageList.slice(t),this.linkList.indexOf(this.activePage)<0&&(this.activePage=this.linkList[0])},closeRight:function(e){var t=this.linkList.indexOf(e);this.linkList=this.linkList.slice(0,t+1),this.pageList=this.pageList.slice(0,t+1),this.linkList.indexOf(this.activePage<0)&&(this.activePage=this.linkList[this.linkList.length-1])}}},ut=lt,dt=(a("2bcd"),Object(d["a"])(ut,w,_,!1,null,"14da5d02",null)),ht=dt.exports,pt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-layout",{attrs:{desc:e.desc,title:e.title,linkList:e.linkList}},[a("div",{staticClass:"extraImg",attrs:{slot:"extra"},slot:"extra"},[a("img",{attrs:{src:e.extraImage}})]),a("page-toggle-transition",{attrs:{animate:e.animate.name,direction:e.animate.direction}},[e.multiPage?a("keep-alive",[a("router-view",{ref:"page"})],1):a("router-view",{ref:"page"})],1)],1)},mt=[],ft=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-layout"},[a("page-header",{attrs:{breadcrumb:e.breadcrumb,title:e.title,logo:e.logo,avatar:e.avatar}},[e._t("action",null,{slot:"action"}),e._t("headerContent",null,{slot:"content"}),!this.$slots.headerContent&&e.desc?a("div",{attrs:{slot:"content"},slot:"content"},[a("p",{staticStyle:{"font-size":"14px","line-height":"1.5",color:"rgba(0,0,0,.65)"}},[e._v(e._s(e.desc))]),a("div",{staticClass:"link"},[e._l(e.linkList,(function(t,n){return[a("a",{key:n,attrs:{href:t.href}},[a("a-icon",{attrs:{type:t.icon}}),e._v(" "+e._s(t.title))],1)]}))],2)]):e._e(),this.$refs.extra?e._t("extra",null,{slot:"extra"}):e._e()],2),a("div",{ref:"page",class:["page-content",e.layout]},[e._t("default")],2)],1)},gt=[],bt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-header"},[a("div",{class:["page-header-wide",e.layout]},[a("div",{staticClass:"breadcrumb"},[a("a-breadcrumb",e._l(e.breadcrumb,(function(t,n){return a("a-breadcrumb-item",{key:t.path},[a("span",0===n?[a("a",{attrs:{href:"#/dashboard/workplace"}},[e._v(e._s(t.name))])]:[e._v(e._s(t.name))])])})),1)],1),a("div",{staticClass:"detail"},[e.avatar?a("div",{staticClass:"avatar"},[a("a-avatar",{attrs:{src:e.avatar}})],1):e._e(),a("div",{staticClass:"main"},[a("div",{staticClass:"row"},[e.logo?a("img",{staticClass:"logo",attrs:{src:e.logo}}):e._e(),e.title?a("h1",{staticClass:"title"},[e._v(e._s(e.title))]):e._e(),a("div",{staticClass:"action"},[e._t("action")],2)]),a("div",{staticClass:"row"},[this.$slots.content?a("div",{staticClass:"content"},[e._t("content")],2):e._e(),this.$slots.extra?a("div",{staticClass:"extra"},[e._t("extra")],2):e._e()])])])])])},vt=[],yt={name:"PageHeader",props:{title:{type:String,required:!1},breadcrumb:{type:Array,required:!1},logo:{type:String,required:!1},avatar:{type:String,required:!1}},computed:{layout:function(){return this.$store.state.setting.layout}}},kt=yt,xt=(a("b72d"),Object(d["a"])(kt,bt,vt,!1,null,"5b233f52",null)),wt=xt.exports,_t={name:"PageLayout",components:{PageHeader:wt},props:["desc","logo","title","avatar","linkList","extraImage"],data:function(){return{breadcrumb:[]}},computed:{layout:function(){return this.$store.state.setting.layout}},mounted:function(){this.getBreadcrumb()},updated:function(){this.getBreadcrumb()},methods:{getBreadcrumb:function(){this.breadcrumb=this.$route.matched}}},St=_t,Ct=(a("de19"),Object(d["a"])(St,ft,gt,!1,null,"726d4cb1",null)),Dt=Ct.exports,Pt={name:"PageView",components:{PageToggleTransition:ct,PageLayout:Dt},data:function(){return{title:"",desc:"",linkList:[],extraImage:""}},computed:Object(b["a"])({},Object(Te["b"])("setting",["multiPage","animate"])),mounted:function(){this.getPageHeaderInfo()},updated:function(){this.getPageHeaderInfo()},methods:{getPageHeaderInfo:function(){this.title=this.$route.name;var e=this.$refs.page;e&&(this.desc=e.desc,this.linkList=e.linkList,this.extraImage=e.extraImage)}}},jt=Pt,Ft=(a("37a7"),Object(d["a"])(jt,pt,mt,!1,null,"25ed08f4",null)),$t=Ft.exports,It=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("SearchForm",{on:{handleSearch:e.handleSearch}},[a("a-row",[a("a-button",{attrs:{type:"primary"},on:{click:e.onAdd}},[e._v("添加")])],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.data,pagination:e.pagination,rowKey:function(e,t){return t}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"isEnable",fn:function(t){return a("span",{style:t?"":{color:"red"}},[e._v(" "+e._s(t?"启用":"禁用")+" ")])}},{key:"locked",fn:function(t){return a("span",{style:t?{color:"red"}:""},[e._v(" "+e._s(t?"是":"否")+" ")])}},{key:"isAdmin",fn:function(t){return a("span",{style:t?{color:"red"}:""},[e._v(" "+e._s(t?"是":"否")+" ")])}},{key:"action",fn:function(t,n){return a("span",{},[a("a",{on:{click:function(t){return e.onEdit(n)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"是否解锁?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.unlock(n)}}},[a("a",[e._v("解锁")])]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"是否删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.onDelete(n.id)}}},[a("a",{staticStyle:{color:"red"}},[e._v("删除")])])],1)}}])})],1),a("div",[a("a-modal",{attrs:{title:"用户详情",cancelText:"取消",okText:"保存"},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-form-model",{ref:"ruleForm",attrs:{rules:e.rules,"label-col":{span:6},"wrapper-col":{span:12},model:e.form}},[a("a-form-model-item",{attrs:{label:"姓名",prop:"name"}},[a("a-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("a-form-model-item",{attrs:{label:"用户名",prop:"username"}},[a("a-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("a-form-model-item",{attrs:{label:"密码",prop:"password"}},[a("a-input",{attrs:{type:"password",placeholder:"不填写表示不修改"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("a-form-model-item",{attrs:{label:"确认密码",prop:"confirm_password"}},[a("a-input",{attrs:{type:"password",placeholder:"不填写表示不修改"},model:{value:e.form.confirm_password,callback:function(t){e.$set(e.form,"confirm_password",t)},expression:"form.confirm_password"}})],1),a("a-form-model-item",{attrs:{label:"是否启用",prop:"isEnable"}},[a("a-switch",{model:{value:e.form.isEnable,callback:function(t){e.$set(e.form,"isEnable",t)},expression:"form.isEnable"}})],1),a("a-form-model-item",{attrs:{label:"是否管理员",prop:"isAdmin"}},[a("a-switch",{model:{value:e.form.isAdmin,callback:function(t){e.$set(e.form,"isAdmin",t)},expression:"form.isAdmin"}})],1)],1)],1)],1)],1)},Ot=[],Lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"components-form-demo-advanced-search"}},[a("a-form-model",{ref:"searchForm",staticClass:"ant-advanced-search-form",attrs:{model:e.form},on:{submit:e.handleSearch}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{key:1,attrs:{span:6}},[a("a-form-item",{attrs:{label:"用户名",prop:"username"}},[a("a-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1)],1),a("a-col",{staticStyle:{"text-align":"left","margin-top":"4px"},attrs:{span:16}},[a("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v(" 查询 ")])],1)],1)],1),a("div",{staticClass:"search-result-list"},[e._t("default")],2)],1)},Nt=[],Rt={data:function(){return{form:{username:""}}},methods:{handleSearch:function(e){var t=this;e.preventDefault(),this.$refs.searchForm.validate((function(e){e&&t.$emit("handleSearch",t.$mt.deepCopy(t.form))}))}}},Bt=Rt,Et=(a("9450"),Object(d["a"])(Bt,Lt,Nt,!1,null,null,null)),Tt=Et.exports,zt=[{title:"姓名",dataIndex:"name"},{title:"用户名",dataIndex:"username"},{title:"是否管理员",dataIndex:"isAdmin",scopedSlots:{customRender:"isAdmin"}},{title:"是否启用",dataIndex:"isEnable",scopedSlots:{customRender:"isEnable"}},{title:"是否被锁定",dataIndex:"locked",scopedSlots:{customRender:"locked"}},{title:"上次登录时间",dataIndex:"lastLoginDate"},{title:"登录次数",dataIndex:"loginTimes"},{title:"创建时间",dataIndex:"createdDate"},{title:"修改时间",dataIndex:"updatedDate"},{title:"操作",scopedSlots:{customRender:"action"}}],Mt={data:function(){var e=this;return{fieldsEquals:function(t,a,n){a&&""!==a.trim()||n(),e.form[t.equalTo]!==a?n(new Error(t.message)):(e.$refs.ruleForm.validateField(t.equalTo),n())},data:[],columns:zt,pagination:{pageSizeOptions:["10","20","50","100"],pageSize:10,showSizeChanger:!0,showTotal:function(e,t){return"数据总数："+e}},visible:!1,form:{id:null,username:"",name:"",password:"",confirm_password:"",isEnable:!0,isAdmin:!1},rules:{}}},mounted:function(){this.fetch()},methods:{unlock:function(e){var t=this;this.$http.put("/admin/user/unlock/"+e.username).then((function(e){t.$message.success("解锁成功!"),t.fetch()}))},handleSearch:function(e){this.fetch(Object(b["a"])({pageSize:this.pagination.pageSize,pageNum:1},e))},onAdd:function(){this.form={id:null,username:"",password:"",confirm_password:"",isEnable:!0,isAdmin:!1},this.rules={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:this.fieldsEquals,equalTo:"confirm_password",message:"两次密码不相等",trigger:"change"}],confirm_password:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:this.fieldsEquals,equalTo:"password",message:"两次密码不相等",trigger:"change"}]},this.showModal()},onEdit:function(e){this.form=this.$mt.deepCopy(e),this.form.password=null,this.rules={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],password:[{validator:this.fieldsEquals,equalTo:"confirm_password",message:"两次密码不相等",trigger:"change"}],confirm_password:[{validator:this.fieldsEquals,equalTo:"password",message:"两次密码不相等",trigger:"change"}]},this.showModal()},onDelete:function(e){var t=this;this.$http.delete("/admin/user/"+e).then((function(e){t.fetch(),t.$message.success("删除成功")}))},handleTableChange:function(e,t,a){var n=Object(b["a"])({},this.pagination);n.current=e.current,this.pagination=n,this.fetch(Object(b["a"])({pageSize:e.pageSize,pageNum:e.current,sortField:a.field,sortOrder:a.order},t))},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pageNum:1,pageSize:10};this.$http.get("/admin/user/page/list",{params:t}).then((function(t){var a=t.data.result,n=Object(b["a"])({},e.pagination);n.total=a.total,n.pageSize=a.pageSize,e.data=a.list,e.pagination=n}))},showModal:function(){this.visible=!0},handleOk:function(e){var t=this,a=this.$mt.deepClone(this.form);this.$refs.ruleForm.validate((function(e){if(!e)return!1;a.id?t.$http.put("/admin/user",a).then((function(e){t.$message.success("更新成功！"),t.visible=!1,t.fetch()})):t.$http.post("/admin/user",a).then((function(e){t.$message.success("新增成功！"),t.visible=!1,t.fetch()}))}))}},components:{SearchForm:Tt}},qt=Mt,Ut=Object(d["a"])(qt,It,Ot,!1,null,"109eae5c",null),Kt=Ut.exports,At=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("a-row",[a("a-button",{attrs:{type:"primary"},on:{click:e.onAdd}},[e._v("添加")])],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.data,pagination:e.pagination,rowKey:function(e,t){return e.id},expandedRowKeys:e.expandedRowKeys},on:{expand:e.expand,change:e.handleTableChange},scopedSlots:e._u([{key:"owner",fn:function(t,n){return a("span",{},[n.isOwn?a("a-tag",{attrs:{color:"#108ee9"}},[e._v(e._s(t))]):a("a-tag",{attrs:{color:"#87d068"}},[e._v(e._s(t))])],1)}},{key:"defaultIsPublic",fn:function(t){return a("span",{},[t?a("a-tag",{attrs:{color:"#f50"}},[e._v("公开")]):a("a-tag",{attrs:{color:"#87d068"}},[e._v("私有")])],1)}},{key:"action",fn:function(t,n){return a("span",{},[a("a",{on:{click:function(t){return e.onEdit(n)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticStyle:{color:"red"},on:{click:function(t){return e.onGenerate(n)}}},[e._v("新增秘钥")]),n.isOwn?a("span",[a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.onGrant(n)}}},[e._v("授权")])],1):e._e(),a("a-divider",{attrs:{type:"vertical"}}),n.isOwn?a("a-popconfirm",{attrs:{title:"是否删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.onDelete(n.id)}}},[a("a",{staticStyle:{color:"red"}},[e._v("删除")])]):e._e()],1)}}])},[a("a-table",{attrs:{slot:"expandedRowRender",rowKey:function(e,t){return e.openId},columns:e.innerColumns,"data-source":e.innerData,pagination:!1},slot:"expandedRowRender",scopedSlots:e._u([{key:"secretKey",fn:function(t){return a("a-tooltip",{},[a("template",{slot:"title"},[e._v(" "+e._s(t)+" ")]),a("div",{staticStyle:{width:"200px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[e._v(e._s(t)+" ")])],2)}},{key:"action",fn:function(t,n){return a("span",{},[a("a",{staticStyle:{"margin-right":"10px"},on:{click:function(t){return e.onUpdateAccess(n)}}},[e._v("编辑")]),a("a-popconfirm",{attrs:{title:"是否删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.onDeleteOpenId(n)}}},[a("a",{staticStyle:{color:"red"}},[e._v("删除")])])],1)}}])})],1),a("div",[a("a-modal",{attrs:{title:"bucket详情"},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-form-model",{ref:"ruleForm",attrs:{rules:e.rules,"label-col":{span:6},"wrapper-col":{span:12},model:e.form}},[a("a-form-model-item",{attrs:{label:"桶名称",prop:"bucketName"}},[a("a-input",{model:{value:e.form.bucketName,callback:function(t){e.$set(e.form,"bucketName",t)},expression:"form.bucketName"}})],1),a("a-form-model-item",{attrs:{label:"数据分片",prop:"dataFragmentsAmount"}},[a("a-input-number",{staticStyle:{width:"100%"},model:{value:e.form.dataFragmentsAmount,callback:function(t){e.$set(e.form,"dataFragmentsAmount",t)},expression:"form.dataFragmentsAmount"}})],1),a("a-form-model-item",{attrs:{label:"默认权限",prop:"defaultIsPublic"}},[a("a-radio-group",{model:{value:e.form.defaultIsPublic,callback:function(t){e.$set(e.form,"defaultIsPublic",t)},expression:"form.defaultIsPublic"}},[a("a-radio",{attrs:{value:!0}},[e._v("公开")]),a("a-radio",{attrs:{value:!1}},[e._v("私有")])],1)],1)],1)],1),a("a-modal",{attrs:{title:"秘钥详情"},on:{ok:e.accessHandleOk},model:{value:e.accessVisible,callback:function(t){e.accessVisible=t},expression:"accessVisible"}},[a("a-form-model",{ref:"accessForm",attrs:{"label-col":{span:6},"wrapper-col":{span:12},model:e.accessForm}},[a("a-form-model-item",{attrs:{label:"用途",prop:"useInfo"}},[a("a-input",{model:{value:e.accessForm.useInfo,callback:function(t){e.$set(e.accessForm,"useInfo",t)},expression:"accessForm.useInfo"}})],1)],1)],1),a("a-modal",{attrs:{title:"授权",width:"1200px"},on:{ok:e.grantOk},model:{value:e.grantVisible,callback:function(t){e.grantVisible=t},expression:"grantVisible"}},[a("a-transfer",{attrs:{"show-search":"",filterOption:e.filterOption,"data-source":e.userData,"list-style":{width:"500px"},operations:["添加授权","删除授权"],"target-keys":e.grantUserKeys},on:{change:e.handleGrantChange},scopedSlots:e._u([{key:"children",fn:function(t){var n=t.props,r=(n.direction,n.filteredItems),i=n.selectedKeys,s=n.disabled,o=t.on,c=o.itemSelectAll,l=o.itemSelect;return[a("a-table",{style:{pointerEvents:s?"none":null,"overflow-x":"auto"},attrs:{scroll:{x:450,y:400},"row-selection":e.getRowSelection({disabled:s,selectedKeys:i,itemSelectAll:c,itemSelect:l}),columns:e.grantColumns,"data-source":r,pagination:!1,size:"small","custom-row":function(t){var a=t.key;t.disabled;return{on:{click:function(t){e.onRowClick(t,a,i,l)}}}}},scopedSlots:e._u([{key:"perms",fn:function(t,n){return[a("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple","default-value":t||[],placeholder:"请选择权限"},on:{change:function(t){return e.handlePermChange(t,n)}}},e._l(e.allPerms,(function(t){return a("a-select-option",{key:t},[e._v(" "+e._s(t)+" ")])})),1)]}}],null,!0)})]}}])})],1)],1)],1)},Vt=[],Ht=(a("caad"),a("d81d"),a("2532"),a("1157")),Wt=a.n(Ht),Gt=a("ceac"),Jt=a.n(Gt),Xt=[{title:"所有者",dataIndex:"owner",scopedSlots:{customRender:"owner"}},{title:"名称",dataIndex:"bucketName"},{title:"默认权限",dataIndex:"defaultIsPublic",scopedSlots:{customRender:"defaultIsPublic"}},{title:"分片数",dataIndex:"dataFragmentsAmount"},{title:"创建时间",dataIndex:"createdDate"},{title:"修改时间",dataIndex:"updatedDate"},{title:"操作",scopedSlots:{customRender:"action"}}],Yt=[{title:"openId",dataIndex:"openId"},{title:"用途",dataIndex:"useInfo"},{title:"私钥",dataIndex:"secretKey",scopedSlots:{customRender:"secretKey"},ellipsis:!0},{title:"创建时间",dataIndex:"createdDate"},{title:"修改时间",dataIndex:"updatedDate"},{title:"操作",scopedSlots:{customRender:"action"}}],Zt=[{title:"姓名",dataIndex:"name",width:80},{title:"账号",dataIndex:"username",width:80},{title:"权限",dataIndex:"perms",width:200,scopedSlots:{customRender:"perms"}}],Qt={data:function(){return{data:[],columns:Xt,innerColumns:Yt,grantColumns:Zt,innerData:[],innerDatas:[],expandedRowKeys:[],expandedRow:{},pagination:!1,visible:!1,accessVisible:!1,form:{id:null,bucketName:"",defaultIsPublic:!1,dataFragmentsAmount:1},accessForm:{openId:null,bucketName:null,publicKey:null,privateKey:null,useInfo:""},rules:{bucketName:[{required:!0,message:"请输入桶名称",trigger:"blur"}]},grantVisible:!1,userData:[],grantUserKeys:[],targetKeys:[],currentGrantBucketId:null,allPerms:[]}},mounted:function(){var e=this;this.fetch(),this.$http.get("/member/bucket/grant/perms/all").then((function(t){e.allPerms=t.data.result}))},methods:{filterOption:function(e,t){return t.name&&-1!==t.name.indexOf(e)||t.username&&-1!==t.username.indexOf(e)},onRowClick:function(e,t,a,n){var r=Wt()(e.target).parents(".ant-select").length;r>0||n(t,!a.includes(t))},handlePermChange:function(e,t){t.perms=e},getRowSelection:function(e){var t=e.disabled,a=e.selectedKeys,n=e.itemSelectAll,r=e.itemSelect;return{getCheckboxProps:function(e){return{props:{disabled:t||e.disabled}}},onSelectAll:function(e,t){var r=t.filter((function(e){return!e.disabled})).map((function(e){var t=e.key;return t})),i=e?Jt()(r,a):Jt()(a,r);n(i,e)},onSelect:function(e,t){var a=e.key;r(a,t)},selectedRowKeys:a}},onGenerate:function(e){this.accessForm={openId:null,bucketName:e.bucketName,publicKey:null,privateKey:null,useInfo:""},this.accessVisible=!0},onUpdateAccess:function(e){this.accessForm=Object(b["a"])({},e),this.accessVisible=!0},accessHandleOk:function(){var e=this,t=this.accessForm;t.openId?this.$http.put("/member/access/"+t.bucketName+"/"+t.openId,t).then((function(t){e.fetchExpandedRow(),e.accessVisible=!1,e.$message.success("修改成功"),e.refreshPerm()})):this.$http.post("/member/access/"+t.bucketName,t).then((function(t){e.fetchExpandedRow(),e.accessVisible=!1,e.$message.success("新增成功"),e.refreshPerm()}))},expand:function(e,t){e?(this.expandedRowKeys=[t.id],this.expandedRow=t,this.innerData=[],this.fetchExpandedRow()):this.expandedRowKeys=[]},fetchExpandedRow:function(){var e=this;this.expandedRow&&this.expandedRow.bucketName&&this.$http.get("/member/access/"+this.expandedRow.bucketName).then((function(t){e.innerData=t.data.result}))},onAdd:function(){this.form={id:null,bucketName:"",defaultIsPublic:!1,dataFragmentsAmount:1},this.showModal()},onEdit:function(e){this.form=this.$mt.deepCopy(e),this.showModal()},onDelete:function(e){var t=this;this.$http.delete("/member/bucket?id="+e).then((function(e){t.fetch(),t.$message.success("删除成功")}))},onDeleteOpenId:function(e){var t=this;this.$http.delete("/member/access/".concat(e.bucketName,"/").concat(e.openId)).then((function(e){t.fetchExpandedRow(),t.$message.success("删除成功")}))},handleTableChange:function(e,t,a){this.fetch()},fetch:function(){var e=this;this.$http.get("/member/bucket/list").then((function(t){e.data=t.data.result}))},showModal:function(){this.visible=!0},handleOk:function(e){var t=this,a=this.$mt.deepClone(this.form);this.$refs.ruleForm.validate((function(e){if(!e)return!1;a.id?t.$http.put("/member/bucket",a).then((function(e){t.$message.success("更新成功！"),t.visible=!1,t.fetch(),t.refreshPerm()})):t.$http.post("/member/bucket",a).then((function(e){t.$message.success("新增成功！"),t.visible=!1,t.fetch(),t.refreshPerm()}))}))},onGrant:function(e){var t=this;this.grantVisible=!0,this.userData=[],this.grantUserKeys=[],this.$http.get("/member/bucket/grant/list",{params:{bucketId:e.id}}).then((function(e){t.userData=e.data.result.allUsers,t.grantUserKeys=e.data.result.userKeys})),this.currentGrantBucketId=e.id,this.$nextTick().then((function(e){Wt()(".ant-table-body").css("overflow","auto")}))},handleGrantChange:function(e,t,a){this.grantUserKeys=e},hasGrant:function(e){var t,a=Object(r["a"])(this.grantUserKeys);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n===e.key)return!0}}catch(i){a.e(i)}finally{a.f()}return!1},grantOk:function(){var e=this,t=this.userData.filter((function(t){return e.hasGrant(t)})).map((function(e){return{userId:e.id,perms:e.perms}})),a={bucketId:this.currentGrantBucketId,grants:t};this.$http.post("/member/bucket/grant",a).then((function(t){e.$message.success("授权成功"),e.grantVisible=!1,e.refreshPerm()}))}},components:{}},ea=Qt,ta=Object(d["a"])(ea,At,Vt,!1,null,"527a69b2",null),aa=ta.exports,na=function(){var e=this,t=this,a=t.$createElement,n=t._self._c||a;return n("a-card",[n("a-row",{staticStyle:{"margin-bottom":"10px"}},[n("div",{staticClass:"tool-btns"},[n("a-button",{attrs:{type:"primary",disabled:!this.canInsert()},on:{click:t.onUpload}},[t._v(" "+t._s(t.uploading?"查看上传进度":"上传")+" ")]),n("a-button",{attrs:{type:"primary",disabled:!this.canInsert()},on:{click:function(e){return t.onEditDir()}}},[t._v(" 创建文件夹 ")]),n("a-button",{attrs:{type:"primary",disabled:!this.canDelete()||0===this.selectedRowKeys.length},on:{click:t.onBatchDelete}},[t._v(" 删除 ")]),n("a-button",{attrs:{type:"primary",disabled:!this.canSelect()||0===this.selectedRowKeys.length},on:{click:t.onCopyToBucket}},[t._v(" 复制 ")]),n("a-input-search",{staticStyle:{"margin-left":"15px",width:"300px"},attrs:{placeholder:"curr"===t.searchLocation?"搜索当前位置":"搜索所有位置"},on:{search:function(e){return t.onSearch()},pressEnter:function(e){return t.onSearch()}},model:{value:t.keyWord,callback:function(e){t.keyWord=e},expression:"keyWord"}},[n("a-select",{staticStyle:{width:"70px"},attrs:{slot:"addonBefore"},slot:"addonBefore",model:{value:t.searchLocation,callback:function(e){t.searchLocation=e},expression:"searchLocation"}},[n("a-select-option",{attrs:{value:"curr"}},[t._v(" 当前 ")]),n("a-select-option",{attrs:{value:"all"}},[t._v(" 所有 ")])],1)],1),n("a-select",{staticStyle:{width:"150px",float:"right"},model:{value:t.currentBucket,callback:function(e){t.currentBucket=e},expression:"currentBucket"}},t._l(t.buckets,(function(e){return n("a-select-option",{key:e.id,attrs:{value:e.bucketName}},[t._v(" "+t._s(e.bucketName)+" ")])})),1)],1)]),n("div",{staticStyle:{margin:"10px"}},[n("a",{staticClass:"dir-nav",on:{click:function(e){return t.onBack()}}},[n("a-icon",{attrs:{type:"rollback"}})],1),n("a",{staticStyle:{"margin-left":"10px"},on:{click:t.reload}},[n("a-icon",{attrs:{type:"sync"}})],1),t.parentDirs.length>0?n("span",t._l(t.parentDirs,(function(e){return n("a",{key:e.path,staticClass:"dir-nav",staticStyle:{"margin-left":"10px"},on:{"~click":function(a){return t.changeCurrentPath(e)}}},[t._v(t._s(e.path))])})),0):t._e(),n("span",{staticClass:"current",staticStyle:{"margin-left":"10px"}},[t._v(" "+t._s(t.currentDir.path)+" ")])]),n("a-table",{attrs:{columns:t.columns,"data-source":t.data,pagination:t.pagination,"row-selection":t.rowSelection,rowKey:function(e){return(e.isDir?"dir-":"resource-")+e.id},scroll:{x:1500},loading:t.tableLoading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"name",fn:function(e,a){return n("span",{},[a.isDir?n("span",[n("icon-font",{staticClass:"resource-icon",staticStyle:{"font-size":"18px"},attrs:{type:"icon-weibiaoti-_huabanfuben"}}),n("a",{class:t.getResourceClass(a),attrs:{id:a.id},on:{click:function(e){return t.changeCurrentPath(a)},touchstart:function(e){return t.onPressDown("_self",a)},touchend:function(e){return t.onPressUp(a)},mousedown:function(e){return t.onPressDown("_blank",a)},mouseup:function(e){return t.onPressUp(a)}}},[t._v(" "+t._s(t.showDetailPath?a.path:"/"+a.fileName)+" ")])],1):n("span",[n("a-row",[n("a-col",{attrs:{span:a.thumbFileHouseId?8:2,align:"center"}},[a.thumbFileHouseId?n("span",[a.image?n("a",{class:t.getResourceClass(a),attrs:{id:a.id},on:{click:function(e){return t.showImages("/mos/"+t.currentBucket+a.urlEncodePath,a)}}},[n("img",{staticStyle:{"max-width":"100px","max-height":"100px"},attrs:{title:a.fileName,src:"/mos/"+t.currentBucket+a.urlEncodePath+"?thumb=true"}})]):n("a",{attrs:{href:t.getResourceUrl(a),target:"_blank"},on:{click:function(e){return t.onRecentClick(a)}}},[n("img",{staticStyle:{"max-width":"100px","max-height":"100px"},attrs:{title:a.fileName,src:"/mos/"+t.currentBucket+a.urlEncodePath+"?thumb=true"}})])]):n("span",[a.icon?n("icon-font",{staticClass:"resource-icon",staticStyle:{"font-size":"16px"},attrs:{type:a.icon}}):n("icon-font",{staticClass:"resource-icon",staticStyle:{"font-size":"16px"},attrs:{type:"icon-wenjian"}})],1)]),n("a-col",{attrs:{span:"16"}},[a.image?n("a",{class:t.getResourceClass(a),attrs:{id:a.id},on:{click:function(e){return t.showImages("/mos/"+t.currentBucket+a.urlEncodePath,a)}}},[t._v(" "+t._s(t.showDetailPath?a.path:a.fileName)+" ")]):n("a",{class:t.getResourceClass(a),attrs:{id:a.id,href:t.getResourceUrl(a),target:"_blank"},on:{click:function(e){return t.onRecentClick(a)}}},[t._v(" "+t._s(t.showDetailPath?a.path:a.fileName)+" ")])])],1)],1)])}},{key:"isPublic",fn:function(e,a){return n("span",{},[a.isDir?t._e():n("span",[e?n("a-tag",{attrs:{color:"#f50"}},[t._v("公开")]):n("a-tag",{attrs:{color:"#87d068"}},[t._v("私有")])],1)])}},{key:"visits",fn:function(e,a){return n("span",{},[a.isDir?t._e():n("span",[t._v(" "+t._s(e)+" ")])])}},{key:"action",fn:function(e,a){return n("span",{},[n("span",{style:t.canDelete()?"":"display:none"},[n("a-popconfirm",{attrs:{title:"是否删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.onDelete(a,a.isDir?"delDir":"delFile")}}},[n("a",{staticStyle:{color:"red"}},[t._v("删除")])]),n("a-divider",{attrs:{type:"vertical"}})],1),n("span",{style:t.canUpdate()?"":"display:none"},[n("a",{on:{click:function(e){a.isDir?t.onEditDir(a):t.onEditResource(a)}}},[t._v("编辑")]),a.isDir?t._e():n("a-divider",{attrs:{type:"vertical"}})],1),a.isDir?n("a-divider",{attrs:{type:"vertical"}}):t._e(),n("a",{on:{click:function(e){return t.openGenAddr(a)}}},[t._v("访问链")]),a.isDir?n("span",[n("a-divider",{attrs:{type:"vertical"}}),n("a",{attrs:{href:"/mos/"+t.currentBucket+a.urlEncodePath+"?gallary=true",target:"_blank"}},[t._v("图集")])],1):n("span",[n("a-divider",{attrs:{type:"vertical"}}),n("a",{attrs:{href:"/mos/"+t.currentBucket+a.urlEncodePath+"?download=true"}},[t._v("下载")])],1)],1)}}])}),n("div",[n("a-modal",{attrs:{title:"上传",okText:"上传",cancelText:t.uploading?"切到后台":"取消",confirmLoading:t.uploading,maskClosable:!1,destroyOnClose:!0,width:800},on:{ok:t.onUploadOk},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.uploading||t.uploadProgress.errorMsg?n("span",[n("span",[t._v("（"+t._s(t.uploadProgress.fileIndex)+"/"+t._s(t.uploadProgress.files)+"）["+t._s(t.uploadProgress.current)+"] "+t._s(t.uploadProgress.errorMsg?"上传失败："+t.uploadProgress.errorMsg:"上传中..."))]),n("a-progress",{attrs:{percent:t.uploadProgress.uploadPercent,status:t.uploadProgress.errorMsg?"exception":"active"}})],1):t._e(),n("a-row",[n("a-col",{attrs:{span:"12"}},[n("a-form",{attrs:{form:t.uploadForm}},[n("a-form-item",t._b({attrs:{label:"桶"}},"a-form-item",t.formItemLayout,!1),[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["bucketName",{rules:[{required:!0,message:"请选择桶"}]}],expression:"['bucketName',{rules: [{required: true,message: '请选择桶',}],},]"}]},t._l(t.buckets,(function(e){return n("a-select-option",{key:e.id,attrs:{value:e.bucketName}},[t._v(" "+t._s(e.bucketName)+" ")])})),1)],1),n("a-form-item",t._b({attrs:{label:"是否覆盖"}},"a-form-item",t.formItemLayout,!1),[n("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["cover"],expression:"['cover']"}],on:{change:t.onCoverChange}})],1),n("a-form-item",t._b({attrs:{label:"权限"}},"a-form-item",t.formItemLayout,!1),[n("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isPublic",{initialValue:!1}],expression:"['isPublic',{initialValue:false}]"}]},[n("a-radio",{attrs:{value:!0}},[t._v("公开")]),n("a-radio",{attrs:{value:!1}},[t._v("私有")])],1)],1),n("a-form-item",t._b({attrs:{label:"响应头"}},"a-form-item",t.formItemLayout,!1),[n("a-auto-complete",{directives:[{name:"decorator",rawName:"v-decorator",value:["contentType"],expression:"['contentType']"}],attrs:{"data-source":t.contentTypeDataSource},on:{search:t.onContentTypeSearch}})],1),n("a-form-item",t._b({attrs:{label:"文件/文件夹"}},"a-form-item",t.formItemLayout,!1),[n("a-radio-group",{model:{value:t.uploadDirectory,callback:function(e){t.uploadDirectory=e},expression:"uploadDirectory"}},[n("a-radio",{attrs:{value:!1}},[t._v("文件")]),n("a-radio",{attrs:{value:!0}},[t._v("文件夹")])],1)],1),n("a-form-item",t._b({attrs:{label:"选择"}},"a-form-item",t.formItemLayout,!1),[n("a-upload-dragger",{attrs:{"file-list":t.fileList,multiple:!0,remove:t.handleRemove,directory:t.uploadDirectory,showUploadList:!1,"before-upload":t.beforeUpload}},[n("a-icon",{attrs:{type:"upload"}}),t._v(" 点击或拖动"+t._s(t.uploadDirectory?"文件夹":"文件")+"至此 ")],1)],1)],1)],1),n("a-col",{attrs:{span:"12"}},[n("a-form",{attrs:{form:t.uploadForm}},[t.fileList.length<=0?n("a-empty",{staticStyle:{height:"260px","margin-top":"140px"},attrs:{description:"暂无文件上传"}}):n("div",{staticStyle:{height:"400px",overflow:"auto"},attrs:{id:"pathname-container"}},t._l(t.fileList,(function(e,a){return n("a-form-item",t._b({key:a,attrs:{label:"文件"+(a+1),"has-feedback":!1}},"a-form-item",t.formItemLayout,!1),[n("a-input-search",{directives:[{name:"decorator",rawName:"v-decorator",value:["pathnames["+a+"]",{rules:[{required:!0,message:"文件名必填"},{validator:t.checkPathname}]}],expression:"['pathnames['+index+']',{rules: [{required: true,message: '文件名必填'},{\n\t\t\t\t\t\t\t    validator:checkPathname,\n\t\t\t\t\t\t\t}],},]"}],attrs:{type:"text"},on:{search:function(a){return t.handleRemove(e)}}},[n("a-button",{staticStyle:{"background-color":"#ffffff"},attrs:{slot:"enterButton",disabled:t.uploading},slot:"enterButton"},["uploading"===e.status?n("a-icon",{attrs:{type:"loading"}}):"done"===e.status?n("a-icon",{staticStyle:{color:"#52c41a"},attrs:{type:"check-circle",theme:"filled"}}):"error"===e.status?n("a-icon",{staticStyle:{color:"#f5222d"},attrs:{type:"close-circle",theme:"filled"}}):n("a-icon",{attrs:{type:"delete"}})],1)],1)],1)})),1)],1)],1)],1)],1),n("a-modal",{attrs:{title:"访问链详情",okText:"生成"},on:{ok:t.addrHandleOk},model:{value:t.addrVisible,callback:function(e){t.addrVisible=e},expression:"addrVisible"}},[n("a-form-model",{ref:"addrForm",attrs:{"label-col":{span:6},"wrapper-col":{span:12},model:t.addrForm}},[n("a-form-model-item",{attrs:{label:"秘钥"}},[n("a-select",{model:{value:t.addrForm.openId,callback:function(e){t.$set(t.addrForm,"openId",e)},expression:"addrForm.openId"}},t._l(t.openIds,(function(e){return n("a-select-option",{key:e.openId,attrs:{value:e.openId}},[t._v(t._s(e.useInfo?e.useInfo:e.openId)+" ")])})),1)],1),n("a-form-model-item",{attrs:{label:"桶",prop:"bucketName"}},[n("a-input",{attrs:{disabled:""},model:{value:t.addrForm.bucketName,callback:function(e){t.$set(t.addrForm,"bucketName",e)},expression:"addrForm.bucketName"}})],1),n("a-form-model-item",{attrs:{label:"文件",prop:"fileName"}},[n("a-input",{attrs:{disabled:""},model:{value:t.addrForm.fileName,callback:function(e){t.$set(t.addrForm,"fileName",e)},expression:"addrForm.fileName"}})],1),n("a-form-model-item",{attrs:{label:"有效时间",prop:"expireNumber"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{min:1,disabled:t.addrForm.isPublic||"ever"===t.addrForm.expireUnit,type:"number"},model:{value:t.addrForm.expireNumber,callback:function(e){t.$set(t.addrForm,"expireNumber",e)},expression:"addrForm.expireNumber"}},[n("a-select",{staticStyle:{width:"70px"},attrs:{slot:"addonAfter",disabled:t.addrForm.isPublic},on:{change:t.onExpireUnitChange},slot:"addonAfter",model:{value:t.addrForm.expireUnit,callback:function(e){t.$set(t.addrForm,"expireUnit",e)},expression:"addrForm.expireUnit"}},[n("a-select-option",{attrs:{value:"minute"}},[t._v("分钟")]),n("a-select-option",{attrs:{value:"hour"}},[t._v("小时")]),n("a-select-option",{attrs:{value:"day"}},[t._v("天")]),n("a-select-option",{attrs:{value:"month"}},[t._v("月")]),n("a-select-option",{attrs:{value:"year"}},[t._v("年")]),n("a-select-option",{attrs:{value:"ever"}},[t._v("永久")])],1)],1)],1),n("a-form-model-item",{attrs:{label:"是否使用渲染器",prop:"render"}},[n("a-switch",{model:{value:t.addrForm.render,callback:function(e){t.$set(t.addrForm,"render",e)},expression:"addrForm.render"}})],1),n("a-form-model-item",{attrs:{label:"访问链",prop:"signUrl"}},[n("a-input",{staticStyle:{height:"200px"},attrs:{type:"textarea"},model:{value:t.addrForm.signUrl,callback:function(e){t.$set(t.addrForm,"signUrl",e)},expression:"addrForm.signUrl"}})],1)],1)],1),n("a-modal",{attrs:{title:"资源详情",confirmLoading:t.saving,okText:"保存"},on:{ok:t.editHandleOk},model:{value:t.editVisible,callback:function(e){t.editVisible=e},expression:"editVisible"}},[n("a-form-model",{ref:"editForm",attrs:{rules:t.editRules,"label-col":{span:6},"wrapper-col":{span:12},model:t.editForm}},[n("a-form-model-item",{attrs:{label:"资源名",prop:"pathname"}},[n("a-input",{on:{pressEnter:t.editHandleOk},model:{value:t.editForm.pathname,callback:function(e){t.$set(t.editForm,"pathname",e)},expression:"editForm.pathname"}})],1),n("a-form-model-item",{attrs:{label:"权限",prop:"isPublic"}},[n("a-radio-group",{model:{value:t.editForm.isPublic,callback:function(e){t.$set(t.editForm,"isPublic",e)},expression:"editForm.isPublic"}},[n("a-radio",{attrs:{value:!0}},[t._v("公开")]),n("a-radio",{attrs:{value:!1}},[t._v("私有")])],1)],1),n("a-form-model-item",{attrs:{label:"响应头",prop:"contentType"}},[n("a-auto-complete",{attrs:{"data-source":t.contentTypeDataSource},on:{search:t.onContentTypeSearch},model:{value:t.editForm.contentType,callback:function(e){t.$set(t.editForm,"contentType",e)},expression:"editForm.contentType"}})],1)],1)],1),n("a-modal",{attrs:{title:"路径详情",confirmLoading:t.editDirSaving,okText:"保存"},on:{ok:t.onEditDirOk},model:{value:t.editDirVisible,callback:function(e){t.editDirVisible=e},expression:"editDirVisible"}},[n("a-form-model",{ref:"editDirForm",attrs:{"label-col":{span:6},"wrapper-col":{span:12},model:t.editDirForm}},[n("a-form-model-item",{attrs:{label:"父路径",prop:"path"}},[n("a-input",{on:{pressEnter:t.onEditDirOk},model:{value:t.editDirForm.parentPath,callback:function(e){t.$set(t.editDirForm,"parentPath",e)},expression:"editDirForm.parentPath"}})],1),n("a-form-model-item",{attrs:{label:"名称",prop:"name"}},[n("a-input",{ref:"editDirName",on:{pressEnter:t.onEditDirOk},model:{value:t.editDirForm.name,callback:function(e){t.$set(t.editDirForm,"name",e)},expression:"editDirForm.name"}})],1)],1)],1),n("a-modal",{attrs:{title:"复制选中文件",confirmLoading:t.copying,okText:"确定"},on:{ok:t.onCopyOk},model:{value:t.copyVisible,callback:function(e){t.copyVisible=e},expression:"copyVisible"}},[n("a-form-model",{ref:"copyForm",attrs:{"label-col":{span:6},"wrapper-col":{span:12},model:t.copyForm}},[n("a-form-model-item",{attrs:{label:"从",prop:"srcBucketName"}},[n("a-input",{attrs:{disabled:!0},model:{value:t.copyForm.srcBucketName,callback:function(e){t.$set(t.copyForm,"srcBucketName",e)},expression:"copyForm.srcBucketName"}})],1),n("a-form-model-item",{attrs:{label:"复制到",prop:"desBucketName"}},[n("a-select",{on:{change:function(){return t.onCopyFormDesPathSearch(e.copyForm.desPath)}},model:{value:t.copyForm.desBucketName,callback:function(e){t.$set(t.copyForm,"desBucketName",e)},expression:"copyForm.desBucketName"}},t._l(t.copyBuckets,(function(e){return n("a-select-option",{key:e.id,attrs:{value:e.bucketName}},[t._v(" "+t._s(e.bucketName)+" ")])})),1)],1),n("a-form-model-item",{attrs:{label:"目标路径",prop:"desPath"}},[n("a-auto-complete",{attrs:{"data-source":t.copyFormDesPaths},on:{search:t.onCopyFormDesPathSearch},model:{value:t.copyForm.desPath,callback:function(e){t.$set(t.copyForm,"desPath",e)},expression:"copyForm.desPath"}})],1)],1)],1),n("viewer",{ref:"viewer",staticClass:"viewer",attrs:{trigger:t.images},on:{inited:t.inited}},t._l(t.images,(function(e){return n("img",{key:e.origin,staticStyle:{display:"none"},attrs:{src:e.thumb,origin:e.origin}})})),0)],1)],1)},ra=[],ia=(a("a15b"),a("baa5"),a("a434"),a("b680"),a("2ca0"),a("2909")),sa=a("69a0"),oa=a.n(sa),ca={setThat:function(e){n=e},splitFile:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2097152,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10485760,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,r=e.size,i=Math.ceil(r/n);i<t?i=t:i>a&&(i=a);var s=Math.ceil(r/i);s<1&&(s=1);for(var o=[],c=0;c<s;c++){var l=void 0;l=c===s-1?e.slice(c*i,r):e.slice(c*i,(c+1)*i),o.push(l)}return{totalSize:r,chunks:s,partSize:i,uploadParts:o}},md5File:function(e,t,a){var n=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,r=2097152,i=Math.ceil(e.size/r),s=0,o=new oa.a.ArrayBuffer,c=new FileReader;function l(){var t=s*r,a=t+r>=e.size?e.size:t+r;c.readAsArrayBuffer(n.call(e,t,a))}c.onload=function(e){o.append(e.target.result),s++,null!=a&&a(i,s),s<i?l():t(o.end())},c.onerror=function(){console.warn("oops, something went wrong.")},l()},getFileName:function(e){var t=e.lastIndexOf("/");return-1!==t?e.substring(t+1):e},doUploadPart:function(e,t,a,r,i,s,o,c,l,u,d,h,p){var m=this;if(t>=e.length)p();else{var f=e[t].uploadPart,g=e[t].chunkIndex;this.md5File(f,(function(b){var v=new FormData;v.append("cover",r),v.append("contentType",i),v.append("isPublic",s),v.append("file",f),v.append("pathname",o),v.append("totalMd5",c),v.append("totalSize",l),v.append("chunkMd5",b),v.append("chunkSize",f.size),v.append("chunkIndex",g);var y=m.getFileName(o);n.$http.post("/upload/"+a,v).then((function(n){console.log("分片"+g+"上传结果:"+n.data.status),m.updateUploadProgress(!1,y,d,h+1,1,1,u,g+1),t++,m.doUploadPart(e,t,a,r,i,s,o,c,l,u,d,h,p)}),(function(e){n.uploading=!1,n.uploadProgress.errorMsg=e,console.log(o+"上传失败：",e)}))}))}},updateUploadProgress:function(e,t,a,r,i,s,o,c){var l=e?100:5*s/i+c/o*94;l=Math.floor(l),n.uploadProgress={current:t,files:a,fileIndex:r,uploadPercent:l}},uploadFile:function(e,t,a,r,i,s,o,c){var l=this;if(t>=e.length)c();else{var u=e[t];u.status="uploading";var d=u.lastModified,h=r[t],p=this.splitFile(u),m=p.chunks,f=p.totalSize,g=p.uploadParts;n.uploading=!0;var b=this.getFileName(h);n.uploadProgress.current=b,console.log(p),this.md5File(u,(function(p){var v={pathname:h,chunks:m,totalMd5:p,totalSize:f,contentType:o,isPublic:s,cover:i,lastModified:d};n.$http.post("/upload/".concat(a,"/init"),n.$mt.transformFormData(v)).then((function(v){var y=v.data.result,k=y.fileExists,x=y.existedChunkIndexs;if(k)console.log(h+"上传完成！"),u.status="done",n.$notification.success({message:"上传成功",description:h+"上传成功！",placement:"topRight"}),l.updateUploadProgress(!0,b,n.fileList.length,t+1,1,1,1,1),t++,l.uploadFile(e,t,a,r,i,s,o,c);else{var w=[];g.forEach((function(e,a){n.$mt.contains(x,a)?l.updateUploadProgress(!1,b,n.fileList.length,t+1,1,1,m,a+1):w.push({uploadPart:e,chunkIndex:a})})),l.doUploadPart(w,0,a,i,o,s,h,p,f,m,n.fileList.length,t,(function(){var m=new FormData;m.append("cover",i),m.append("contentType",o),m.append("isPublic",s),m.append("pathname",h),m.append("totalMd5",p),m.append("totalSize",f),m.append("bucketName",a),m.append("lastModified",d),n.$http.post("/upload/mergeFiles?wait=true",m).then((function(d){console.log(h+"上传完成！"),l.updateUploadProgress(!0,b,n.fileList.length,t+1,1,1,1,1),u.status="done",n.$notification.success({message:"上传成功",description:h+"上传成功！",placement:"topRight"}),t++,l.uploadFile(e,t,a,r,i,s,o,c)}),(function(e){u.status="error",n.uploading=!1,n.uploadProgress.errorMsg=e,console.log(h+"上传失败：",e),n.$notification.success({message:"上传失败",description:h+"上传失败："+e})}))}))}}),(function(e){u.status="error",n.uploading=!1,n.uploadProgress.errorMsg=e,console.log(h+"上传失败：",e)}))}),(function(a,n){l.updateUploadProgress(!1,b,e.length,t+1,a,n,1,0)}))}},initUploadProgress:function(){n.uploadProgress={files:n.fileList.length,fileIndex:1,current:"",uploadPercent:0,errorMsg:null}},genAddr:function(){if(n.addrForm.openId){n.addrForm.signUrl="";var e=Object(b["a"])({},n.addrForm),t=1,a=parseInt(n.addrForm.expireNumber);if(a<1)n.$message.warn("时间不能小于1");else{switch(n.addrForm.expireUnit){case"minute":t=60;break;case"hour":t=3600;break;case"day":t=86400;break;case"month":t=2592e3;break;case"year":t=94608e4;break;case"ever":t=-1,a=1;break}e.expireSeconds=t*a,n.$http.post("/member/access/sign",e).then((function(e){n.addrForm.signUrl=e.data.result}))}}else n.$message.warn("请先创建一个秘钥!")},showImages:function(e,t){t&&n.onRecentClick(t);for(var a=0;a<n.images.length;a++)-1!==n.images[a].origin.indexOf(e)&&n.$viewer.view(a)},popHandler:function(e){var t=e.state;t&&n.changeCurrentPath({path:t.path?t.path:"",urlEncodePath:t.urlEncodePath},t,!0)},fetchBucket:function(){n.$http.get("/member/bucket/list").then((function(e){n.buckets=e.data.result,n.currentBucket||(n.currentBucket=n.buckets[0].bucketName)}))},getHistoryParams:function(e){e=e||{};var t={pageNum:n.pagination.current,pageSize:n.pagination.pageSize,path:n.currentDir.path,urlEncodePath:n.currentDir.urlEncodePath,keyWord:n.keyWord,sortField:n.sortField,sortOrder:n.sortOrder,currentBucket:n.currentBucket,searchLocation:n.searchLocation};Wt.a.extend(t,e);var a="/resource?";for(var r in t){var i=n.queryAlias[r],s=t[r];s&&i&&(a+=i+"="+encodeURIComponent(s)+"&")}return a=a.substring(0,a.length-1),t.url=a,t},addHistory:function(e){var t=this.getHistoryParams(e);history.pushState(t,null,t.url)}},la=ca,ua=[{title:"文件名",dataIndex:"name",width:300,scopedSlots:{customRender:"name"},sorter:!0},{title:"文件大小",dataIndex:"readableSize",width:120,sorter:!0},{title:"权限",dataIndex:"isPublic",width:120,scopedSlots:{customRender:"isPublic"},sorter:!0},{title:"响应头",dataIndex:"contentType",width:200},{title:"访问量",dataIndex:"visits",width:100,scopedSlots:{customRender:"visits"},sorter:!0},{title:"修改时间",dataIndex:"updatedDate",width:160,sorter:!0},{title:"修改人",dataIndex:"updatedBy",width:120,sorter:!0},{title:"操作",width:220,scopedSlots:{customRender:"action"}}],da=V["a"].createFromIconfontCN({scriptUrl:"//at.alicdn.com/t/font_1836787_2a565rchgum.js"}),ha={data:function(){var e=this;return{uploadDirectory:!1,editDirVisible:!1,editDirForm:{parentPath:"",name:""},editDirSaving:!1,locations:{lastLocation:[],current:{}},images:[],searchLocation:"curr",pathnameCheckResults:[],checkPathname:function(t,a,n){""===a&&n(),e.cover&&n();var r=e.pathnameCheckResults[a];r?n(new Error("资源已存在")):n()},lastDir:null,parentDirs:[],currentBucket:null,currentDir:{path:"/",urlEncodePath:"/"},data:[],columns:ua,pagination:{pageSizeOptions:["10","20","50","100"],pageSize:20,showSizeChanger:!0,showTotal:function(e,t){return"数据总数："+e}},visible:!1,uploadForm:null,keyWord:"",rules:{bucketName:[{required:!0,message:"请选择bucket",trigger:"blur"}]},buckets:[],fileList:[],formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},uploading:!1,uploadProgress:{current:"",fileIndex:1,files:1,uploadPercent:0},saving:!1,selectedRowKeys:[],addrVisible:!1,cover:!1,addrForm:{signUrl:"",openId:null,resourceId:null,expireSeconds:3600,bucketId:null,expireNumber:2,expireUnit:"hour",render:!1},openIds:[],editVisible:!1,editForm:{pathname:null,isPublic:!1,contentType:null},editRules:{},allContentTypes:["text/html;charset=UTF-8","text/xml;charset=UTF-8","text/plain;charset=UTF-8","application/json;charset=UTF-8","application/octet-stream","application/pdf","text/markdown;charset=UTF-8","text/event-stream;charset=UTF-8","image/png","image/jpeg","image/gif","application/xml","application/xhtml+xml","application/stream+json","application/rss+xml","application/problem+xml","application/problem+json;charset=UTF-8","application/problem+json"],contentTypeDataSource:[],sortField:null,sortOrder:null,queryAlias:{pageNum:"n",pageSize:"s",path:"p",searchLocation:"l",keyWord:"k",sortField:"f",sortOrder:"o",currentBucket:"b"},historyClicks:[],refreshed:!0,tableLoading:!1,copyForm:{srcBucketName:null,desBucketName:null,dirIds:null,resourceIds:null,desPath:null},copyVisible:!1,copyBuckets:[],copyFormDesPaths:[],copying:!1,showDetailPath:!1,longPressTimer:null}},computed:{rowSelection:function(){var e=this,t=this.selectedRowKeys;return{selectedRowKeys:t,columnWidth:"40px",onChange:this.onSelectChange,hideDefaultSelections:!0,selections:[{key:"dirs",text:"文件夹",onSelect:function(t){var a=[];a=t.filter((function(t,a){return e.data[a].isDir})),e.selectedRowKeys=a}},{key:"files",text:"文件",onSelect:function(t){var a=[];a=t.filter((function(t,a){return!e.data[a].isDir})),e.selectedRowKeys=a}}]}}},destroyed:function(){window.removeEventListener("popstate",la.popHandler)},mounted:function(){la.setThat(this),window.addEventListener("popstate",la.popHandler,!1);var e=this.$route.query;e&&(e.n&&(this.pagination.current=parseInt(e.n)),e.s&&(this.pagination.pageSize=parseInt(e.s)),e.p&&(this.currentDir.path=e.p),e.k&&(this.keyWord=e.k),e.f&&(this.sortField=e.f),e.o&&(this.sortOrder=e.o),e.b&&(this.currentBucket=e.b),e.l&&(this.searchLocation=e.l)),la.fetchBucket(),this.contentTypeDataSource=Object(ia["a"])(this.allContentTypes),Wt()(".ant-table-body").css("overflow-x","auto")},watch:{"addrForm.expireNumber":function(){this.addrForm.expireNumber<1&&(this.addrForm.expireNumber=1)},currentBucket:function(){var e=this.pagination;if(this.data=[],this.selectedRowKeys=[],this.refreshed){var t=e.current?e.current:1;this.fetch({pageNum:t,pageSize:e.pageSize,path:"all"===this.searchLocation?"":this.currentDir.path,keyWord:this.keyWord,sortField:this.sortField,sortOrder:this.sortOrder}),this.refreshed=!1}else this.fetch({pageNum:1,pageSize:e.pageSize,path:"/",keyWord:"",sortField:this.sortField,sortOrder:this.sortOrder})},data:function(){var e=this;this.images=this.data.filter((function(e){return e.image})).map((function(t){var a="/mos/".concat(e.currentBucket).concat(t.urlEncodePath),n=t.thumbFileHouseId?a+"?thumb=true":a;return{origin:a,thumb:n}}))}},methods:{getResourceUrl:function(e){return e.signUrl?e.signUrl:"/mos/".concat(this.currentBucket).concat(e.urlEncodePath,"?render=true")},onPressDown:function(e,t){this.longPressTimer&&clearTimeout(this.longPressTimer);var a="/mos/".concat(this.currentBucket).concat(t.urlEncodePath,"?gallary=true"),n=this;this.longPressTimer=setTimeout((function(){n.onRecentClick(t),window.open(a,e)}),1e3)},onPressUp:function(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null)},canInsert:function(){return this.hasPerm(this.currentBucket,"INSERT")},canSelect:function(){return this.hasPerm(this.currentBucket,"SELECT")},canUpdate:function(){return this.hasPerm(this.currentBucket,"UPDATE")},canDelete:function(){return this.hasPerm(this.currentBucket,"DELETE")},onCopyToBucket:function(){this.copyBuckets=this.buckets,this.copyForm={srcBucketName:this.currentBucket,desBucketName:this.copyBuckets.length>0?this.copyBuckets[0].bucketName:null,dirIds:null,resourceIds:null,desPath:this.currentDir.path},this.copyFormDesPaths=[],this.onCopyFormDesPathSearch(this.currentDir.path),this.copyVisible=!0},onCopyFormDesPathSearch:function(e){var t=this;e||(e=this.copyForm.desPath);var a=this.copyForm.desBucketName;if(a){var n=this.getSelectRecords(),r=n.filter((function(e){return e.isDir})).map((function(e){return e.id})),i=this.currentDir.id;this.$http.get("/member/dir/".concat(a,"/select"),{params:{path:e}}).then((function(e){t.copyFormDesPaths=e.data.result.filter((function(e){return!t.$mt.contains(r,e.id)&&e.id!==i})).map((function(e){return e.path}))}))}},onCopyOk:function(){var e=this;this.copying=!0;var t=this.getSelectRecords(),a=t.filter((function(e){return e.isDir})).map((function(e){return e.id})),n=t.filter((function(e){return!e.isDir})).map((function(e){return e.id})),r=this.copyForm;r.desBucketName?r.desBucketName!==this.currentBucket||r.desPath!==this.currentDir.path?(r.dirIds=a,r.resourceIds=n,this.$http.post("/member/resource/copy/".concat(r.srcBucketName,"/to/").concat(r.desBucketName),r).then((function(t){e.$message.success("复制成功！"),e.copyVisible=!1,e.copying=!1}),(function(t){return e.copying=!1}))):this.$message.warn("不能复制到当前文件夹！"):this.$message.warn("请选择目标桶！")},onEditDir:function(e){var t=this;this.editDirVisible=!0;var a="/",n="",r=null;if(e&&e.id){r=e.id;var i=e.path;if("/"!==i){var s=i.lastIndexOf("/");a=i.substring(0,s),n=i.substring(s+1)}""===a&&(a="/")}else a=this.currentDir.path;this.editDirForm={parentPath:a,name:n,id:r},this.$nextTick().then((function(e){t.$refs.editDirName.focus()}))},onEditDirOk:function(){var e=this;this.editDirSaving=!0;var t=this,a=this.editDirForm,n=a.parentPath,r=a.name;n.endsWith("/")&&(n=n.substring(0,n.length-1)),r.startsWith("/")&&(r=r.substring(1));var i=n+"/"+r;"/"!==i&&i.endsWith("/")&&(i=i.substring(0,i.length-1)),a.path=i,this.editDirForm.id?this.$http.get("/member/dir/".concat(this.currentBucket,"/findByPath"),{params:{path:i}}).then((function(a){var n=a.data.result,r=!!n;if(r){var s=e.data.filter((function(e){return e.isDir&&e.id===t.editDirForm.id}))[0],o=s.path;e.$confirm({title:"合并确认",content:"文件夹"+i+"已存在，是否将"+o+"合并到"+i+"，同名文件将进行覆盖?",okText:"确认",cancelText:"取消",onOk:function(){t.$http.put("/member/dir/".concat(t.currentBucket,"/merge/").concat(s.id,"/to/").concat(n.id)).then((function(e){t.$message.success("合并成功"),t.currentDir=n,t.editDirVisible=!1,t.editDirSaving=!1,t.reload()}),(function(e){t.editDirSaving=!1}))},onCancel:function(){t.editDirSaving=!1}})}else e.$http.put("/member/dir/".concat(e.currentBucket,"/").concat(e.editDirForm.id),e.editDirForm).then((function(t){e.$message.success("修改成功"),e.editDirSaving=!1,e.editDirVisible=!1,e.reload()}),(function(e){t.editDirSaving=!1}))}),(function(t){e.editDirSaving=!1})):this.$http.post("/member/dir/".concat(this.currentBucket),this.editDirForm).then((function(t){e.$message.success("创建成功"),e.editDirSaving=!1,e.editDirVisible=!1,e.reload()}),(function(t){e.editDirSaving=!1}))},showImages:function(e,t){la.showImages(e,t)},getResourceClass:function(e){var t,a=!1,n=Object(r["a"])(this.historyClicks);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i===e.path){a=!0;break}}}catch(s){n.e(s)}finally{n.f()}return"resource-link "+(a?"activeAnchor":"")},onRecentClick:function(e){this.historyClicks.push(e.path)},inited:function(e){this.$viewer=e},onSearch:function(){var e=this.currentDir.path;"all"===this.searchLocation?e="":""===e&&(e="/"),this.fetch({pageNum:1,pageSize:this.pagination.pageSize,path:e,keyWord:this.keyWord,sortField:this.sortField,sortOrder:this.sortOrder})},openGenAddr:function(e){var t=this;this.addrForm={signUrl:null,openId:null,isPublic:e.isPublic,fileName:e.fileName,resourceId:null,dirId:null,expireSeconds:3600,expireNumber:1,expireUnit:"hour",bucketName:this.currentBucket},e.isDir?this.addrForm.dirId=e.id:this.addrForm.resourceId=e.id,this.addrVisible=!0,this.$http.get("/member/access/"+this.currentBucket).then((function(a){t.openIds=a.data.result,t.addrForm.openId=t.openIds[0].openId,e.isPublic&&la.genAddr()}))},onExpireUnitChange:function(e){"ever"===e&&(this.addrForm.expireNumber=1),this.addrForm.signUrl=""},addrHandleOk:function(){la.genAddr()},onSelectChange:function(e,t){this.selectedRowKeys=e},onBack:function(){history.back()},changeCurrentPath:function(e,t,a){var n=this;this.onRecentClick(e),this.keyWord=t?t.keyWord:"",this.searchLocation=""===e.path?"all":"curr",a=void 0!==a&&a;var r={pageNum:1,pageSize:this.pagination.pageSize,path:e?e.path:"/",keyWord:this.keyWord,sortField:this.sortField,sortOrder:this.sortOrder,ignoreHistory:a};t=t||{},Wt.a.extend(r,t,{path:e?e.path:"/"}),this.fetch(r,(function(){n.currentDir=e})),this.selectedRowKeys=[]},onDelete:function(e,t){var a=this,n={};n="delFile"===t?{fileIds:e.id}:{dirIds:e.id},this.$http.delete("/member/resource/".concat(this.currentBucket,"/del"),{params:n}).then((function(e){a.$message.success("删除成功"),a.reload()}))},getSelectRecords:function(){var e=this.data,t=this.selectedRowKeys;return t.map((function(t){var a,n=Object(r["a"])(e);try{for(n.s();!(a=n.n()).done;){var i=a.value,s=(i.isDir?"dir-":"resource-")+i.id;if(s===t)return i}}catch(o){n.e(o)}finally{n.f()}})).filter((function(e){return e}))},onBatchDelete:function(){var e=[],t=[],a=this.getSelectRecords(),n=a.filter((function(e){return e.isDir})).map((function(e){return e.path})),r=a.filter((function(e){return!e.isDir})).map((function(e){return e.path}));e=a.filter((function(e){return e.isDir})).map((function(e){return e.id})),t=a.filter((function(e){return!e.isDir})).map((function(e){return e.id})),n.push(r);var i=this;this.$confirm({title:"确定删除这些资源吗?",content:n.join(","),okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){var a={fileIds:t.join(","),dirIds:e.join(",")};i.$http.delete("/member/resource/".concat(i.currentBucket,"/del"),{params:a}).then((function(e){i.$message.success("删除成功"),i.selectedRowKeys=[],i.reload()}))}})},handleTableChange:function(e,t,a){var n=Object(b["a"])({},this.pagination);n.current=e.current,n.pageSize=e.pageSize,this.pagination=n,a&&a.order?(this.sortField=a.field,this.sortOrder=a.order):(this.sortField=null,this.sortOrder=null),this.selectedRowKeys=[],this.reload(!1)},reload:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.pagination;this.fetch({pageNum:t.current,pageSize:t.pageSize,path:this.currentDir.path,keyWord:this.keyWord,sortField:this.sortField,sortOrder:this.sortOrder,ignoreHistory:e})},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pageNum:1,pageSize:10,path:this.currentDir.path,keyWord:this.keyWord,sortField:null,sortOrder:null},a=arguments.length>1?arguments[1]:void 0;this.tableLoading=!0,this.$http.get("/member/resource/".concat(this.currentBucket,"/list"),{params:t}).then((function(n){e.tableLoading=!1;var r=n.data.result;e.currentDir=r.currentDir?r.currentDir:{path:"/",urlEncodePath:"/"},e.parentDirs=r.parentDirs,e.lastDir=r.lastDir;var i=Object(b["a"])({},e.pagination);if(r.resources){i.current=r.resources.pageNum,e.data=Object(ia["a"])(r.resources.list),i.total=r.resources.total;var s=r.resources.pageSize;s>0&&(i.pageSize=s)}else e.data=[],i.total=0;e.pagination=i,t.ignoreHistory||la.addHistory({path:t.path}),e.showDetailPath=""===t.path,a&&a()}),(function(t){e.tableLoading=!1}))},getReadableSize:function(e){var t;return e*=1,e<0?null:(e<=1024?(e,t="B"):e<=1048576?(e/1024,t="KB"):e<=1073741824?(e/1048576,t="MB"):(e/1073741824,t="GB"),e.toFixed(3)+t)},onUpload:function(){var e=this;this.currentBucket?(this.uploading?this.$nextTick().then((function(t){e.uploadForm.setFieldsValue(e.uploadingData)})):(this.pathnameCheckResults=[],this.uploadDirectory=!1,this.uploadForm=this.$form.createForm(this,{name:"register"}),la.initUploadProgress(),this.$nextTick().then((function(t){e.uploadForm.setFieldsValue({bucketName:e.currentBucket,pathnames:[]})})),this.cover=!1,this.uploadPercent=0,this.fileList=[],this.uploadingData={}),this.visible=!0):this.$message.warn("您还没有桶，请先去创建一个吧")},beforeUpload:function(e){var t,a=this,n=this.getUploadPathname(e),i=Object(r["a"])(this.fileList);try{for(i.s();!(t=i.n()).done;){var s=t.value,o=this.getUploadPathname(s);if(o===n)return!1}}catch(u){i.e(u)}finally{i.f()}this.fileList.push(e);var c={},l="pathnames[".concat(this.fileList.length-1,"]");return c[l]=n,this.$nextTick().then((function(e){a.uploadForm.setFieldsValue(c),a.uploadForm.validateFields([l])})),!1},handleRemove:function(e){if(!this.uploading){var t=this.fileList.indexOf(e),a=this.fileList.slice();a.splice(t,1);var n=this.uploadForm.getFieldValue("pathnames"),r=n.slice();r.splice(t,1);var i=this.uploadForm.getFieldsError().pathnames,s=i.slice();s.splice(t,1),this.uploadForm.setFieldsValue({pathnames:r});for(var o=0;o<s.length;o++)s[o]&&this.uploadForm.validateFields(["pathnames[".concat(o,"]")]);this.fileList=a}},onUploadOk:function(e){var t=this;0!==this.fileList.length?this.$http.post("/member/resource/".concat(this.currentBucket,"/checkFile/isExists"),{pathnames:this.uploadForm.getFieldValue("pathnames")}).then((function(e){t.pathnameCheckResults=e.data.result.checkResults,t.uploadForm.validateFieldsAndScroll({force:!0},(function(e,a){if(e){var n=0;for(var r in e.pathnames){n=r,e.pathnames[r].errors[0].field;break}Wt()("#pathname-container").animate({scrollTop:40*n},500)}else{t.uploadingData=a;var i=a.pathnames,s=a.bucketName,o=void 0!==a.cover&&a.cover,c=void 0!==a.isPublic&&a.isPublic,l=void 0===a.contentType?"":a.contentType;la.initUploadProgress(),la.uploadFile(t.fileList,0,s,i,o,c,l,(function(){t.uploading=!1,t.$message.success("上传完成!"),t.visible=!1,t.reload()}))}}))})):this.$message.warn("请先选择要上传的文件！")},getUploadPathname:function(e){var t,a=e.webkitRelativePath,n=e.name;return a&&(n=a),t="/"===this.currentDir.path?this.currentDir.path+n:this.currentDir.path+"/"+n,t},onCoverChange:function(e){this.cover=e,this.uploadForm.validateFields({force:!0})},onEditResource:function(e){this.saving=!1,this.editForm=Object(b["a"])({},e),this.editForm.pathname=e.path,this.editVisible=!0},editHandleOk:function(){var e=this;this.saving=!0,this.$http.put("/member/resource/".concat(this.currentBucket,"/").concat(this.editForm.id),this.editForm).then((function(t){e.$message.success("更新成功"),e.reload(),e.saving=!1,e.editVisible=!1}),(function(t){e.saving=!1}))},onContentTypeSearch:function(e){this.contentTypeDataSource=this.allContentTypes.filter((function(t){return-1!==t.indexOf(e)}))}},components:{IconFont:da}},pa=ha,ma=(a("f707"),Object(d["a"])(pa,na,ra,!1,null,"4271d410",null)),fa=ma.exports,ga=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.reload}},[e._v("刷新")])],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.data,pagination:e.pagination,rowKey:function(e,t){return t},scroll:{x:1500},loading:e.tableLoading},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"keepSpaceByte",fn:function(t){return a("span",{},[e._v(" "+e._s((1*t/1073741824).toFixed(1))+" ")])}},{key:"totalStorageGb",fn:function(t){return a("span",{},[e._v(" "+e._s((1*t).toFixed(1))+" ")])}},{key:"usedStorageGb",fn:function(t){return a("span",{},[e._v(" "+e._s((1*t).toFixed(1))+" ")])}},{key:"usedPercent",fn:function(t){return a("span",{},[e._v(" "+e._s((100*t).toFixed(1)+"%")+" ")])}},{key:"status",fn:function(t){return a("span",{},["UP"===t?a("a-tag",{attrs:{color:"#87d068"}},[e._v(e._s(t))]):e._e(),"KICKED"===t?a("a-tag",{attrs:{color:"orange"}},[e._v(e._s(t))]):e._e(),"DOWN"===t?a("a-tag",{attrs:{color:"#f50"}},[e._v(e._s(t))]):e._e()],1)}},{key:"action",fn:function(t,n){return a("span",{},[a("a-popconfirm",{attrs:{title:"是否恢复?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.onRecover(n)}}},[a("a",[e._v("恢复")])]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"是否剔除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.onKick(n)}}},[a("a",{staticStyle:{color:"red"}},[e._v("剔除")])])],1)}}])})],1)},ba=[],va=[{title:"客户端名",dataIndex:"name",width:240},{title:"ip",dataIndex:"ip",width:120},{title:"端口",dataIndex:"port",width:80},{title:"权重",dataIndex:"weight",width:80},{title:"总存储（GB）",dataIndex:"totalStorageGb",width:140,scopedSlots:{customRender:"totalStorageGb"}},{title:"已用存储（GB）",dataIndex:"usedStorageGb",width:140,scopedSlots:{customRender:"usedStorageGb"}},{title:"使用百分比",dataIndex:"usedPercent",width:110,scopedSlots:{customRender:"usedPercent"}},{title:"状态",dataIndex:"status",width:80,scopedSlots:{customRender:"status"}},{title:"上次心跳时间",dataIndex:"lastBeatTime",width:160},{title:"保留大小（GB）",dataIndex:"keepSpaceByte",width:140,scopedSlots:{customRender:"keepSpaceByte"}},{title:"备注",dataIndex:"remark",width:100},{title:"创建时间",dataIndex:"createdDate",width:160},{title:"修改时间",dataIndex:"updatedDate",width:160},{title:"操作",scopedSlots:{customRender:"action"},fixed:"right"}],ya={data:function(){return{data:[],tableLoading:!1,columns:va,pagination:{pageSizeOptions:["10","20","50","100"],pageSize:10,showSizeChanger:!0,showTotal:function(e,t){return"数据总数："+e}}}},mounted:function(){this.fetch()},methods:{onKick:function(e){var t=this;this.$http.delete("/admin/client/kick/"+e.id).then((function(e){t.$message.success("剔除成功"),t.reload()}))},onRecover:function(e){var t=this;this.$http.put("/admin/client/recover/"+e.id).then((function(e){t.$message.success("恢复成功"),t.reload()}))},reload:function(){this.fetch()},handleTableChange:function(e,t,a){var n=Object(b["a"])({},this.pagination);n.current=e.current,this.pagination=n,this.fetch(Object(b["a"])({pageSize:e.pageSize,pageNum:e.current,sortField:a.field,sortOrder:a.order},t))},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pageNum:1,pageSize:10};this.tableLoading=!0,this.$http.get("/admin/client/list",{params:t}).then((function(t){e.tableLoading=!1;var a=t.data.result,n=Object(b["a"])({},e.pagination);n.total=a.total,n.pageSize=a.pageSize,e.data=a.list,e.pagination=n}),(function(t){e.tableLoading=!1}))}}},ka=ya,xa=Object(d["a"])(ka,ga,ba,!1,null,"3257b0aa",null),wa=xa.exports,_a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.buckets.length>0?a("div",[a("a-row",{staticStyle:{"margin-bottom":"10px"}},[a("a-col",{attrs:{span:"24"}},[a("a-card",[a("span",{staticStyle:{"font-size":"16px"}},[e._v("欢迎使用Mos对象存储系统！")]),a("a-select",{staticStyle:{width:"100px",float:"right"},model:{value:e.currentBucketName,callback:function(t){e.currentBucketName=t},expression:"currentBucketName"}},e._l(e.buckets,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.bucketName}},[e._v(" "+e._s(t.bucketName)+" ")])})),1)],1),a("a-card",{attrs:{bordered:!1,"body-style":{padding:"20px"}}},[a("a-spin",{attrs:{spinning:e.statisticsLoading}},[a("a-row",{attrs:{gutter:20}},[a("a-col",{attrs:{xs:24,sm:12,md:6}},[a("a-statistic",{staticClass:"demo-class",attrs:{title:"今日读写请求",value:null!=e.currentStatistic?e.currentStatistic.thisDayReadRequests:0},scopedSlots:e._u([{key:"suffix",fn:function(){return[a("span",[e._v(" / "+e._s(null!=e.currentStatistic?e.currentStatistic.thisDayWriteRequests:0))])]},proxy:!0}],null,!1,1789354593)}),a("a-statistic",{staticClass:"demo-class",attrs:{title:"今日读写流量",value:null!=e.currentStatistic?e.currentStatistic.readableThisDayRead:0},scopedSlots:e._u([{key:"suffix",fn:function(){return[a("span",[e._v(" / "+e._s(null!=e.currentStatistic?e.currentStatistic.readableThisDayWrite:0))])]},proxy:!0}],null,!1,1155517947)})],1),a("a-col",{attrs:{xs:24,sm:12,md:6}},[a("a-statistic",{staticClass:"demo-class",attrs:{title:"今月读写请求",value:null!=e.currentStatistic?e.currentStatistic.thisMonthReadRequests:0},scopedSlots:e._u([{key:"suffix",fn:function(){return[a("span",[e._v(" / "+e._s(null!=e.currentStatistic?e.currentStatistic.thisMonthWriteRequests:0))])]},proxy:!0}],null,!1,1626815597)}),a("a-statistic",{staticClass:"demo-class",attrs:{title:"今月读写流量",value:null!=e.currentStatistic?e.currentStatistic.readableThisMonthRead:0},scopedSlots:e._u([{key:"suffix",fn:function(){return[a("span",[e._v(" / "+e._s(null!=e.currentStatistic?e.currentStatistic.readableThisMonthWrite:0))])]},proxy:!0}],null,!1,855378295)})],1)],1)],1)],1)],1)],1),a("a-row",{attrs:{type:"flex",justify:"space-around",align:"middle",gutter:16}},[a("a-col",{attrs:{xs:24,sm:24,md:12}},[a("a-spin",{attrs:{spinning:e.chartLoading.request24Hours}},[a("a-card",{ref:"request24Hours",staticClass:"chart",staticStyle:{"margin-bottom":"10px"},attrs:{id:"request24Hours"}})],1),a("a-spin",{attrs:{spinning:e.chartLoading.flow24Hours}},[a("a-card",{ref:"flow24Hours",staticClass:"chart",attrs:{id:"flow24Hours"}})],1)],1),a("a-col",{attrs:{xs:24,sm:24,md:12}},[a("a-spin",{attrs:{spinning:e.chartLoading.request30Days}},[a("a-card",{ref:"request30Days",staticClass:"chart",staticStyle:{"margin-bottom":"10px"},attrs:{id:"request30Days"}})],1),a("a-spin",{attrs:{spinning:e.chartLoading.flow30Days}},[a("a-card",{ref:"flow30Days",staticClass:"chart",attrs:{id:"flow30Days"}})],1)],1)],1)],1):a("div",[e.loaded?a("a-card",[e._v(" 您还没有创建桶，先去创建一个吧！ ")]):e._e()],1)},Sa=[],Ca=(a("4d63"),a("25f0"),a("63e3")),Da={data:function(){return{statisticsLoading:!1,chartLoading:{request24Hours:!1,flow24Hours:!1,request30Days:!1,flow30Days:!1},buckets:[],statistics:{},charts:{request24Hours:null,flow24Hours:null,request30Days:null,flow30Days:null},currentBucketName:null,currentStatistic:{},loaded:!1}},mounted:function(){var e=this;this.$http.get("/member/bucket/list").then((function(t){e.buckets=t.data.result,e.loaded=!0,e.buckets&&e.buckets.length>0&&(e.currentBucketName=e.buckets[0].bucketName)}))},watch:{currentBucketName:function(){var e=this;e.fetchStatistics(this.currentBucketName),this.$nextTick((function(){e.createChart(e.currentBucketName)}))}},methods:{format:function(e,t){var a={"M+":e.getMonth()+1,"d+":e.getDate(),"H+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return t},getRecentDay:function(){var e=new Date;return e.setDate(e.getDate()-1),this.format(e,"yyyy-MM-dd HH:mm")},getRecent30Days:function(){var e=new Date;return e.setDate(e.getDate()-30),this.format(e,"yyyy-MM-dd HH:mm")},createChart:function(e){this.charts.request30Days||(this.charts.request30Days=Ca.init(document.getElementById("request30Days")),this.charts.request24Hours=Ca.init(document.getElementById("request24Hours")),this.charts.flow30Days=Ca.init(document.getElementById("flow30Days")),this.charts.flow24Hours=Ca.init(document.getElementById("flow24Hours"))),this.updateChart("request",this.charts.request24Hours,"最近24小时内的请求",e),this.updateChart("flow",this.charts.flow24Hours,"最近24小时内的流量",e),this.updateChart("request",this.charts.request30Days,"最近30天内的请求",e),this.updateChart("flow",this.charts.flow30Days,"最近30天内的流量",e)},updateChart:function(e,t,a,n){var r=this,i=t._dom.id;this.chartLoading[i]=!0;var s="flow"===e;this.$http.get("/member/audit/chart/".concat(n,"/").concat(i)).then((function(e){var n=e.data.result,o=[],c=[],l=[];n.forEach((function(e){o.push(e.time),s?(c.push(e.readMb),l.push(e.writeMb)):(c.push(e.readRequests),l.push(e.writeRequests))})),t.setOption({title:{text:a},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:s?["读流量","写流量"]:["读请求","写请求"]},xAxis:{data:o},yAxis:{name:s?"单位：MB":"请求数"},series:[{name:s?"读流量":"读请求",type:"line",smooth:!0,itemStyle:{},areaStyle:{},data:c},{name:s?"写流量":"写请求",type:"line",smooth:!0,itemStyle:{color:"rgb(255, 70, 131)"},areaStyle:{color:new Ca.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(255, 158, 68)"},{offset:1,color:"rgb(255, 70, 131)"}])},data:l}]}),r.chartLoading[i]=!1}),(function(e){r.chartLoading[i]=!1}))},fetchStatistics:function(e){var t=this;this.statistics[e]?this.currentStatistic=this.statistics[e]:(this.statisticsLoading=!0,this.$http.get("/member/audit/statistic/info/"+e).then((function(a){var n=a.data.result;t.statisticsLoading=!1,t.currentStatistic=n,t.statistics[e]=n}),(function(e){t.statisticsLoading=!1})))}}},Pa=Da,ja=(a("18ee"),Object(d["a"])(Pa,_a,Sa,!1,null,"30bb573a",null)),Fa=ja.exports,$a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("a-row",{staticStyle:{"margin-bottom":"10px"}},[a("div",{staticClass:"tool-btns"},[a("a-button",{attrs:{type:"primary",disabled:!this.canDelete()||0===this.selectedRowKeys.length},on:{click:e.onBatchDelete}},[e._v(" 彻底删除 ")]),a("a-button",{attrs:{type:"primary",disabled:!this.canDelete()||0===this.selectedRowKeys.length},on:{click:e.onRecover}},[e._v(" 还原 ")]),a("a-input-search",{staticStyle:{"margin-left":"15px",width:"300px"},attrs:{placeholder:"关键字搜索"},on:{search:function(t){return e.onSearch()},pressEnter:function(t){return e.onSearch()}},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}}),a("a-select",{staticStyle:{width:"150px",float:"right"},model:{value:e.currentBucket,callback:function(t){e.currentBucket=t},expression:"currentBucket"}},e._l(e.buckets,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.bucketName}},[e._v(" "+e._s(t.bucketName)+" ")])})),1)],1)]),a("div",{staticStyle:{margin:"10px"}},[a("a",{staticStyle:{"margin-left":"10px"},on:{click:e.reload}},[a("a-icon",{attrs:{type:"sync"}})],1)]),a("a-table",{attrs:{columns:e.columns,"data-source":e.data,pagination:e.pagination,"row-selection":e.rowSelection,rowKey:function(e){return(e.isDir?"dir-":"resource-")+e.id},scroll:{x:1500},loading:e.tableLoading},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"name",fn:function(t,n){return a("span",{},[n.isDir?a("span",[a("icon-font",{staticClass:"resource-icon",staticStyle:{"font-size":"18px"},attrs:{type:"icon-weibiaoti-_huabanfuben"}}),e._v(" "+e._s(n.path)+" ")],1):a("span",[a("a-row",[a("a-col",{attrs:{span:n.thumbFileHouseId?8:2,align:"center"}},[n.thumbFileHouseId?a("span",[a("img",{staticStyle:{"max-width":"100px","max-height":"100px"},attrs:{title:n.fileName,src:"/mos/"+e.currentBucket+n.urlEncodePath+"?thumb=true"}})]):a("span",[n.icon?a("icon-font",{staticClass:"resource-icon",staticStyle:{"font-size":"16px"},attrs:{type:n.icon}}):a("icon-font",{staticClass:"resource-icon",staticStyle:{"font-size":"16px"},attrs:{type:"icon-wenjian"}})],1)]),a("a-col",{attrs:{span:"16"}},[e._v(" "+e._s(n.path)+" ")])],1)],1)])}},{key:"isPublic",fn:function(t,n){return a("span",{},[n.isDir?e._e():a("span",[t?a("a-tag",{attrs:{color:"#f50"}},[e._v("公开")]):a("a-tag",{attrs:{color:"#87d068"}},[e._v("私有")])],1)])}},{key:"visits",fn:function(t,n){return a("span",{},[n.isDir?e._e():a("span",[e._v(" "+e._s(t)+" ")])])}},{key:"action",fn:function(t,n){return a("span",{},[a("span",{style:e.canDelete()?"":"display:none"},[a("a-popconfirm",{attrs:{title:"是否彻底删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.onDelete(n,n.isDir?"delDir":"delFile")}}},[a("a",{staticStyle:{color:"red"}},[e._v("删除")])])],1)])}}])})],1)},Ia=[],Oa=[{title:"文件名",dataIndex:"name",width:300,scopedSlots:{customRender:"name"},sorter:!0},{title:"文件大小",dataIndex:"readableSize",width:120,sorter:!0},{title:"权限",dataIndex:"isPublic",width:120,scopedSlots:{customRender:"isPublic"},sorter:!0},{title:"响应头",dataIndex:"contentType",width:200},{title:"访问量",dataIndex:"visits",width:100,scopedSlots:{customRender:"visits"},sorter:!0},{title:"修改时间",dataIndex:"updatedDate",width:160,sorter:!0},{title:"修改人",dataIndex:"updatedBy",width:120,sorter:!0},{title:"操作",width:220,scopedSlots:{customRender:"action"}}],La=V["a"].createFromIconfontCN({scriptUrl:"//at.alicdn.com/t/font_1836787_2a565rchgum.js"}),Na={data:function(){return{locations:{lastLocation:[],current:{}},searchLocation:"all",pathnameCheckResults:[],currentBucket:null,data:[],columns:Oa,pagination:{pageSizeOptions:["10","20","50","100"],pageSize:20,showSizeChanger:!0,showTotal:function(e,t){return"数据总数："+e}},rules:{bucketName:[{required:!0,message:"请选择bucket",trigger:"blur"}]},keyWord:"",buckets:[],selectedRowKeys:[],openIds:[],refreshed:!0,tableLoading:!1,showDetailPath:!0}},computed:{rowSelection:function(){var e=this,t=this.selectedRowKeys;return{selectedRowKeys:t,columnWidth:"40px",onChange:this.onSelectChange,hideDefaultSelections:!0,selections:[{key:"dirs",text:"文件夹",onSelect:function(t){var a=[];a=t.filter((function(t,a){return e.data[a].isDir})),e.selectedRowKeys=a}},{key:"files",text:"文件",onSelect:function(t){var a=[];a=t.filter((function(t,a){return!e.data[a].isDir})),e.selectedRowKeys=a}}]}}},mounted:function(){la.setThat(this),la.fetchBucket(),Wt()(".ant-table-body").css("overflow-x","auto")},watch:{currentBucket:function(){var e=this.pagination;if(this.data=[],this.selectedRowKeys=[],this.refreshed){var t=e.current?e.current:1;this.fetch({pageNum:t,pageSize:e.pageSize,path:"all"===this.searchLocation?"":this.currentDir.path,keyWord:this.keyWord,sortField:this.sortField,sortOrder:this.sortOrder}),this.refreshed=!1}else this.fetch({pageNum:1,pageSize:e.pageSize,path:"/",keyWord:"",sortField:this.sortField,sortOrder:this.sortOrder})}},methods:{canInsert:function(){return this.hasPerm(this.currentBucket,"INSERT")},canSelect:function(){return this.hasPerm(this.currentBucket,"SELECT")},canUpdate:function(){return this.hasPerm(this.currentBucket,"UPDATE")},canDelete:function(){return this.hasPerm(this.currentBucket,"DELETE")},getResourceClass:function(e){var t,a=!1,n=Object(r["a"])(this.historyClicks);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i===e.path){a=!0;break}}}catch(s){n.e(s)}finally{n.f()}return"resource-link "+(a?"activeAnchor":"")},onSearch:function(){this.fetch({pageNum:1,pageSize:this.pagination.pageSize,path:"",keyWord:this.keyWord,sortField:this.sortField,sortOrder:this.sortOrder})},onSelectChange:function(e,t){this.selectedRowKeys=e},onDelete:function(e,t){var a=this,n={};n="delFile"===t?{fileIds:e.id}:{dirIds:e.id},this.$http.delete("/member/resource/".concat(this.currentBucket,"/realDel"),{params:n}).then((function(e){a.$message.success("删除成功"),a.reload()}))},getSelectRecords:function(){var e=this.data,t=this.selectedRowKeys;return t.map((function(t){var a,n=Object(r["a"])(e);try{for(n.s();!(a=n.n()).done;){var i=a.value,s=(i.isDir?"dir-":"resource-")+i.id;if(s===t)return i}}catch(o){n.e(o)}finally{n.f()}})).filter((function(e){return e}))},onRecover:function(){var e=[],t=[],a=this.getSelectRecords(),n=a.filter((function(e){return e.isDir})).map((function(e){return e.path})),r=a.filter((function(e){return!e.isDir})).map((function(e){return e.path}));e=a.filter((function(e){return e.isDir})).map((function(e){return e.id})),t=a.filter((function(e){return!e.isDir})).map((function(e){return e.id})),n.push(r);var i=this;this.$confirm({title:"确定还原这些资源吗?",content:n.join(","),okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){i.$http.put("/member/resource/".concat(i.currentBucket,"/recover"),{dirIds:e,fileIds:t}).then((function(e){i.$message.success("还原成功"),i.selectedRowKeys=[],i.reload()}))}})},onBatchDelete:function(){var e=[],t=[],a=this.getSelectRecords(),n=a.filter((function(e){return e.isDir})).map((function(e){return e.path})),r=a.filter((function(e){return!e.isDir})).map((function(e){return e.path}));e=a.filter((function(e){return e.isDir})).map((function(e){return e.id})),t=a.filter((function(e){return!e.isDir})).map((function(e){return e.id})),n.push(r);var i=this;this.$confirm({title:"确定删除这些资源吗?",content:n.join(","),okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){var a={fileIds:t.join(","),dirIds:e.join(",")};i.$http.delete("/member/resource/".concat(i.currentBucket,"/realDel"),{params:a}).then((function(e){i.$message.success("删除成功"),i.selectedRowKeys=[],i.reload()}))}})},handleTableChange:function(e,t,a){var n=Object(b["a"])({},this.pagination);n.current=e.current,n.pageSize=e.pageSize,this.pagination=n,a&&a.order?(this.sortField=a.field,this.sortOrder=a.order):(this.sortField=null,this.sortOrder=null),this.selectedRowKeys=[],this.reload(!1)},reload:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.pagination;this.fetch({pageNum:t.current,pageSize:t.pageSize,path:this.currentDir.path,keyWord:this.keyWord,sortField:this.sortField,sortOrder:this.sortOrder,ignoreHistory:e})},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pageNum:1,pageSize:10,path:this.currentDir.path,keyWord:this.keyWord,sortField:null,sortOrder:null},a=arguments.length>1?arguments[1]:void 0;this.tableLoading=!0,t.isDelete=!0,t.path="",this.$http.get("/member/resource/".concat(this.currentBucket,"/list"),{params:t}).then((function(t){e.tableLoading=!1;var n=t.data.result;e.currentDir=n.currentDir?n.currentDir:{path:"/",urlEncodePath:"/"},e.parentDirs=n.parentDirs,e.lastDir=n.lastDir;var r=Object(b["a"])({},e.pagination);if(n.resources){r.current=n.resources.pageNum,e.data=Object(ia["a"])(n.resources.list),r.total=n.resources.total;var i=n.resources.pageSize;i>0&&(r.pageSize=i)}else e.data=[],r.total=0;e.pagination=r,e.showDetailPath=!0,a&&a()}),(function(t){e.tableLoading=!1}))},getReadableSize:function(e){var t;return e*=1,e<0?null:(e<=1024?(e,t="B"):e<=1048576?(e/1024,t="KB"):e<=1073741824?(e/1048576,t="MB"):(e/1073741824,t="GB"),e.toFixed(3)+t)}},components:{IconFont:La}},Ra=Na,Ba=(a("e79c"),Object(d["a"])(Ra,$a,Ia,!1,null,"368d3cf8",null)),Ea=Ba.exports;i["a"].use(m["a"]);var Ta=function(){var e=JSON.parse(window.localStorage.getItem("currentUser"));return e=e||{},[{path:"/signin",name:"登录",component:x},{path:"*",redirect:"/signin"},{path:"/",component:ht,redirect:"/signin",children:[{path:"/content",name:"MOS",icon:"inbox",component:$t,children:[{path:"/home",name:"主页",component:Fa,icon:"none"},{path:"/client",name:"服务器管理",component:wa,icon:"none",invisible:!e.isAdmin},{path:"/user",name:"用户管理",component:Kt,icon:"none",invisible:!e.isAdmin},{path:"/bucket",name:"桶管理",component:aa,icon:"none"},{path:"/trash",name:"回收站",component:Ea,icon:"none"},{path:"/resource",name:"资源管理",component:fa,icon:"none"}]}]}]},za=new m["a"]({routes:Ta(),mode:"history",getRoutes:Ta}),Ma=a("bc3a"),qa=a.n(Ma),Ua=a("1a47"),Ka=a.n(Ua),Aa=a("16b2"),Va=new Aa["a"]("admindb"),Ha={namespaced:!0,state:{user:{}},mutations:{setuser:function(e,t){e.user=t,Va.get("currUser").then((function(e){Va.put({_id:"currUser",_rev:e._rev,user:t})})).catch((function(e){if(404!==e.status)throw e;Va.put({_id:"currUser",user:t})}))}}},Wa={namespaced:!0,state:{isMobile:!1,theme:"dark",layout:"side",systemName:"MOS对象存储",copyright:"668mt",multiPage:!1,animates:rt["animates"],animate:{name:"bounce",direction:"left"}},mutations:{setDevice:function(e,t){e.isMobile=t},setTheme:function(e,t){e.theme=t},setLayout:function(e,t){e.layout=t},setMultiPage:function(e,t){e.multiPage=t},setAnimate:function(e,t){e.animate=t}}};i["a"].use(Te["a"]);var Ga=new Te["a"].Store({modules:{account:Ha,setting:Wa}}),Ja=(a("81ca"),a("0808"),a("6944")),Xa=a.n(Ja);i["a"].use(Xa.a,{defaultOptions:{zIndex:9999,inline:!1,toolbar:!0,tooltip:!0,movable:!0,zoomable:!0,rotatable:!1,scalable:!1,transition:!0,fullscreen:!1,keyboard:!0,url:"origin"}}),i["a"].prototype.$http=qa.a,i["a"].prototype.$mt=Ka.a,i["a"].config.productionTip=!1,i["a"].use(s["a"]),qa.a.defaults.withCredentials=!0,qa.a.interceptors.response.use((function(e){if("ok"!==e.data.status)throw i["a"].prototype.$message.error(e.data.message),e.data.message;return e}),(function(e){var t=e.response,a=i["a"].prototype.$message,n=e.request.responseURL;return n.endsWith("/signin")?(a.error("登录已过期"),setTimeout((function(){za.replace({name:"登录"})}),1500)):403===t.status&&i["a"].prototype.$notification.error({message:"没有权限访问",description:n,style:"word-wrap: break-word;word-break: break-all;width: 100%;"}),Promise.reject(e)})),za.beforeEach((function(e,t,a){za.options.routes=za.options.getRoutes(),a()}));var Ya=[];i["a"].prototype.hasPerm=function(e,t){var a=Ya[e];if(a){var n,i=Object(r["a"])(a);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s===t.toUpperCase())return!0}}catch(o){i.e(o)}finally{i.f()}}return!1},i["a"].prototype.refreshPerm=function(){this.$http.get("/member/bucket/grant/perms/own").then((function(e){var t=e.data.result;Ya={};var a,n=Object(r["a"])(t);try{for(n.s();!(a=n.n()).done;){var i=a.value;Ya[i.bucketName]=i.perms}}catch(s){n.e(s)}finally{n.f()}}))},new i["a"]({router:za,store:Ga,render:function(e){return e(p)},mounted:function(){"/signin"!==this.$route.path&&this.refreshPerm()}}).$mount("#app")},5924:function(e,t,a){"use strict";var n=a("e620"),r=a.n(n);r.a},6050:function(e,t,a){"use strict";var n=a("5573"),r=a.n(n);r.a},6760:function(e,t,a){},"692c":function(e,t,a){},"6a18":function(e,t,a){},"6f00":function(e,t,a){"use strict";var n=a("3be6"),r=a.n(n);r.a},"7be9":function(e,t,a){},"7e3e":function(e,t,a){},"7f12":function(e,t,a){},"7fb9":function(e,t,a){},8121:function(e,t,a){},"85ec":function(e,t,a){},"90bc":function(e,t,a){},9450:function(e,t,a){"use strict";var n=a("dee9"),r=a.n(n);r.a},"9d12":function(e,t){e.exports={getThemeColors:function(e){},changeThemeColor:function(e){}}},a14d:function(e,t,a){"use strict";var n=a("692c"),r=a.n(n);r.a},b644:function(e,t,a){"use strict";var n=a("e166"),r=a.n(n);r.a},b6b7:function(e,t,a){},b6d5:function(e,t,a){"use strict";var n=a("c352"),r=a.n(n);r.a},b72d:function(e,t,a){"use strict";var n=a("7be9"),r=a.n(n);r.a},bf50:function(e,t,a){"use strict";var n=a("0e76"),r=a.n(n);r.a},c352:function(e,t,a){},d1f9:function(e,t,a){},de19:function(e,t,a){"use strict";var n=a("314d"),r=a.n(n);r.a},dee9:function(e,t,a){},e166:function(e,t,a){},e620:function(e,t,a){},e79c:function(e,t,a){"use strict";var n=a("6760"),r=a.n(n);r.a},f121:function(e,t,a){e.exports={themeColor:"#1890ff",animates:a("3148"),footerLinks:[{link:"https://pro.ant.design",name:"Pro首页"},{link:"https://github.com/iczer/vue-antd-admin",icon:"github"},{link:"https://ant.design",name:"Ant Design"}]}},f1b2:function(e,t,a){"use strict";var n=a("6a18"),r=a.n(n);r.a},f707:function(e,t,a){"use strict";var n=a("7f12"),r=a.n(n);r.a}});
//# sourceMappingURL=app.be4a60dd.js.map