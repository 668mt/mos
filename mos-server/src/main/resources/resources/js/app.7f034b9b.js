(function(e){function t(t){for(var n,i,o=t[0],l=t[1],c=t[2],d=0,m=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&m.push(s[i][0]),s[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(m.length)m.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,o=1;o<a.length;o++){var l=a[o];0!==s[l]&&(n=!1)}n&&(r.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},s={app:0},r=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var n=a("85ec"),s=a.n(n);s.a},"0a78":function(e,t,a){"use strict";var n=a("7fb9"),s=a.n(n);s.a},"0e76":function(e,t,a){},"1a47":function(e,t,a){a("fb6a"),a("d3b7"),a("25f0");var n=function(e){var t="";for(var a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t.length>0&&(t=t.substring(0,t.length-1)),t},s=function(e){return Object.prototype.toString.call(e).slice(8,-1)},r=function e(t){var a,n=s(t);if("Object"===n)a={};else{if("Array"!==n)return t;a=[]}for(var r in t){var i=t[r];"Object"===s(i)||"Array"===s(i)?a[r]=e(i):a[r]=i}return a},i=function e(t){var a,n=s(t);if("array"===n)a=[];else{if("object"!==n)return t;a={}}if("array"===n)for(var r=0,i=t.length;r<i;r++)a.push(e(t[r]));else if("object"===n)for(var o in t)a[o]=e(t[o]);return a},o=function(e,t){if(!e)return!1;for(var a=0;a<e.length;a++)if(e[a]===t)return!0;return!1};e.exports={transformFormData:n,deepClone:i,deepCopy:r,contains:o}},"20d6":function(e,t,a){e.exports=a.p+"img/vue-antd-logo.4ee9700a.png"},"313c":function(e,t,a){"use strict";var n=a("bf0d"),s=a.n(n);s.a},3148:function(e,t,a){a("99af");var n=["left","right"],s=["down","up","left","right"],r=["downBig","upBig","leftBig","rightBig"],i=["topLeft","bottomRight","topRight","bottomLeft"],o=["downLeft","upRight","downRight","upLeft"];e.exports=[{name:"back",alias:"后位",directions:s},{name:"bounce",alias:"弹跳",directions:s.concat("default")},{name:"fade",alias:"淡化",directions:s.concat(r).concat(i).concat("default")},{name:"flip",alias:"翻转",directions:["x","y","default"]},{name:"lightSpeed",alias:"光速",directions:n},{name:"rotate",alias:"旋转",directions:o.concat("default")},{name:"roll",alias:"翻滚",directions:["default"]},{name:"zoom",alias:"缩放",directions:s.concat("default")},{name:"slide",alias:"滑动",directions:s}]},"314d":function(e,t,a){},3728:function(e,t,a){},"37a7":function(e,t,a){"use strict";var n=a("8121"),s=a.n(n);s.a},"39be":function(e,t,a){"use strict";var n=a("46bb"),s=a.n(n);s.a},4635:function(e,t,a){"use strict";var n=a("90bc"),s=a.n(n);s.a},4678:function(e,t,a){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(e){var t=r(e);return a(t)}function r(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=r,e.exports=s,s.id="4678"},"46bb":function(e,t,a){},"51d3":function(e,t,a){"use strict";var n=a("d1f9"),s=a.n(n);s.a},5573:function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("ac1f"),a("8a79"),a("5319"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var n,s=a("2b0e"),r=a("f23d"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},o=[],l={name:"App",components:{}},c=l,u=(a("034f"),a("2877")),d=Object(u["a"])(c,i,o,!1,null,null,null),m=d.exports,p=(a("202f"),a("8c4f")),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"content"},[e._m(0),a("div",{staticClass:"login"},[a("a-form",{staticClass:"login-form",attrs:{id:"components-form-demo-normal-login",form:e.form},on:{submit:e.handleSubmit}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",{rules:[{required:!0,message:"请输入用户名!"}]}],expression:"['username',{ rules: [{ required: true, message: '请输入用户名!' }] },]"}],attrs:{placeholder:"用户名"},on:{change:e.usernameChange}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"请输入密码!"}]}],expression:"['password',{ rules: [{ required: true, message: '请输入密码!' }] },]"}],attrs:{type:"password",placeholder:"密码"}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),e.needCode?a("a-form-item",[a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{span:14}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["code",{rules:[{required:!0,message:"请输入验证码!"}]}],expression:"['code',{ rules: [{ required: true, message: '请输入验证码!' }] },]"}],attrs:{type:"text",placeholder:"验证码"}})],1),a("a-col",{attrs:{span:10}},[a("img",{attrs:{src:e.codeSrc},on:{click:e.changeCode}})])],1)],1):e._e(),a("a-form-item",[a("a-button",{staticClass:"login-form-button",attrs:{type:"primary","html-type":"submit"}},[e._v(" 登录 ")])],1)],1)],1)])])},f=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"top"},[n("div",{staticClass:"header"},[n("img",{staticClass:"logo",attrs:{alt:"logo",src:a("20d6")}}),n("span",{staticClass:"title"},[e._v("MOS")])]),n("div",{staticClass:"desc"},[e._v("MOS存储服务管理")])])}],g=a("5530"),b={beforeCreate:function(){this.form=this.$form.createForm(this,{name:"normal_login"})},data:function(){return{codeSrc:"/kaptcha",needCode:!1}},methods:{changeCode:function(){this.codeSrc="/kaptcha?t="+Math.random()},usernameChange:function(e){var t=e.target.value;this.checkNeedCode(t)},checkNeedCode:function(e){var t=this;this.$http.get("/kaptcha/check/"+e).then((function(e){t.needCode=e.data.result}))},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,a){e||t.$http.post("/login",Object(g["a"])({},a),{transformRequest:[t.$mt.transformFormData]}).then((function(e){"ok"===e.data.status?(window.localStorage.setItem("currentUser",JSON.stringify(e.data.result)),t.$message.success(e.data.message),t.$router.replace({path:"/resource"})):(t.$message.error(e.data.message),t.checkNeedCode(a.username),t.changeCode())}),(function(e){t.checkNeedCode(a.username),t.changeCode()}))}))}}},v=b,k=(a("cb7b"),Object(u["a"])(v,h,f,!1,null,"b27f6a62",null)),y=k.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("global-layout",[a("contextmenu",{attrs:{itemList:e.menuItemList,visible:e.menuVisible},on:{"update:visible":function(t){e.menuVisible=t},select:e.onMenuSelect}}),e.multiPage?a("a-tabs",{staticStyle:{"margin-top":"-8px","margin-bottom":"8px"},attrs:{"active-key":e.activePage,"hide-add":!0,type:"editable-card"},on:{change:e.changePage,edit:e.editPage},nativeOn:{contextmenu:function(t){return function(t){return e.onContextmenu(t)}(t)}}},e._l(e.pageList,(function(t){return a("a-tab-pane",{key:t.fullPath},[a("span",{attrs:{slot:"tab",pagekey:t.fullPath},slot:"tab"},[e._v(e._s(t.name))])])})),1):e._e(),a("div",{staticClass:"menu-view-content"},[a("page-toggle-transition",{attrs:{animate:e.animate.name,direction:e.animate.direction}},[e.multiPage?a("keep-alive",[a("router-view")],1):a("router-view")],1)],1)],1)},w=[],_=(a("4de4"),a("c975"),a("fb6a"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-config-provider",{attrs:{locale:e.locale}},[a("a-layout",{staticClass:"global-layout"},[e.isMobile?a("drawer",{attrs:{openDrawer:e.collapsed},on:{change:e.onDrawerChange}},[a("sider-menu",{attrs:{theme:e.theme,menuData:e.menuData,collapsed:!1,collapsible:!1},on:{menuSelect:e.onMenuSelect}})],1):"side"===e.layout?a("sider-menu",{attrs:{theme:e.theme,menuData:e.menuData,collapsed:e.collapsed,collapsible:!0}}):e._e(),a("a-layout",{staticClass:"global-layout-main"},[a("global-header",{attrs:{menuData:e.menuData,collapsed:e.collapsed},on:{toggleCollapse:e.toggleCollapse}}),a("a-layout-content",{staticClass:"global-layout-content",style:{minHeight:e.minHeight,padding:"24px 24px 0",position:"relative"}},[e._t("default")],2)],1)],1)],1)}),C=[],j=(a("7db0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-layout-header",{class:[e.theme,"global-header"]},[n("div",{class:["global-header-wide",e.layout]},[e.isMobile||"head"===e.layout?n("router-link",{class:["logo",e.isMobile?null:"pc",e.theme],attrs:{to:"/"}},[n("img",{attrs:{width:"32",src:a("20d6")}}),e.isMobile?e._e():n("h1",[e._v(e._s(e.systemName))])]):e._e(),e.isMobile?n("a-divider",{attrs:{type:"vertical"}}):e._e(),"side"===e.layout?n("a-icon",{staticClass:"trigger",attrs:{type:e.collapsed?"menu-unfold":"menu-fold"},on:{click:e.toggleCollapse}}):e._e(),"head"===e.layout?n("div",{staticClass:"global-header-menu"},[n("i-menu",{staticStyle:{height:"64px","line-height":"64px"},attrs:{theme:e.theme,mode:"horizontal",menuData:e.menuData},on:{select:e.onSelect}})],1):e._e(),n("div",{class:["global-header-right",e.theme]},[n("header-avatar",{staticClass:"header-item"})],1)],1)])}),S=[],$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"header-search"},[a("a-icon",{staticClass:"search-icon",attrs:{type:"search"},on:{click:e.enterSearchMode}}),a("a-auto-complete",{ref:"input",class:["search-input",e.searchMode?"enter":"leave"],attrs:{dataSource:e.dataSource,placeholder:"站内搜索"},on:{blur:e.leaveSearchMode}})],1)},P=[],F={name:"HeaderSearch",data:function(){return{dataSource:["选项一","选项二"],searchMode:!1}},methods:{enterSearchMode:function(){var e=this;this.searchMode=!0,setTimeout((function(){return e.$refs.input.focus()}),300)},leaveSearchMode:function(){this.searchMode=!1}}},O=F,I=(a("bf50"),Object(u["a"])(O,$,P,!1,null,null,null)),L=(I.exports,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-dropdown",{attrs:{trigger:["click"]}},[a("template",{slot:"overlay"},[a("a-spin",{attrs:{spinning:e.loadding}},[a("a-tabs",{style:{backgroundColor:"white",width:"297px"},attrs:{tabBarStyle:{textAlign:"center"}}},[a("a-tab-pane",{key:"1",style:{padding:"0 24px"},attrs:{tab:"通知"}},[a("a-list",[a("a-list-item",[a("a-list-item-meta",{attrs:{title:"你收到了 14 份新周报",description:"一年前"}},[a("a-avatar",{staticStyle:{"background-color":"white"},attrs:{slot:"avatar",src:"https://gw.alipayobjects.com/zos/rmsportal/ThXAXghbEsBCCSDihZxY.png"},slot:"avatar"})],1)],1),a("a-list-item",[a("a-list-item-meta",{attrs:{title:"你推荐的 曲妮妮 已通过第三轮面试",description:"一年前"}},[a("a-avatar",{staticStyle:{"background-color":"white"},attrs:{slot:"avatar",src:"https://gw.alipayobjects.com/zos/rmsportal/OKJXDXrmkNshAMvwtvhu.png"},slot:"avatar"})],1)],1),a("a-list-item",[a("a-list-item-meta",{attrs:{title:"这种模板可以区分多种通知类型",description:"一年前"}},[a("a-avatar",{staticStyle:{"background-color":"white"},attrs:{slot:"avatar",src:"https://gw.alipayobjects.com/zos/rmsportal/kISTdvpyTAhtGxpovNWd.png"},slot:"avatar"})],1)],1)],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:"消息"}},[e._v(" 暂无消息 ")]),a("a-tab-pane",{key:"3",attrs:{tab:"待办"}},[e._v(" 暂无待办 ")])],1)],1)],1),a("span",{staticClass:"header-notice",on:{click:e.fetchNotice}},[a("a-badge",{attrs:{count:"12"}},[a("a-icon",{class:["header-notice-icon",e.theme],attrs:{type:"bell"}})],1)],1)],2)}),N=[],D={name:"HeaderNotice",data:function(){return{loadding:!1}},computed:{theme:function(){return"side"===this.$store.state.setting.layout?"light":this.$store.state.setting.theme}},methods:{fetchNotice:function(){var e=this;this.loadding?this.loadding=!1:(this.loadding=!0,setTimeout((function(){e.loadding=!1}),2e3))}}},E=D,z=(a("0a78"),Object(u["a"])(E,L,N,!1,null,null,null)),T=(z.exports,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-dropdown",{staticStyle:{display:"inline-block",height:"100%","vertical-align":"initial"}},[a("span",{staticStyle:{cursor:"pointer"}},[a("a-avatar",{staticStyle:{backgroundColor:"#f56a00"},attrs:{size:"large"}},[e._v(" "+e._s(e.currentName)+" ")])],1),a("a-menu",{staticStyle:{width:"150px"},attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{on:{click:e.onEditUser}},[a("a-icon",{attrs:{type:"user"}}),a("span",[e._v("个人中心")])],1),a("a-menu-item",[a("router-link",{attrs:{to:"/login"}},[a("a-icon",{attrs:{type:"poweroff"}}),a("span",[e._v("退出登录")])],1)],1)],1)],1),a("a-modal",{attrs:{title:"用户详情",cancelText:"取消",okText:"保存"},on:{ok:e.editHandleOk},model:{value:e.editVisible,callback:function(t){e.editVisible=t},expression:"editVisible"}},[a("a-form-model",{ref:"ruleForm",attrs:{rules:e.rules,"label-col":{span:6},"wrapper-col":{span:12},model:e.form}},[a("a-form-model-item",{attrs:{label:"用户名",prop:"username"}},[a("a-input",{attrs:{disabled:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("a-form-model-item",{attrs:{label:"姓名",prop:"name"}},[a("a-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("a-form-model-item",{attrs:{label:"当前密码",prop:"currentPassword"}},[a("a-input",{attrs:{type:"password",placeholder:"不填写表示不修改"},model:{value:e.form.currentPassword,callback:function(t){e.$set(e.form,"currentPassword",t)},expression:"form.currentPassword"}})],1),a("a-form-model-item",{attrs:{label:"密码",prop:"password"}},[a("a-input",{attrs:{type:"password",placeholder:"不填写表示不修改"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("a-form-model-item",{attrs:{label:"确认密码",prop:"confirm_password"}},[a("a-input",{attrs:{type:"password",placeholder:"不填写表示不修改"},model:{value:e.form.confirm_password,callback:function(t){e.$set(e.form,"confirm_password",t)},expression:"form.confirm_password"}})],1)],1)],1)],1)}),M=[],R=(a("b0c0"),a("498a"),{name:"HeaderAvatar",data:function(){var e=this;return{fieldsEquals:function(t,a,n){a&&""!==a.trim()||n(),e.form[t.equalTo]!==a?n(new Error(t.message)):(e.$refs.ruleForm.validateField(t.equalTo),n())},editVisible:!1,form:{username:null,name:null,currentPassword:null,password:null,confirm_password:null},rules:null,currentName:null,currUser:null}},mounted:function(){this.currUser=JSON.parse(window.localStorage.getItem("currentUser"));var e=this.currUser;e.name?this.currentName=e.name.substring(e.name.length>=2?e.name.length-2:0):this.currentName=e.username},methods:{onEditUser:function(){this.editVisible=!0,this.form={username:this.currUser.username,name:this.currUser.name,password:null,confirm_password:null},this.rules={name:[{required:!0,message:"请输入姓名",trigger:"blur"}],password:[{validator:this.fieldsEquals,equalTo:"confirm_password",message:"两次密码不相等",trigger:"change"}],confirm_password:[{validator:this.fieldsEquals,equalTo:"password",message:"两次密码不相等",trigger:"change"}]}},editHandleOk:function(){var e=this,t=Object(g["a"])({},this.form);this.$refs.ruleForm.validate((function(a){a&&e.$http.put("/member/user",t).then((function(a){e.$message.success("修改成功"),e.currUser=t,window.localStorage.setItem("currentUser",JSON.stringify(t)),t.name?e.currentName=t.name.substring(t.name.length>=2?t.name.length-2:0):e.currentName=t.username,e.editVisible=!1}))}))}}}),q=R,U=(a("bf8d"),Object(u["a"])(q,T,M,!1,null,"5a0f6389",null)),A=U.exports,K=(a("99af"),a("4160"),a("159b"),a("55f1")),B=a("0c63"),V=K["a"].Item,H=K["a"].SubMenu,G=["dashboard","user","form","setting","message","safety","bell","delete","code-o","poweroff","eye-o","hourglass"],W={name:"IMenu",props:{menuData:{type:Array,required:!0},theme:{type:String,required:!1,default:"dark"},mode:{type:String,required:!1,default:"inline"},collapsed:{type:Boolean,required:!1,default:!1}},data:function(){return{openKeys:[],selectedKeys:[],cachedOpenKeys:[]}},computed:{rootSubmenuKeys:function(e){var t=[];return e.menuData.forEach((function(e){t.push(e.path)})),t}},created:function(){this.updateMenu()},watch:{collapsed:function(e){e?(this.cachedOpenKeys=this.openKeys,this.openKeys=[]):this.openKeys=this.cachedOpenKeys},$route:function(){this.updateMenu()}},methods:{renderIcon:function(e,t){return"none"===t?null:e(B["a"],{props:{type:void 0!==t?t:G[Math.floor(Math.random()*G.length)]}})},renderMenuItem:function(e,t,a,n){return e(V,{key:t.path?t.path:"item_"+a+"_"+n},[e("RouterLink",{attrs:{to:t.path}},[this.renderIcon(e,t.icon),e("span",[t.name])])])},renderSubMenu:function(e,t,a,n){var s=this,r=[e("span",{slot:"title"},[this.renderIcon(e,t.icon),e("span",[t.name])])],i=[],o=a+"_"+n;return t.children.forEach((function(t,a){i.push(s.renderItem(e,t,o,a))})),e(H,{key:t.path?t.path:"submenu_"+a+"_"+n},r.concat(i))},renderItem:function(e,t,a,n){if(!t.invisible)return t.children?this.renderSubMenu(e,t,a,n):this.renderMenuItem(e,t,a,n)},renderMenu:function(e,t){var a=this,n=[];return t.forEach((function(t,s){n.push(a.renderItem(e,t,"0",s))})),n},onOpenChange:function(e){var t=this,a=e.find((function(e){return-1===t.openKeys.indexOf(e)}));-1===this.rootSubmenuKeys.indexOf(a)?this.openKeys=e:this.openKeys=a?[a]:[]},updateMenu:function(){var e=this.$route.matched.concat();this.selectedKeys=[e.pop().path];var t=[];e.forEach((function(e){t.push(e.path)})),this.collapsed||"horizontal"===this.mode?this.cachedOpenKeys=t:this.openKeys=t}},render:function(e){var t=this;return e(K["a"],{props:{theme:this.$props.theme,mode:this.$props.mode,openKeys:this.openKeys,selectedKeys:this.selectedKeys},on:{openChange:this.onOpenChange,select:function(e){t.selectedKeys=e.selectedKeys,t.$emit("select",e)}}},this.renderMenu(e,this.menuData))}},J={name:"GlobalHeader",components:{IMenu:W,HeaderAvatar:A},props:["collapsed","menuData"],computed:{isMobile:function(){return this.$store.state.setting.isMobile},layout:function(){return this.$store.state.setting.layout},theme:function(){return"side"===this.layout?"light":this.$store.state.setting.theme},systemName:function(){return this.$store.state.setting.systemName}},methods:{toggleCollapse:function(){this.$emit("toggleCollapse")},onSelect:function(e){this.$emit("menuSelect",e)}}},X=J,Y=(a("c8c9"),Object(u["a"])(X,j,S,!1,null,"2f8aa3eb",null)),Z=Y.exports,Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"footer"},[a("div",{staticClass:"links"},e._l(e.linkList,(function(t,n){return a("a",{key:n,attrs:{target:"_blank",href:t.link?t.link:"javascript: void(0)"}},[t.icon?a("a-icon",{attrs:{type:t.icon}}):e._e(),e._v(e._s(t.name)+" ")],1)})),0),a("div",{staticClass:"copyright"},[e._v(" Copyright"),a("a-icon",{attrs:{type:"copyright"}}),e._v(e._s(e.copyright)+" ")],1)])},ee=[],te={name:"GlobalFooter",props:["copyright","linkList"]},ae=te,ne=(a("51d3"),Object(u["a"])(ae,Q,ee,!1,null,"f76e51f4",null)),se=(ne.exports,a("eb60")),re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-layout-sider",{class:[e.theme,"sider",e.isMobile?null:"shadow"],attrs:{width:"256px",collapsible:e.collapsible,trigger:null},model:{value:e.collapsed,callback:function(t){e.collapsed=t},expression:"collapsed"}},[n("div",{class:["logo",e.theme]},[n("router-link",{attrs:{to:"/dashboard/workplace"}},[n("img",{attrs:{src:a("20d6")}}),n("h1",[e._v(e._s(e.systemName))])])],1),n("i-menu",{staticClass:"menu",attrs:{theme:e.theme,collapsed:e.collapsed,menuData:e.menuData},on:{select:e.onSelect}})],1)},ie=[],oe={name:"SiderMenu",components:{IMenu:W},props:{collapsible:{type:Boolean,required:!1,default:!1},collapsed:{type:Boolean,required:!1,default:!1},menuData:{type:Array,required:!0},theme:{type:String,required:!1,default:"dark"}},computed:{isMobile:function(){return this.$store.state.setting.isMobile},systemName:function(){return this.$store.state.setting.systemName}},methods:{onSelect:function(e){this.$emit("menuSelect",e)}}},le=oe,ce=(a("6df3"),Object(u["a"])(le,re,ie,!1,null,"0240ef86",null)),ue=ce.exports,de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-layout-sider",{staticClass:"sider",attrs:{width:"273"}},[a("setting-item",{attrs:{title:"整体风格设置"}},[a("img-checkbox-group",{on:{change:e.setTheme}},[a("img-checkbox",{attrs:{img:"https://gw.alipayobjects.com/zos/rmsportal/LCkqqYNmvBEbokSDscrm.svg",checked:!0,value:"dark"}}),a("img-checkbox",{attrs:{img:"https://gw.alipayobjects.com/zos/rmsportal/jpRkZQMyYRryryPNtyIC.svg",value:"light"}})],1)],1),a("setting-item",{attrs:{title:"主题色"}},[a("color-checkbox-group",{attrs:{defaultValues:[5],multiple:!1},on:{change:e.onColorChange}},e._l(e.colors,(function(e,t){return a("color-checkbox",{key:t,attrs:{color:e,value:t}})})),1)],1),a("a-divider"),a("setting-item",{attrs:{title:"导航设置"}},[a("img-checkbox-group",{on:{change:e.setLayout}},[a("img-checkbox",{attrs:{img:"https://gw.alipayobjects.com/zos/rmsportal/JopDzEhOqwOjeNTXkoje.svg",checked:!0,value:"side"}}),a("img-checkbox",{attrs:{img:"https://gw.alipayobjects.com/zos/rmsportal/KDNDBbriJhLwuqMoxcAr.svg",value:"head"}})],1)],1),a("setting-item",[a("a-list",{attrs:{split:!1}},[a("a-list-item",[e._v(" 栅格模式 "),a("a-select",{staticStyle:{width:"80px"},attrs:{slot:"actions",size:"small",defaultValue:"1"},slot:"actions"},[a("a-select-option",{attrs:{value:"1"}},[e._v("流式")]),a("a-select-option",{attrs:{value:"2"}},[e._v("定宽")])],1)],1),a("a-list-item",[e._v(" 固定Header "),a("a-switch",{attrs:{slot:"actions",size:"small"},slot:"actions"})],1),a("a-list-item",[e._v(" 固定Siderbar "),a("a-switch",{attrs:{slot:"actions",size:"small"},slot:"actions"})],1)],1)],1),a("a-divider"),a("setting-item",{attrs:{title:"其他设置"}},[a("a-list",{attrs:{split:!1}},[a("a-list-item",[e._v(" 色弱模式 "),a("a-switch",{attrs:{slot:"actions",size:"small"},slot:"actions"})],1),a("a-list-item",[e._v(" 显示抽屉按钮 "),a("a-switch",{attrs:{slot:"actions",size:"small"},slot:"actions"})],1),a("a-list-item",[e._v(" 多页签模式 "),a("a-switch",{attrs:{slot:"actions",checked:e.multiPage,size:"small"},on:{change:e.setMultiPage},slot:"actions"})],1)],1)],1),a("a-divider"),a("setting-item",{attrs:{title:"页面切换动画"}},[a("a-list",{attrs:{split:!1}},[a("a-list-item",[e._v(" 动画效果 "),a("a-select",{staticClass:"select-item",attrs:{slot:"actions",size:"small"},on:{change:e.setAnimate},slot:"actions",model:{value:e.animate,callback:function(t){e.animate=t},expression:"animate"}},e._l(e.animates,(function(t,n){return a("a-select-option",{key:n,attrs:{value:n}},[e._v(e._s(t.alias))])})),1)],1),a("a-list-item",[e._v(" 动画方向 "),a("a-select",{staticClass:"select-item",attrs:{slot:"actions",size:"small"},on:{change:e.setAnimate},slot:"actions",model:{value:e.direction,callback:function(t){e.direction=t},expression:"direction"}},e._l(e.animateCfg.directions,(function(t,n){return a("a-select-option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1)],1)],1),a("a-button",{staticStyle:{width:"100%"},attrs:{id:"copyBtn","data-clipboard-text":"Sorry, you have copied nothing O(∩_∩)O~",icon:"copy"},on:{click:e.copyCode}},[e._v("拷贝代码")])],1)},me=[],pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"setting-item"},[a("h3",{staticClass:"title"},[e._v(e._s(e.title))]),e._t("default")],2)},he=[],fe={name:"SettingItem",props:["title"]},ge=fe,be=(a("a14d"),Object(u["a"])(ge,pe,he,!1,null,"1f3cc0b5",null)),ve=be.exports,ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"theme-color",style:{backgroundColor:e.color},on:{click:e.toggle}},[e.sChecked?a("a-icon",{attrs:{type:"check"}}):e._e()],1)},ye=[],xe=(a("a9e3"),a("d3b7"),a("ddb0"),{name:"ColorCheckboxGroup",props:{defaultValues:{type:Array,required:!1,default:function(){return[]}},multiple:{type:Boolean,required:!1,default:!1}},data:function(){return{values:[],options:[]}},computed:{colors:function(){var e=[];return this.options.forEach((function(t){t.sChecked&&e.push(t.color)})),e}},provide:function(){return{groupContext:this}},watch:{values:function(){this.$emit("change",this.values,this.colors)},defaultValues:function(e){this.multiple?this.options.forEach((function(t){t.sChecked=e.indexOf(t.value)>-1})):this.options.forEach((function(t){var a=e[0];t.sChecked=a&&a==t.value}))}},methods:{handleChange:function(e){e.checked?this.multiple?this.values.push(e.value):this.options.forEach((function(t){t.value!=e.value&&(t.sChecked=!1)})):this.values=this.values.filter((function(t){return t!==e.value}))}},render:function(e){var t=e("div",{attrs:{style:"clear: both"}});return e("div",{},[this.$slots.default,t])}}),we={name:"ColorCheckbox",Group:xe,props:{color:{type:String,required:!0},value:{type:[String,Number],required:!0},checked:{type:Boolean,required:!1,default:!1}},data:function(){return{sChecked:this.initChecked()}},computed:{},inject:["groupContext"],watch:{sChecked:function(){var e={value:this.value,color:this.color,checked:this.sChecked};this.$emit("change",e);var t=this.groupContext;t&&t.handleChange(e)}},created:function(){var e=this.groupContext;e&&e.options.push(this)},methods:{toggle:function(){this.sChecked=!this.sChecked},initChecked:function(){var e=this.groupContext;return e?e.multiple?e.defaultValues.indexOf(this.value)>-1:e.defaultValues[0]==this.value:this.check}}},_e=we,Ce=(a("f1b2"),Object(u["a"])(_e,ke,ye,!1,null,"2f0f620e",null)),je=Ce.exports,Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"img-check-box",on:{click:e.toggle}},[a("img",{attrs:{src:e.img}}),e.sChecked?a("div",{staticClass:"check-item"},[a("a-icon",{attrs:{type:"check"}})],1):e._e()])},$e=[],Pe={name:"ImgCheckboxGroup",props:{multiple:{type:Boolean,required:!1,default:!1},defaultValues:{type:Array,required:!1,default:function(){return[]}}},data:function(){return{values:[],options:[]}},provide:function(){return{groupContext:this}},watch:{values:function(e,t){1===e.length&&1===t.length&&e[0]===t[0]||this.$emit("change",this.values)}},methods:{handleChange:function(e){e.checked?this.multiple?this.values.push(e.value):(this.values=[e.value],this.options.forEach((function(t){t.value!==e.value&&(t.sChecked=!1)}))):this.values=this.values.filter((function(t){return t!==e.value}))}},render:function(e){return e("div",{attrs:{style:"display: flex"}},[this.$slots.default])}},Fe={name:"ImgCheckbox",Group:Pe,props:{checked:{type:Boolean,required:!1,default:!1},img:{type:String,required:!0},value:{required:!0}},data:function(){return{sChecked:this.checked}},inject:["groupContext"],watch:{sChecked:function(){var e={value:this.value,checked:this.sChecked};this.$emit("change",e);var t=this.groupContext;t&&t.handleChange(e)}},created:function(){var e=this.groupContext;e&&(this.sChecked=e.defaultValues.length>0?e.defaultValues.indexOf(this.value)>=0:this.sChecked,e.options.push(this))},methods:{toggle:function(){this.sChecked=!this.sChecked}}},Oe=Fe,Ie=(a("b644"),Object(u["a"])(Oe,Se,$e,!1,null,"642400c4",null)),Le=Ie.exports,Ne=a("b311"),De=a.n(Ne),Ee=a("9d12"),ze=a.n(Ee),Te=a("2f62"),Me=je.Group,Re=Le.Group,qe={name:"Setting",components:{ImgCheckboxGroup:Re,ImgCheckbox:Le,ColorCheckboxGroup:Me,ColorCheckbox:je,SettingItem:ve},data:function(){return{animate:0,direction:0,colors:["#f5222d","#fa541c","#faad14","#13c2c2","#52c41a","#1d92ff","#2f54eb","#722ed1"]}},watch:{animate:function(){this.direction=0}},computed:Object(g["a"])({animateCfg:function(){return this.animates[this.animate]}},Object(Te["b"])("setting",["animates","multiPage"])),methods:{onColorChange:function(e,t){if(t.length>0){var a=this.$message.loading("您选择了主题色 ".concat(t,", 正在切换..."));ze.a.changeThemeColor(t[0]).then(a)}},setTheme:function(e){this.$store.commit("setting/setTheme",e[0])},setLayout:function(e){this.$store.commit("setting/setLayout",e[0])},copyCode:function(){var e=new De.a("#copyBtn"),t=this;e.on("success",(function(){t.$message.success("复制成功"),e.destroy()}))},setMultiPage:function(e){this.$store.commit("setting/setMultiPage",e)},setAnimate:function(){var e=this.animates[this.animate],t={name:e.name,direction:e.directions[this.direction]};this.$store.commit("setting/setAnimate",t)}}},Ue=qe,Ae=(a("6050"),Object(u["a"])(Ue,de,me,!1,null,"e3bfc2c0",null)),Ke=(Ae.exports,window.innerHeight-64-122),Be=[],Ve={name:"GlobalLayout",components:{SiderMenu:ue,GlobalHeader:Z},data:function(){return{locale:se["a"],minHeight:Ke+"px",collapsed:!1,menuData:Be,showSetting:!1}},provide:function(){return{layoutMinHeight:Ke}},computed:{isMobile:function(){return this.$store.state.setting.isMobile},theme:function(){return this.$store.state.setting.theme},layout:function(){return this.$store.state.setting.layout},linkList:function(){return this.$store.state.setting.footerLinks},copyright:function(){return this.$store.state.setting.copyright}},methods:{toggleCollapse:function(){this.collapsed=!this.collapsed},onDrawerChange:function(e){this.collapsed=e},onMenuSelect:function(){this.toggleCollapse()},onSettingDrawerChange:function(e){this.showSetting=e}},beforeCreate:function(){Be=this.$router.options.routes.find((function(e){return"/"===e.path})).children}},He=Ve,Ge=(a("5924"),Object(u["a"])(He,_,C,!1,null,"5fb1e77c",null)),We=Ge.exports,Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-menu",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"contextmenu",style:e.style,attrs:{selectedKeys:e.selectedKeys},on:{click:e.handleClick}},e._l(e.itemList,(function(t){return a("a-menu-item",{key:t.key},[t.icon?a("a-icon",{attrs:{role:"menuitemicon",type:t.icon}}):e._e(),e._v(e._s(t.text)+" ")],1)})),1)},Xe=[],Ye={name:"Contextmenu",props:{visible:{type:Boolean,required:!1,default:!1},itemList:{type:Array,required:!0,default:function(){return[]}}},data:function(){return{left:0,top:0,target:null,selectedKeys:[]}},computed:{style:function(){return{left:this.left+"px",top:this.top+"px"}}},created:function(){var e=this;window.addEventListener("mousedown",(function(t){return e.closeMenu(t)})),window.addEventListener("contextmenu",(function(t){return e.setPosition(t)}))},methods:{closeMenu:function(e){["menuitemicon","menuitem"].indexOf(e.target.getAttribute("role"))<0&&this.$emit("update:visible",!1)},setPosition:function(e){this.left=e.clientX,this.top=e.clientY,this.target=e.target},handleClick:function(e){var t=e.key;this.$emit("select",t,this.target),this.$emit("update:visible",!1)}}},Ze=Ye,Qe=(a("4635"),Object(u["a"])(Ze,Je,Xe,!1,null,"73dd8bda",null)),et=Qe.exports,tt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{"enter-active-class":"animated "+e.enterAnimate+" page-toggle-enter-active","leave-active-class":"animated "+e.leaveAnimate+" page-toggle-leave-active"}},[e._t("default")],2)},at=[],nt=a("f121"),st={name:"PageToggleTransition",props:{animate:{type:String,validator:function(e){return-1!=nt["animates"].find((function(t){return t.name==e}))},default:"bounce"},direction:{type:String,validator:function(e){return["x","y","left","right","up","down","downLeft","upRight","downRight","upLeft","downBig","upBig","downLeft","downRight","topRight","bottomLeft","topLeft","bottomRight","default"].indexOf(e)>-1}},reverse:{type:Boolean,default:!0}},computed:{enterAnimate:function(){return this.activeClass(!1)},leaveAnimate:function(){return this.activeClass(!0)}},methods:{activeClass:function(e){var t=this,a=nt["animates"].find((function(e){return t.animate==e.name}));if(void 0==a)return"";var n="";n=void 0==this.direction?a.directions[0]:a.directions.find((function(e){return e==t.direction})),n=void 0==n||"default"===n?"":n,""!=n&&(n=e&&this.reverse?this.reversePosition(n,a.directions):n,n=n[0].toUpperCase()+n.substring(1));var s=e?"Out":"In";return a.name+s+n},reversePosition:function(e,t){if(0==e.length||"x"==e||"y"==e)return e;var a=t.indexOf(e);return a=a%2==1?a-1:a+1,t[a]}}},rt=st,it=(a("39be"),Object(u["a"])(rt,tt,at,!1,null,null,null)),ot=it.exports,lt={name:"MenuView",components:{PageToggleTransition:ot,Contextmenu:et,GlobalLayout:We},data:function(){return{pageList:[],linkList:[],activePage:"",menuVisible:!1,menuItemList:[{key:"1",icon:"arrow-left",text:"关闭左侧"},{key:"2",icon:"arrow-right",text:"关闭右侧"},{key:"3",icon:"close",text:"关闭其它"}]}},computed:Object(g["a"])({},Object(Te["b"])("setting",["multiPage","animate"])),created:function(){this.pageList.push(this.$route),this.linkList.push(this.$route.fullPath),this.activePage=this.$route.fullPath},watch:{$route:function(e){this.activePage=e.fullPath,this.multiPage?this.linkList.indexOf(e.fullPath)<0&&(this.linkList.push(e.fullPath),this.pageList.push(e)):(this.linkList=[e.fullPath],this.pageList=[e])},activePage:function(){},multiPage:function(e){e||(this.linkList=[this.$route.fullPath],this.pageList=[this.$route])}},methods:{changePage:function(e){this.$router.push(e),this.activePage=e},editPage:function(e,t){this[t](e)},remove:function(e){if(1!==this.pageList.length){this.pageList=this.pageList.filter((function(t){return t.fullPath!==e}));var t=this.linkList.indexOf(e);this.linkList=this.linkList.filter((function(t){return t!==e})),t=t>=this.linkList.length?this.linkList.length-1:t,this.activePage=this.linkList[t]}else this.$message.warning("这是最后一页，不能再关闭了啦")},onContextmenu:function(e){var t=this.getPageKey(e.target);null!==t&&(e.preventDefault(),this.menuVisible=!0)},getPageKey:function(e,t){if(t=t||0,t>2)return null;var a=e.getAttribute("pagekey");return a=a||(e.previousElementSibling?e.previousElementSibling.getAttribute("pagekey"):null),a||(e.firstElementChild?this.getPageKey(e.firstElementChild,++t):null)},onMenuSelect:function(e,t){var a=this.getPageKey(t);switch(e){case"1":this.closeLeft(a);break;case"2":this.closeRight(a);break;case"3":this.closeOthers(a);break;default:break}},closeOthers:function(e){var t=this.linkList.indexOf(e);this.linkList=this.linkList.slice(t,t+1),this.pageList=this.pageList.slice(t,t+1),this.activePage=this.linkList[0]},closeLeft:function(e){var t=this.linkList.indexOf(e);this.linkList=this.linkList.slice(t),this.pageList=this.pageList.slice(t),this.linkList.indexOf(this.activePage)<0&&(this.activePage=this.linkList[0])},closeRight:function(e){var t=this.linkList.indexOf(e);this.linkList=this.linkList.slice(0,t+1),this.pageList=this.pageList.slice(0,t+1),this.linkList.indexOf(this.activePage<0)&&(this.activePage=this.linkList[this.linkList.length-1])}}},ct=lt,ut=(a("313c"),Object(u["a"])(ct,x,w,!1,null,"7c2b154c",null)),dt=ut.exports,mt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-layout",{attrs:{desc:e.desc,title:e.title,linkList:e.linkList}},[a("div",{staticClass:"extraImg",attrs:{slot:"extra"},slot:"extra"},[a("img",{attrs:{src:e.extraImage}})]),a("page-toggle-transition",{attrs:{animate:e.animate.name,direction:e.animate.direction}},[e.multiPage?a("keep-alive",[a("router-view",{ref:"page"})],1):a("router-view",{ref:"page"})],1)],1)},pt=[],ht=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-layout"},[a("page-header",{attrs:{breadcrumb:e.breadcrumb,title:e.title,logo:e.logo,avatar:e.avatar}},[e._t("action",null,{slot:"action"}),e._t("headerContent",null,{slot:"content"}),!this.$slots.headerContent&&e.desc?a("div",{attrs:{slot:"content"},slot:"content"},[a("p",{staticStyle:{"font-size":"14px","line-height":"1.5",color:"rgba(0,0,0,.65)"}},[e._v(e._s(e.desc))]),a("div",{staticClass:"link"},[e._l(e.linkList,(function(t,n){return[a("a",{key:n,attrs:{href:t.href}},[a("a-icon",{attrs:{type:t.icon}}),e._v(" "+e._s(t.title))],1)]}))],2)]):e._e(),this.$refs.extra?e._t("extra",null,{slot:"extra"}):e._e()],2),a("div",{ref:"page",class:["page-content",e.layout]},[e._t("default")],2)],1)},ft=[],gt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-header"},[a("div",{class:["page-header-wide",e.layout]},[a("div",{staticClass:"breadcrumb"},[a("a-breadcrumb",e._l(e.breadcrumb,(function(t,n){return a("a-breadcrumb-item",{key:t.path},[a("span",0===n?[a("a",{attrs:{href:"#/dashboard/workplace"}},[e._v(e._s(t.name))])]:[e._v(e._s(t.name))])])})),1)],1),a("div",{staticClass:"detail"},[e.avatar?a("div",{staticClass:"avatar"},[a("a-avatar",{attrs:{src:e.avatar}})],1):e._e(),a("div",{staticClass:"main"},[a("div",{staticClass:"row"},[e.logo?a("img",{staticClass:"logo",attrs:{src:e.logo}}):e._e(),e.title?a("h1",{staticClass:"title"},[e._v(e._s(e.title))]):e._e(),a("div",{staticClass:"action"},[e._t("action")],2)]),a("div",{staticClass:"row"},[this.$slots.content?a("div",{staticClass:"content"},[e._t("content")],2):e._e(),this.$slots.extra?a("div",{staticClass:"extra"},[e._t("extra")],2):e._e()])])])])])},bt=[],vt={name:"PageHeader",props:{title:{type:String,required:!1},breadcrumb:{type:Array,required:!1},logo:{type:String,required:!1},avatar:{type:String,required:!1}},computed:{layout:function(){return this.$store.state.setting.layout}}},kt=vt,yt=(a("b72d"),Object(u["a"])(kt,gt,bt,!1,null,"5b233f52",null)),xt=yt.exports,wt={name:"PageLayout",components:{PageHeader:xt},props:["desc","logo","title","avatar","linkList","extraImage"],data:function(){return{breadcrumb:[]}},computed:{layout:function(){return this.$store.state.setting.layout}},mounted:function(){this.getBreadcrumb()},updated:function(){this.getBreadcrumb()},methods:{getBreadcrumb:function(){this.breadcrumb=this.$route.matched}}},_t=wt,Ct=(a("de19"),Object(u["a"])(_t,ht,ft,!1,null,"726d4cb1",null)),jt=Ct.exports,St={name:"PageView",components:{PageToggleTransition:ot,PageLayout:jt},data:function(){return{title:"",desc:"",linkList:[],extraImage:""}},computed:Object(g["a"])({},Object(Te["b"])("setting",["multiPage","animate"])),mounted:function(){this.getPageHeaderInfo()},updated:function(){this.getPageHeaderInfo()},methods:{getPageHeaderInfo:function(){this.title=this.$route.name;var e=this.$refs.page;e&&(this.desc=e.desc,this.linkList=e.linkList,this.extraImage=e.extraImage)}}},$t=St,Pt=(a("37a7"),Object(u["a"])($t,mt,pt,!1,null,"25ed08f4",null)),Ft=Pt.exports,Ot=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("SearchForm",{on:{handleSearch:e.handleSearch}},[a("a-row",[a("a-button",{attrs:{type:"primary"},on:{click:e.onAdd}},[e._v("添加")])],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.data,pagination:e.pagination,rowKey:function(e,t){return t}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"isEnable",fn:function(t){return a("span",{style:t?"":{color:"red"}},[e._v(" "+e._s(t?"启用":"禁用")+" ")])}},{key:"locked",fn:function(t){return a("span",{style:t?{color:"red"}:""},[e._v(" "+e._s(t?"是":"否")+" ")])}},{key:"isAdmin",fn:function(t){return a("span",{style:t?{color:"red"}:""},[e._v(" "+e._s(t?"是":"否")+" ")])}},{key:"action",fn:function(t,n){return a("span",{},[a("a",{on:{click:function(t){return e.onEdit(n)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"是否删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.unlock(n)}}},[a("a",[e._v("解锁")])]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"是否删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.onDelete(n.id)}}},[a("a",{staticStyle:{color:"red"}},[e._v("删除")])])],1)}}])})],1),a("div",[a("a-modal",{attrs:{title:"用户详情",cancelText:"取消",okText:"保存"},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-form-model",{ref:"ruleForm",attrs:{rules:e.rules,"label-col":{span:6},"wrapper-col":{span:12},model:e.form}},[a("a-form-model-item",{attrs:{label:"用户名",prop:"username"}},[a("a-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("a-form-model-item",{attrs:{label:"姓名",prop:"name"}},[a("a-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("a-form-model-item",{attrs:{label:"密码",prop:"password"}},[a("a-input",{attrs:{type:"password",placeholder:"不填写表示不修改"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("a-form-model-item",{attrs:{label:"确认密码",prop:"confirm_password"}},[a("a-input",{attrs:{type:"password",placeholder:"不填写表示不修改"},model:{value:e.form.confirm_password,callback:function(t){e.$set(e.form,"confirm_password",t)},expression:"form.confirm_password"}})],1),a("a-form-model-item",{attrs:{label:"是否启用",prop:"isEnable"}},[a("a-switch",{model:{value:e.form.isEnable,callback:function(t){e.$set(e.form,"isEnable",t)},expression:"form.isEnable"}})],1),a("a-form-model-item",{attrs:{label:"是否管理员",prop:"isAdmin"}},[a("a-switch",{model:{value:e.form.isAdmin,callback:function(t){e.$set(e.form,"isAdmin",t)},expression:"form.isAdmin"}})],1)],1)],1)],1)],1)},It=[],Lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"components-form-demo-advanced-search"}},[a("a-form-model",{ref:"searchForm",staticClass:"ant-advanced-search-form",attrs:{model:e.form},on:{submit:e.handleSearch}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{key:1,attrs:{span:6}},[a("a-form-item",{attrs:{label:"用户名",prop:"username"}},[a("a-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1)],1),a("a-col",{staticStyle:{"text-align":"left","margin-top":"4px"},attrs:{span:16}},[a("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v(" 查询 ")])],1)],1)],1),a("div",{staticClass:"search-result-list"},[e._t("default")],2)],1)},Nt=[],Dt={data:function(){return{form:{username:""}}},methods:{handleSearch:function(e){var t=this;e.preventDefault(),this.$refs.searchForm.validate((function(e){e&&t.$emit("handleSearch",t.$mt.deepCopy(t.form))}))}}},Et=Dt,zt=(a("9450"),Object(u["a"])(Et,Lt,Nt,!1,null,null,null)),Tt=zt.exports,Mt=[{title:"用户名",dataIndex:"username"},{title:"姓名",dataIndex:"name"},{title:"是否管理员",dataIndex:"isAdmin",scopedSlots:{customRender:"isAdmin"}},{title:"是否启用",dataIndex:"isEnable",scopedSlots:{customRender:"isEnable"}},{title:"是否被锁定",dataIndex:"locked",scopedSlots:{customRender:"locked"}},{title:"创建时间",dataIndex:"createdDate"},{title:"修改时间",dataIndex:"updatedDate"},{title:"操作",scopedSlots:{customRender:"action"}}],Rt={data:function(){var e=this;return{fieldsEquals:function(t,a,n){a&&""!==a.trim()||n(),e.form[t.equalTo]!==a?n(new Error(t.message)):(e.$refs.ruleForm.validateField(t.equalTo),n())},data:[],columns:Mt,pagination:{pageSizeOptions:["10","20","50","100"],pageSize:10,showSizeChanger:!0,showTotal:function(e,t){return"数据总数："+e}},visible:!1,form:{id:null,username:"",name:"",password:"",confirm_password:"",isEnable:!0,isAdmin:!1},rules:{}}},mounted:function(){this.fetch()},methods:{unlock:function(e){var t=this;this.$http.put("/admin/user/unlock/"+e.username).then((function(e){t.$message.success("解锁成功!"),t.fetch()}))},handleSearch:function(e){this.fetch(Object(g["a"])({pageSize:this.pagination.pageSize,pageNum:1},e))},onAdd:function(){this.form={id:null,username:"",password:"",confirm_password:"",isEnable:!0,isAdmin:!1},this.rules={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:this.fieldsEquals,equalTo:"confirm_password",message:"两次密码不相等",trigger:"change"}],confirm_password:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:this.fieldsEquals,equalTo:"password",message:"两次密码不相等",trigger:"change"}]},this.showModal()},onEdit:function(e){this.form=this.$mt.deepCopy(e),this.form.password=null,this.rules={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],password:[{validator:this.fieldsEquals,equalTo:"confirm_password",message:"两次密码不相等",trigger:"change"}],confirm_password:[{validator:this.fieldsEquals,equalTo:"password",message:"两次密码不相等",trigger:"change"}]},this.showModal()},onDelete:function(e){var t=this;this.$http.delete("/admin/user/"+e).then((function(e){t.fetch(),t.$message.success("删除成功")}))},handleTableChange:function(e,t,a){var n=Object(g["a"])({},this.pagination);n.current=e.current,this.pagination=n,this.fetch(Object(g["a"])({pageSize:e.pageSize,pageNum:e.current,sortField:a.field,sortOrder:a.order},t))},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pageNum:1,pageSize:10};this.$http.get("/admin/user/page/list",{params:t}).then((function(t){var a=t.data.result,n=Object(g["a"])({},e.pagination);n.total=a.total,n.pageSize=a.pageSize,e.data=a.list,e.pagination=n}))},showModal:function(){this.visible=!0},handleOk:function(e){var t=this,a=this.$mt.deepClone(this.form);this.$refs.ruleForm.validate((function(e){if(!e)return!1;a.id?t.$http.put("/admin/user",a).then((function(e){t.$message.success("更新成功！"),t.visible=!1,t.fetch()})):t.$http.post("/admin/user",a).then((function(e){t.$message.success("新增成功！"),t.visible=!1,t.fetch()}))}))}},components:{SearchForm:Tt}},qt=Rt,Ut=Object(u["a"])(qt,Ot,It,!1,null,"8e939d74",null),At=Ut.exports,Kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("a-row",[a("a-button",{attrs:{type:"primary"},on:{click:e.onAdd}},[e._v("添加")])],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.data,pagination:e.pagination,rowKey:function(e,t){return e.id},expandedRowKeys:e.expandedRowKeys},on:{expand:e.expand,change:e.handleTableChange},scopedSlots:e._u([{key:"owner",fn:function(t,n){return a("span",{},[n.isOwn?a("a-tag",{attrs:{color:"#108ee9"}},[e._v(e._s(t))]):a("a-tag",{attrs:{color:"#87d068"}},[e._v(e._s(t))])],1)}},{key:"defaultIsPublic",fn:function(t){return a("span",{},[t?a("a-tag",{attrs:{color:"#f50"}},[e._v("公开")]):a("a-tag",{attrs:{color:"#87d068"}},[e._v("私有")])],1)}},{key:"action",fn:function(t,n){return a("span",{},[a("a",{on:{click:function(t){return e.onEdit(n)}}},[e._v("编辑")]),n.isOwn?a("span",[a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.onGrant(n)}}},[e._v("授权")])],1):e._e(),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticStyle:{color:"red"},on:{click:function(t){return e.onGenerate(n)}}},[e._v("新增秘钥")]),a("a-divider",{attrs:{type:"vertical"}}),n.isOwn?a("a-popconfirm",{attrs:{title:"是否删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.onDelete(n.id)}}},[a("a",{staticStyle:{color:"red"}},[e._v("删除")])]):e._e()],1)}}])},[a("a-table",{attrs:{slot:"expandedRowRender",rowKey:function(e,t){return e.openId},columns:e.innerColumns,"data-source":e.innerData,pagination:!1},slot:"expandedRowRender",scopedSlots:e._u([{key:"secretKey",fn:function(t){return a("a-tooltip",{},[a("template",{slot:"title"},[e._v(" "+e._s(t)+" ")]),a("div",{staticStyle:{width:"200px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[e._v(e._s(t)+" ")])],2)}},{key:"action",fn:function(t,n){return a("span",{},[a("a",{staticStyle:{"margin-right":"10px"},on:{click:function(t){return e.onUpdateAccess(n)}}},[e._v("编辑")]),a("a-popconfirm",{attrs:{title:"是否删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.onDeleteOpenId(n)}}},[a("a",{staticStyle:{color:"red"}},[e._v("删除")])])],1)}}])})],1),a("div",[a("a-modal",{attrs:{title:"bucket详情"},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-form-model",{ref:"ruleForm",attrs:{rules:e.rules,"label-col":{span:6},"wrapper-col":{span:12},model:e.form}},[a("a-form-model-item",{attrs:{label:"桶名称",prop:"bucketName"}},[a("a-input",{model:{value:e.form.bucketName,callback:function(t){e.$set(e.form,"bucketName",t)},expression:"form.bucketName"}})],1),a("a-form-model-item",{attrs:{label:"数据分片",prop:"dataFragmentsAmount"}},[a("a-input-number",{staticStyle:{width:"100%"},model:{value:e.form.dataFragmentsAmount,callback:function(t){e.$set(e.form,"dataFragmentsAmount",t)},expression:"form.dataFragmentsAmount"}})],1),a("a-form-model-item",{attrs:{label:"默认权限",prop:"defaultIsPublic"}},[a("a-radio-group",{model:{value:e.form.defaultIsPublic,callback:function(t){e.$set(e.form,"defaultIsPublic",t)},expression:"form.defaultIsPublic"}},[a("a-radio",{attrs:{value:!0}},[e._v("公开")]),a("a-radio",{attrs:{value:!1}},[e._v("私有")])],1)],1)],1)],1),a("a-modal",{attrs:{title:"秘钥详情"},on:{ok:e.accessHandleOk},model:{value:e.accessVisible,callback:function(t){e.accessVisible=t},expression:"accessVisible"}},[a("a-form-model",{ref:"accessForm",attrs:{"label-col":{span:6},"wrapper-col":{span:12},model:e.accessForm}},[a("a-form-model-item",{attrs:{label:"用途",prop:"useInfo"}},[a("a-input",{model:{value:e.accessForm.useInfo,callback:function(t){e.$set(e.accessForm,"useInfo",t)},expression:"accessForm.useInfo"}})],1)],1)],1),a("a-modal",{attrs:{title:"授权",width:"700px"},on:{ok:e.grantOk},model:{value:e.grantVisible,callback:function(t){e.grantVisible=t},expression:"grantVisible"}},[a("a-transfer",{attrs:{"data-source":e.userData,"show-search":"","list-style":{width:"250px",height:"300px"},operations:["添加授权","删除授权"],"target-keys":e.grantUserKeys,render:function(e){return""+e.username}},on:{change:e.handleGrantChange}},[a("span",{attrs:{slot:"notFoundContent"},slot:"notFoundContent"},[e._v(" 没数据 ")])])],1)],1)],1)},Bt=[],Vt=(a("d81d"),[{title:"所有者",dataIndex:"owner",scopedSlots:{customRender:"owner"}},{title:"名称",dataIndex:"bucketName"},{title:"默认权限",dataIndex:"defaultIsPublic",scopedSlots:{customRender:"defaultIsPublic"}},{title:"分片数",dataIndex:"dataFragmentsAmount"},{title:"创建时间",dataIndex:"createdDate"},{title:"修改时间",dataIndex:"updatedDate"},{title:"操作",scopedSlots:{customRender:"action"}}]),Ht=[{title:"openId",dataIndex:"openId"},{title:"用途",dataIndex:"useInfo"},{title:"私钥",dataIndex:"secretKey",scopedSlots:{customRender:"secretKey"},ellipsis:!0},{title:"创建时间",dataIndex:"createdDate"},{title:"修改时间",dataIndex:"updatedDate"},{title:"操作",scopedSlots:{customRender:"action"}}],Gt={data:function(){return{data:[],columns:Vt,innerColumns:Ht,innerData:[],innerDatas:[],expandedRowKeys:[],expandedRow:{},pagination:!1,visible:!1,accessVisible:!1,form:{id:null,bucketName:"",defaultIsPublic:!1,dataFragmentsAmount:1},accessForm:{openId:null,bucketName:null,publicKey:null,privateKey:null,useInfo:""},rules:{bucketName:[{required:!0,message:"请输入桶名称",trigger:"blur"}]},grantVisible:!1,userData:[],grantUserKeys:[],targetKeys:[],currentGrantBucketId:null}},mounted:function(){this.fetch()},methods:{onGenerate:function(e){this.accessForm={openId:null,bucketName:e.bucketName,publicKey:null,privateKey:null,useInfo:""},this.accessVisible=!0},onUpdateAccess:function(e){this.accessForm=Object(g["a"])({},e),this.accessVisible=!0},accessHandleOk:function(){var e=this,t=this.accessForm;t.openId?this.$http.put("/member/access/"+t.bucketName+"/"+t.openId,t).then((function(t){e.fetchExpandedRow(),e.accessVisible=!1,e.$message.success("修改成功")})):this.$http.post("/member/access/"+t.bucketName,t).then((function(t){e.fetchExpandedRow(),e.accessVisible=!1,e.$message.success("新增成功")}))},expand:function(e,t){e?(this.expandedRowKeys=[t.id],this.expandedRow=t,this.innerData=[],this.fetchExpandedRow()):this.expandedRowKeys=[]},fetchExpandedRow:function(){var e=this;this.$http.get("/member/access/"+this.expandedRow.bucketName).then((function(t){e.innerData=t.data.result}))},onAdd:function(){this.form={id:null,bucketName:"",defaultIsPublic:!1,dataFragmentsAmount:1},this.showModal()},onEdit:function(e){this.form=this.$mt.deepCopy(e),this.showModal()},onDelete:function(e){var t=this;this.$http.delete("/member/bucket?id="+e).then((function(e){t.fetch(),t.$message.success("删除成功")}))},onDeleteOpenId:function(e){var t=this;this.$http.delete("/member/access/".concat(e.bucketName,"/").concat(e.openId)).then((function(e){t.fetchExpandedRow(),t.$message.success("删除成功")}))},handleTableChange:function(e,t,a){this.fetch()},fetch:function(){var e=this;this.$http.get("/member/bucket/list").then((function(t){e.data=t.data.result}))},showModal:function(){this.visible=!0},handleOk:function(e){var t=this,a=this.$mt.deepClone(this.form);this.$refs.ruleForm.validate((function(e){if(!e)return!1;a.id?t.$http.put("/member/bucket",a).then((function(e){t.$message.success("更新成功！"),t.visible=!1,t.fetch()})):t.$http.post("/member/bucket",a).then((function(e){t.$message.success("新增成功！"),t.visible=!1,t.fetch()}))}))},onGrant:function(e){var t=this;this.grantVisible=!0,this.$http.get("/member/bucket/grant/list",{params:{bucketId:e.id}}).then((function(e){t.userData=e.data.result.allUsers,t.grantUserKeys=e.data.result.userKeys})),this.currentGrantBucketId=e.id},handleGrantChange:function(e,t,a){this.grantUserKeys=e},grantOk:function(){var e=this;this.$http.post("/member/bucket/grant",{bucketId:this.currentGrantBucketId,userIds:this.grantUserKeys.map((function(e){return parseFloat(e)}))}).then((function(t){e.$message.success("授权成功"),e.grantVisible=!1}))}},components:{}},Wt=Gt,Jt=Object(u["a"])(Wt,Kt,Bt,!1,null,"98f3723a",null),Xt=Jt.exports,Yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("a-row",{staticStyle:{"margin-bottom":"10px"}},[a("div",{staticClass:"tool-btns"},[a("a-button",{attrs:{type:"primary"},on:{click:e.onAdd}},[e._v("上传")]),a("a-button",{attrs:{type:"primary",disabled:0===this.selectedRowKeys.length},on:{click:e.onBatchDelete}},[e._v("批量删除 ")]),a("a-input-search",{staticStyle:{"margin-left":"15px",width:"200px"},attrs:{placeholder:"输入搜索内容"},on:{search:function(t){return e.onSearch()},change:function(t){return e.pressEnter()}},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}}),a("a-select",{staticStyle:{width:"150px",float:"right"},model:{value:e.currentBucket,callback:function(t){e.currentBucket=t},expression:"currentBucket"}},e._l(e.buckets,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.bucketName}},[e._v(" "+e._s(t.bucketName)+" ")])})),1)],1)]),a("div",{staticStyle:{margin:"10px"}},[a("a",{staticClass:"dir-nav",attrs:{disabled:!e.lastDir},on:{click:function(t){return e.onBack(e.lastDir)}}},[a("a-icon",{attrs:{type:"rollback"}})],1),e.parentDirs.length>0?a("span",e._l(e.parentDirs,(function(t){return a("a",{key:t.path,staticClass:"dir-nav",staticStyle:{"margin-left":"10px"},on:{"~click":function(a){return e.changeCurrentPath(t)}}},[e._v(e._s(t.path))])})),0):e._e(),a("span",{staticClass:"current",staticStyle:{"margin-left":"10px"}},[e._v(" "+e._s(e.currentDir.path)+" ")])]),a("a-table",{attrs:{columns:e.columns,"data-source":e.data,pagination:e.pagination,"row-selection":e.rowSelection,rowKey:function(e){return e.id},scroll:{x:1500}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"name",fn:function(t,n){return a("span",{},[n.isDir?a("span",[a("icon-font",{staticClass:"resource-icon",staticStyle:{"font-size":"18px"},attrs:{type:"icon-weibiaoti-_huabanfuben"}}),a("a",{class:e.getResourceClass(n),attrs:{id:n.id},on:{click:function(t){return e.changeCurrentPath(n)}}},[e._v(" /"+e._s(n.fileName)+" ")])],1):a("span",[n.icon?a("icon-font",{staticClass:"resource-icon",staticStyle:{"font-size":"16px"},attrs:{type:n.icon}}):a("icon-font",{staticClass:"resource-icon",staticStyle:{"font-size":"16px"},attrs:{type:"icon-wenjian"}}),n.image?a("a",{class:e.getResourceClass(n),attrs:{id:n.id},on:{click:function(t){return e.showImages("/mos/"+e.currentBucket+n.urlEncodePath,n)}}},[e._v(" "+e._s(n.fileName)+" ")]):a("a",{class:e.getResourceClass(n),attrs:{id:n.id,href:"/mos/"+e.currentBucket+n.urlEncodePath,target:"_blank"},on:{click:function(t){return e.onRecentClick(n)}}},[e._v(" "+e._s(n.fileName)+" ")])],1)])}},{key:"isPublic",fn:function(t,n){return a("span",{},[n.isDir?e._e():a("span",[t?a("a-tag",{attrs:{color:"#f50"}},[e._v("公开")]):a("a-tag",{attrs:{color:"#87d068"}},[e._v("私有")])],1)])}},{key:"action",fn:function(t,n){return a("span",{},[a("a-popconfirm",{attrs:{title:"是否删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.onDelete(n,n.isDir?"delDir":"delFile")}}},[a("a",{staticStyle:{color:"red"}},[e._v("删除")])]),n.isDir?e._e():a("span",[a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.onEditResource(n)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.openGenAddr(n)}}},[e._v("访问链")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{attrs:{href:"/mos/"+e.currentBucket+n.urlEncodePath+"?download=true"}},[e._v("下载")])],1)],1)}}])}),a("div",[a("a-modal",{attrs:{title:"上传",okText:"上传",confirmLoading:e.uploading,maskClosable:!1,destroyOnClose:!0},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-form",{attrs:{form:e.form}},[e.uploading||e.uploadProgress.errorMsg?a("span",[a("span",[e._v("（"+e._s(e.uploadProgress.fileIndex)+"/"+e._s(e.uploadProgress.files)+"）["+e._s(e.uploadProgress.current)+"] "+e._s(e.uploadProgress.errorMsg?"上传失败："+e.uploadProgress.errorMsg:"上传中..."))]),a("a-progress",{attrs:{percent:e.uploadProgress.uploadPercent,status:e.uploadProgress.errorMsg?"exception":"active"}})],1):e._e(),a("a-form-item",e._b({attrs:{label:"桶"}},"a-form-item",e.formItemLayout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["bucketName",{rules:[{required:!0,message:"请选择桶"}]}],expression:"['bucketName',{rules: [{required: true,message: '请选择桶',}],},]"}]},e._l(e.buckets,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.bucketName}},[e._v(" "+e._s(t.bucketName)+" ")])})),1)],1),a("a-form-item",e._b({attrs:{label:"是否覆盖"}},"a-form-item",e.formItemLayout,!1),[a("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["cover"],expression:"['cover']"}],on:{change:e.onCoverChange}})],1),a("a-form-item",e._b({attrs:{label:"权限"}},"a-form-item",e.formItemLayout,!1),[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isPublic",{initialValue:!1}],expression:"['isPublic',{initialValue:false}]"}]},[a("a-radio",{attrs:{value:!0}},[e._v("公开")]),a("a-radio",{attrs:{value:!1}},[e._v("私有")])],1)],1),a("a-form-item",e._b({attrs:{label:"响应头"}},"a-form-item",e.formItemLayout,!1),[a("a-auto-complete",{directives:[{name:"decorator",rawName:"v-decorator",value:["contentType"],expression:"['contentType']"}],attrs:{"data-source":e.contentTypeDataSource},on:{search:e.onContentTypeSearch}})],1),a("a-form-item",e._b({attrs:{label:"文件"}},"a-form-item",e.formItemLayout,!1),[a("a-upload",{attrs:{"file-list":e.fileList,multiple:!0,remove:e.handleRemove,"before-upload":e.beforeUpload}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(" 选择 ")],1)],1)],1),e._l(e.fileList,(function(t,n){return a("a-form-item",e._b({key:n,attrs:{label:"文件"+(n+1),"has-feedback":!1}},"a-form-item",e.formItemLayout,!1),[a("a-input-search",{directives:[{name:"decorator",rawName:"v-decorator",value:["pathnames["+n+"]",{rules:[{required:!0,message:"文件名必填"},{validator:e.checkPathname}]}],expression:"['pathnames['+index+']',{rules: [{required: true,message: '文件名必填'},{\n\t\t\t\t\t\t\t    validator:checkPathname,\n\t\t\t\t\t\t\t}],},]"}],attrs:{type:"text"},on:{search:function(a){return e.handleRemove(t)}}},[a("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[a("a-icon",{attrs:{type:"delete"}})],1)],1)],1)}))],2)],1),a("a-modal",{attrs:{title:"访问链详情",okText:"生成"},on:{ok:e.addrHandleOk},model:{value:e.addrVisible,callback:function(t){e.addrVisible=t},expression:"addrVisible"}},[a("a-form-model",{ref:"addrForm",attrs:{"label-col":{span:6},"wrapper-col":{span:12},model:e.addrForm}},[a("a-form-model-item",{attrs:{label:"秘钥"}},[a("a-select",{model:{value:e.addrForm.openId,callback:function(t){e.$set(e.addrForm,"openId",t)},expression:"addrForm.openId"}},e._l(e.openIds,(function(t){return a("a-select-option",{key:t.openId,attrs:{value:t.openId}},[e._v(e._s(t.useInfo?t.useInfo:t.openId)+" ")])})),1)],1),a("a-form-model-item",{attrs:{label:"桶",prop:"bucketName"}},[a("a-input",{attrs:{disabled:""},model:{value:e.addrForm.bucketName,callback:function(t){e.$set(e.addrForm,"bucketName",t)},expression:"addrForm.bucketName"}})],1),a("a-form-model-item",{attrs:{label:"文件",prop:"fileName"}},[a("a-input",{attrs:{disabled:""},model:{value:e.addrForm.fileName,callback:function(t){e.$set(e.addrForm,"fileName",t)},expression:"addrForm.fileName"}})],1),a("a-form-model-item",{attrs:{label:"有效时间",prop:"expireNumber"}},[a("a-input",{staticStyle:{width:"100%"},attrs:{min:1,disabled:e.addrForm.isPublic||"ever"===e.addrForm.expireUnit,type:"number"},model:{value:e.addrForm.expireNumber,callback:function(t){e.$set(e.addrForm,"expireNumber",t)},expression:"addrForm.expireNumber"}},[a("a-select",{staticStyle:{width:"70px"},attrs:{slot:"addonAfter",disabled:e.addrForm.isPublic},on:{change:e.onExpireUnitChange},slot:"addonAfter",model:{value:e.addrForm.expireUnit,callback:function(t){e.$set(e.addrForm,"expireUnit",t)},expression:"addrForm.expireUnit"}},[a("a-select-option",{attrs:{value:"minute"}},[e._v("分钟")]),a("a-select-option",{attrs:{value:"hour"}},[e._v("小时")]),a("a-select-option",{attrs:{value:"day"}},[e._v("天")]),a("a-select-option",{attrs:{value:"month"}},[e._v("月")]),a("a-select-option",{attrs:{value:"year"}},[e._v("年")]),a("a-select-option",{attrs:{value:"ever"}},[e._v("永久")])],1)],1)],1),a("a-form-model-item",{attrs:{label:"访问链",prop:"signUrl"}},[a("a-input",{attrs:{type:"textarea"},model:{value:e.addrForm.signUrl,callback:function(t){e.$set(e.addrForm,"signUrl",t)},expression:"addrForm.signUrl"}})],1)],1)],1),a("a-modal",{attrs:{title:"资源详情",confirmLoading:e.saving,okText:"保存"},on:{ok:e.editHandleOk},model:{value:e.editVisible,callback:function(t){e.editVisible=t},expression:"editVisible"}},[a("a-form-model",{ref:"editForm",attrs:{rules:e.editRules,"label-col":{span:6},"wrapper-col":{span:12},model:e.editForm}},[a("a-form-model-item",{attrs:{label:"资源名",prop:"pathname"}},[a("a-input",{on:{pressEnter:e.editHandleOk},model:{value:e.editForm.pathname,callback:function(t){e.$set(e.editForm,"pathname",t)},expression:"editForm.pathname"}})],1),a("a-form-model-item",{attrs:{label:"权限",prop:"isPublic"}},[a("a-radio-group",{model:{value:e.editForm.isPublic,callback:function(t){e.$set(e.editForm,"isPublic",t)},expression:"editForm.isPublic"}},[a("a-radio",{attrs:{value:!0}},[e._v("公开")]),a("a-radio",{attrs:{value:!1}},[e._v("私有")])],1)],1),a("a-form-model-item",{attrs:{label:"响应头",prop:"contentType"}},[a("a-auto-complete",{attrs:{"data-source":e.contentTypeDataSource},on:{search:e.onContentTypeSearch},model:{value:e.editForm.contentType,callback:function(t){e.$set(e.editForm,"contentType",t)},expression:"editForm.contentType"}})],1)],1)],1),a("viewer",{ref:"viewer",staticClass:"viewer",attrs:{trigger:e.images},on:{inited:e.inited}},e._l(e.images,(function(e){return a("img",{key:e,staticStyle:{display:"none"},attrs:{src:e}})})),0)],1)],1)},Zt=[],Qt=(a("a15b"),a("a434"),a("b85c")),ea=a("2909"),ta=a("1157"),aa=a.n(ta),na=(a("baa5"),a("69a0")),sa=a.n(na),ra={setThat:function(e){n=e},splitFile:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2097152,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10485760,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,s=e.size,r=Math.ceil(s/n);r<t?r=t:r>a&&(r=a);var i=Math.ceil(s/r);i<1&&(i=1);for(var o=[],l=0;l<i;l++){var c=void 0;c=l===i-1?e.slice(l*r,s):e.slice(l*r,(l+1)*r),o.push(c)}return{totalSize:s,chunks:i,partSize:r,uploadParts:o}},md5File:function(e,t,a){var n=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,s=2097152,r=Math.ceil(e.size/s),i=0,o=new sa.a.ArrayBuffer,l=new FileReader;function c(){var t=i*s,a=t+s>=e.size?e.size:t+s;l.readAsArrayBuffer(n.call(e,t,a))}l.onload=function(e){o.append(e.target.result),i++,null!=a&&a(r,i),i<r?c():t(o.end())},l.onerror=function(){console.warn("oops, something went wrong.")},c()},getFileName:function(e){var t=e.lastIndexOf("/");return-1!==t?e.substring(t+1):e},doUploadPart:function(e,t,a,s,r,i,o,l,c,u,d,m,p){var h=this;if(t>=e.length)p();else{var f=e[t].uploadPart,g=e[t].chunkIndex;this.md5File(f,(function(b){var v=new FormData;v.append("cover",s),v.append("contentType",r),v.append("isPublic",i),v.append("file",f),v.append("pathname",o),v.append("totalMd5",l),v.append("totalSize",c),v.append("chunkMd5",b),v.append("chunkSize",f.size),v.append("chunkIndex",g);var k=h.getFileName(o);n.$http.post("/upload/"+a,v).then((function(n){console.log("分片"+g+"上传结果:"+n.data.status),h.updateUploadProgress(!1,k,d,m+1,1,1,u,g+1),t++,h.doUploadPart(e,t,a,s,r,i,o,l,c,u,d,m,p)}),(function(e){n.uploading=!1,n.uploadProgress.errorMsg=e,console.log(o+"上传失败：",e)}))}))}},updateUploadProgress:function(e,t,a,s,r,i,o,l){var c=e?100:5*i/r+l/o*94;c=Math.floor(c),n.uploadProgress={current:t,files:a,fileIndex:s,uploadPercent:c}},uploadFile:function(e,t,a,s,r,i,o,l){var c=this;if(t>=e.length)l();else{var u=e[t],d=s[t],m=this.splitFile(u),p=m.chunks,h=m.totalSize,f=m.uploadParts;n.uploading=!0;var g=this.getFileName(d);n.uploadProgress.current=g,console.log(m),this.md5File(u,(function(m){var b={pathname:d,chunks:p,totalMd5:m,totalSize:h,contentType:o,isPublic:i,cover:r};n.$http.post("/upload/".concat(a,"/init"),n.$mt.transformFormData(b)).then((function(b){var v=b.data.result,k=v.fileExists,y=v.existedChunkIndexs;if(k)console.log(d+"上传完成！"),c.updateUploadProgress(!0,g,n.fileList.length,t+1,1,1,1,1),t++,c.uploadFile(e,t,a,s,r,i,o,l);else{var x=[];f.forEach((function(e,t){n.$mt.contains(y,t)||x.push({uploadPart:e,chunkIndex:t})})),c.doUploadPart(x,0,a,r,o,i,d,m,h,p,n.fileList.length,t,(function(){var p=new FormData;p.append("cover",r),p.append("contentType",o),p.append("isPublic",i),p.append("file",u),p.append("pathname",d),p.append("totalMd5",m),p.append("totalSize",h),p.append("bucketName",a),n.$http.post("/upload/mergeFiles?wait=true",p).then((function(u){console.log(d+"上传完成！"),c.updateUploadProgress(!0,g,n.fileList.length,t+1,1,1,1,1),t++,c.uploadFile(e,t,a,s,r,i,o,l)}),(function(e){n.uploading=!1,n.uploadProgress.errorMsg=e,console.log(d+"上传失败：",e)}))}))}}),(function(e){n.uploading=!1,n.uploadProgress.errorMsg=e,console.log(d+"上传失败：",e)}))}),(function(a,n){c.updateUploadProgress(!1,g,e.length,t+1,a,n,1,0)}))}},initUploadProgress:function(){n.uploadProgress={files:n.fileList.length,fileIndex:1,current:"",uploadPercent:0,errorMsg:null}},genAddr:function(){if(n.addrForm.openId){n.addrForm.signUrl="";var e=Object(g["a"])({},n.addrForm),t=1,a=parseInt(n.addrForm.expireNumber);if(a<1)n.$message.warn("时间不能小于1");else{switch(n.addrForm.expireUnit){case"minute":t=60;break;case"hour":t=3600;break;case"day":t=86400;break;case"month":t=2592e3;break;case"year":t=94608e4;break;case"ever":t=-1,a=1;break}e.expireSeconds=t*a,n.$http.post("/member/access/sign",e).then((function(e){n.addrForm.signUrl=e.data.result}))}}else n.$message.warn("请先创建一个秘钥!")},showImages:function(e,t){t&&n.onRecentClick(t);for(var a=0;a<n.images.length;a++)-1!==n.images[a].indexOf(e)&&n.$viewer.view(a)},popHandler:function(e){var t=e.state;t&&t.path&&n.changeCurrentPath({path:t.path,urlEncodePath:t.urlEncodePath},t,!0)},fetchBucket:function(){n.$http.get("/member/bucket/list").then((function(e){n.buckets=e.data.result,n.currentBucket=n.buckets[0].bucketName}))},getHistoryParams:function(e){e=e||{};var t={pageNum:n.pagination.current,pageSize:n.pagination.pageSize,path:n.currentDir.path,urlEncodePath:n.currentDir.urlEncodePath,keyWord:n.keyWord,sortField:n.sortField,sortOrder:n.sortOrder,currentBucket:n.currentBucket};aa.a.extend(t,e);var a="/resource?";for(var s in t){var r=n.queryAlias[s],i=t[s];i&&r&&(a+=r+"="+encodeURIComponent(i)+"&")}return a=a.substring(0,a.length-1),t.url=a,t},addHistory:function(e){var t=this.getHistoryParams(e);history.pushState(t,null,t.url)}},ia=ra,oa=[{title:"文件名",dataIndex:"name",width:300,scopedSlots:{customRender:"name"},sorter:!0},{title:"文件大小",dataIndex:"readableSize",width:120,sorter:!0},{title:"权限",dataIndex:"isPublic",width:120,scopedSlots:{customRender:"isPublic"},sorter:!0},{title:"响应头",dataIndex:"contentType",width:200},{title:"修改时间",dataIndex:"updatedDate",width:160,sorter:!0},{title:"修改人",dataIndex:"updatedBy",width:120,sorter:!0},{title:"操作",width:220,scopedSlots:{customRender:"action"}}],la=B["a"].createFromIconfontCN({scriptUrl:"//at.alicdn.com/t/font_1836787_2a565rchgum.js"}),ca={data:function(){var e=this;return{locations:{lastLocation:[],current:{}},images:[],checkPathname:function(t,a,n){""===a&&n(),/[:*?"<>|,]/.test(a)&&n(new Error('资源名不能包含: * ? " < > | ,')),e.cover&&n();var s=e.form.getFieldValue("bucketName");e.$http.get("/upload/".concat(s,"/isExists"),{params:{pathname:a}}).then((function(e){var t=e.data.result;t?n(new Error("资源已存在")):n()}))},lastDir:null,parentDirs:[],currentBucket:null,currentDir:{path:"/",urlEncodePath:"/"},data:[],columns:oa,pagination:{pageSizeOptions:["10","20","50","100"],pageSize:10,showSizeChanger:!0,showTotal:function(e,t){return"数据总数："+e}},visible:!1,form:{bucketName:"",pathnames:[]},keyWord:"",rules:{bucketName:[{required:!0,message:"请选择bucket",trigger:"blur"}]},buckets:[],fileList:[],formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},uploading:!1,uploadProgress:{current:"",fileIndex:1,files:1,uploadPercent:0},saving:!1,selectedRowKeys:[],addrVisible:!1,cover:!1,addrForm:{signUrl:"",openId:null,resourceId:null,expireSeconds:3600,bucketId:null,expireNumber:2,expireUnit:"hour"},openIds:[],editVisible:!1,editForm:{pathname:null,isPublic:!1,contentType:null},editRules:{},allContentTypes:["text/html;charset=UTF-8","text/xml;charset=UTF-8","text/plain;charset=UTF-8","application/json;charset=UTF-8","application/octet-stream","application/pdf","text/markdown;charset=UTF-8","text/event-stream;charset=UTF-8","image/png","image/jpeg","image/gif","application/xml","application/xhtml+xml","application/stream+json","application/rss+xml","application/problem+xml","application/problem+json;charset=UTF-8","application/problem+json"],contentTypeDataSource:[],sortField:null,sortOrder:null,queryAlias:{pageNum:"n",pageSize:"s",urlEncodePath:"p",keyWord:"k",sortField:"f",sortOrder:"o",currentBucket:"b"},historyClicks:[],refreshed:!0}},computed:{rowSelection:function(){var e=this,t=this.selectedRowKeys;return{selectedRowKeys:t,columnWidth:"40px",onChange:this.onSelectChange,hideDefaultSelections:!0,selections:[{key:"dirs",text:"文件夹",onSelect:function(t){var a=[];a=t.filter((function(t,a){return e.data[a].isDir})),e.selectedRowKeys=a}},{key:"files",text:"文件",onSelect:function(t){var a=[];a=t.filter((function(t,a){return!e.data[a].isDir})),e.selectedRowKeys=a}}],onSelection:this.onSelection}}},destroyed:function(){window.removeEventListener("popstate",ia.popHandler)},mounted:function(){ia.setThat(this),window.addEventListener("popstate",ia.popHandler,!1),ia.fetchBucket();var e=this.$route.query;e&&(e.n&&(this.pagination.current=parseInt(e.n)),e.s&&(this.pagination.pageSize=parseInt(e.s)),e.p&&(this.currentDir.urlEncodePath=e.p),e.k&&(this.keyWord=e.k),e.f&&(this.sortField=e.f),e.o&&(this.sortOrder=e.o),e.b&&(this.currentBucket=e.b)),this.contentTypeDataSource=Object(ea["a"])(this.allContentTypes),aa()(".ant-table-body").css("overflow-x","auto")},watch:{"addrForm.expireNumber":function(){this.addrForm.expireNumber<1&&(this.addrForm.expireNumber=1)},currentBucket:function(){var e=this.pagination;if(this.refreshed){var t=e.current?e.current:1;this.refreshed=!1,this.fetch({pageNum:t,pageSize:e.pageSize,path:this.currentDir.urlEncodePath,keyWord:this.keyWord,sortField:this.sortField,sortOrder:this.sortOrder})}else this.fetch({pageNum:1,pageSize:e.pageSize,path:"/",keyWord:"",sortField:this.sortField,sortOrder:this.sortOrder})},data:function(){var e=this;this.images=this.data.filter((function(e){return e.image})).map((function(t){return"/mos/".concat(e.currentBucket).concat(t.urlEncodePath)}))}},methods:{showImages:function(e,t){ia.showImages(e,t)},getResourceClass:function(e){var t,a=!1,n=Object(Qt["a"])(this.historyClicks);try{for(n.s();!(t=n.n()).done;){var s=t.value;if(s===e.path){a=!0;break}}}catch(r){n.e(r)}finally{n.f()}return"resource-link "+(a?"activeAnchor":"")},onRecentClick:function(e){this.historyClicks.push(e.path)},inited:function(e){this.$viewer=e},onSearch:function(){this.fetch({pageNum:1,pageSize:this.pagination.pageSize,path:this.currentDir.urlEncodePath,keyWord:this.keyWord,sortField:this.sortField,sortOrder:this.sortOrder})},openGenAddr:function(e){var t=this;this.addrForm={signUrl:null,openId:null,isPublic:e.isPublic,fileName:e.fileName,resourceId:e.id,expireSeconds:3600,expireNumber:1,expireUnit:"hour",bucketName:this.currentBucket},this.addrVisible=!0,this.$http.get("/member/access/"+this.currentBucket).then((function(a){t.openIds=a.data.result,t.addrForm.openId=t.openIds[0].openId,e.isPublic&&ia.genAddr()}))},onExpireUnitChange:function(e){"ever"===e&&(this.addrForm.expireNumber=1),this.addrForm.signUrl=""},addrHandleOk:function(){ia.genAddr()},onSelectChange:function(e,t){this.selectedRowKeys=e},onAdd:function(){var e=this;this.currentBucket?(this.form={bucketName:this.currentBucket,pathname:this.currentDir.path},ia.initUploadProgress(),this.$nextTick().then((function(t){e.form.setFieldsValue({bucketName:e.currentBucket,pathnames:[]})})),this.cover=!1,this.uploadPercent=0,this.fileList=[],this.form=this.$form.createForm(this,{name:"register"}),this.visible=!0):this.$message.warn("您还没有桶，请先去创建一个吧")},onBack:function(e){history.back()},changeCurrentPath:function(e,t,a){var n=this;this.onRecentClick(e),a=void 0!==a&&a;var s={pageNum:1,pageSize:this.pagination.pageSize,path:e?e.urlEncodePath:"/",keyWord:this.keyWord,sortField:this.sortField,sortOrder:this.sortOrder,ignoreHistory:a};t=t||{},aa.a.extend(s,t,{path:e?e.urlEncodePath:"/"}),this.fetch(s,(function(){n.currentDir=e}))},onDelete:function(e,t){var a=this,n={};n="delFile"===t?{fileIds:e.id}:{dirIds:e.id},this.$http.delete("/member/resource/".concat(this.currentBucket,"/del"),{params:n}).then((function(e){a.$message.success("删除成功"),a.reload()}))},onBatchDelete:function(){var e=[],t=[],a=this.data,n=this.selectedRowKeys,s=n.map((function(e){var t,n=Object(Qt["a"])(a);try{for(n.s();!(t=n.n()).done;){var s=t.value;if(s.id===e)return s}}catch(r){n.e(r)}finally{n.f()}})),r=s.filter((function(e){return e.isDir})).map((function(e){return e.path})),i=s.filter((function(e){return!e.isDir})).map((function(e){return e.path}));e=s.filter((function(e){return e.isDir})).map((function(e){return e.id})),t=s.filter((function(e){return!e.isDir})).map((function(e){return e.id})),r.push(i);var o=this;this.$confirm({title:"确定删除这些资源吗?",content:r.join(","),okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){var a={fileIds:t.join(","),dirIds:e.join(",")};o.$http.delete("/member/resource/".concat(o.currentBucket,"/del"),{params:a}).then((function(e){o.$message.success("删除成功"),o.selectedRowKeys=[],o.reload()}))}})},handleTableChange:function(e,t,a){var n=Object(g["a"])({},this.pagination);n.current=e.current,n.pageSize=e.pageSize,this.pagination=n,a&&a.order?(this.sortField=a.field,this.sortOrder=a.order):(this.sortField=null,this.sortOrder=null),this.reload()},reload:function(){var e=this.pagination;this.fetch({pageNum:e.current,pageSize:e.pageSize,path:this.currentDir.urlEncodePath,keyWord:this.keyWord,sortField:this.sortField,sortOrder:this.sortOrder})},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pageNum:1,pageSize:10,path:this.currentDir.urlEncodePath,keyWord:this.keyWord,sortField:null,sortOrder:null},a=arguments.length>1?arguments[1]:void 0;this.$http.get("/member/resource/"+this.currentBucket+t.path,{params:t}).then((function(n){var s=n.data.result;e.currentDir=s.currentDir?s.currentDir:{path:"/",urlEncodePath:"/"},e.parentDirs=s.parentDirs,e.lastDir=s.lastDir;var r=Object(g["a"])({},e.pagination);s.resources?(r.current=s.resources.pageNum,e.data=Object(ea["a"])(s.resources.list),r.total=s.resources.total,r.pageSize=s.resources.pageSize):(e.data=[],r.total=0),e.pagination=r,t.ignoreHistory||ia.addHistory(),a&&a()}))},handleOk:function(e){var t=this;this.form.validateFieldsAndScroll((function(e,a){if(!e){var n=a.pathnames,s=a.bucketName,r=void 0!==a.cover&&a.cover,i=void 0!==a.isPublic&&a.isPublic,o=void 0===a.contentType?"":a.contentType;ia.initUploadProgress(),ia.uploadFile(t.fileList,0,s,n,r,i,o,(function(){t.uploading=!1,t.$message.success("上传成功!"),t.visible=!1,t.reload()}))}}))},handleRemove:function(e){var t=this.fileList.indexOf(e),a=this.fileList.slice();a.splice(t,1);var n=this.form.getFieldValue("pathnames"),s=n.slice();s.splice(t,1);var r=this.form.getFieldsError().pathnames,i=r.slice();i.splice(t,1),this.form.setFieldsValue({pathnames:s});for(var o=0;o<i.length;o++)i[o]&&this.form.validateFields(["pathnames[".concat(o,"]")]);this.fileList=a},getUploadPathname:function(e){var t;return t="/"===this.currentDir.path?this.currentDir.path+e:this.currentDir.path+"/"+e,t},onCoverChange:function(e){this.cover=e,this.form.validateFields()},beforeUpload:function(e){var t,a=this,n=Object(Qt["a"])(this.fileList);try{for(n.s();!(t=n.n()).done;){var s=t.value;if(s.name===e.name)return!1}}catch(l){n.e(l)}finally{n.f()}this.fileList.push(e);var r=this.getUploadPathname(e.name),i={},o="pathnames[".concat(this.fileList.length-1,"]");return i[o]=r,this.$nextTick().then((function(e){a.form.setFieldsValue(i),a.form.validateFields([o])})),!1},onEditResource:function(e){this.saving=!1,this.editForm=Object(g["a"])({},e),this.editForm.pathname=e.path,this.editVisible=!0},editHandleOk:function(){var e=this;this.saving=!0,this.$http.put("/member/resource/".concat(this.currentBucket,"/").concat(this.editForm.id),this.editForm).then((function(t){e.$message.success("更新成功"),e.reload(),e.saving=!1,e.editVisible=!1}),(function(t){e.saving=!1}))},onContentTypeSearch:function(e){this.contentTypeDataSource=this.allContentTypes.filter((function(t){return-1!==t.indexOf(e)}))}},components:{IconFont:la}},ua=ca,da=(a("826c"),Object(u["a"])(ua,Yt,Zt,!1,null,"d4ee5352",null)),ma=da.exports;s["a"].use(p["a"]);var pa=function(){var e=JSON.parse(window.localStorage.getItem("currentUser"));return e=e||{},[{path:"/signin",name:"登录",component:y},{path:"*",redirect:"/signin"},{path:"/",component:dt,redirect:"/signin",children:[{path:"/content",name:"MOS",icon:"inbox",component:Ft,children:[{path:"/user",name:"用户管理",component:At,icon:"none",invisible:!e.isAdmin},{path:"/bucket",name:"桶管理",component:Xt,icon:"none"},{path:"/resource",name:"资源管理",component:ma,icon:"none"}]}]}]},ha=new p["a"]({routes:pa(),mode:"history",getRoutes:pa}),fa=a("bc3a"),ga=a.n(fa),ba=a("1a47"),va=a.n(ba),ka=a("16b2"),ya=new ka["a"]("admindb"),xa={namespaced:!0,state:{user:{}},mutations:{setuser:function(e,t){e.user=t,ya.get("currUser").then((function(e){ya.put({_id:"currUser",_rev:e._rev,user:t})})).catch((function(e){if(404!==e.status)throw e;ya.put({_id:"currUser",user:t})}))}}},wa={namespaced:!0,state:{isMobile:!1,theme:"dark",layout:"side",systemName:"MOS对象存储",copyright:"668mt",multiPage:!1,animates:nt["animates"],animate:{name:"bounce",direction:"left"}},mutations:{setDevice:function(e,t){e.isMobile=t},setTheme:function(e,t){e.theme=t},setLayout:function(e,t){e.layout=t},setMultiPage:function(e,t){e.multiPage=t},setAnimate:function(e,t){e.animate=t}}};s["a"].use(Te["a"]);var _a=new Te["a"].Store({modules:{account:xa,setting:wa}}),Ca=(a("81ca"),a("0808"),a("6944")),ja=a.n(Ca);s["a"].use(ja.a,{defaultOptions:{zIndex:9999,inline:!1,toolbar:!0,tooltip:!0,movable:!0,zoomable:!0,rotatable:!1,scalable:!1,transition:!0,fullscreen:!1,keyboard:!0,url:"src"}}),s["a"].prototype.$http=ga.a,s["a"].prototype.$mt=va.a,s["a"].config.productionTip=!1,s["a"].use(r["a"]),ga.a.defaults.withCredentials=!0,ga.a.interceptors.response.use((function(e){if("ok"!==e.data.status)throw s["a"].prototype.$message.error(e.data.message),e.data.message;return e}),(function(e){e.request.responseURL.endsWith("/signin")&&(s["a"].prototype.$message.error("登录已过期"),setTimeout((function(){ha.replace({name:"登录"})}),1500))})),ha.beforeEach((function(e,t,a){ha.options.routes=ha.options.getRoutes(),a()})),new s["a"]({router:ha,store:_a,render:function(e){return e(m)}}).$mount("#app")},5924:function(e,t,a){"use strict";var n=a("e620"),s=a.n(n);s.a},6050:function(e,t,a){"use strict";var n=a("5573"),s=a.n(n);s.a},"692c":function(e,t,a){},"6a18":function(e,t,a){},"6df3":function(e,t,a){"use strict";var n=a("3728"),s=a.n(n);s.a},"7be9":function(e,t,a){},"7d93":function(e,t,a){},"7fb9":function(e,t,a){},8121:function(e,t,a){},"826c":function(e,t,a){"use strict";var n=a("f820"),s=a.n(n);s.a},"85ec":function(e,t,a){},"90bc":function(e,t,a){},9450:function(e,t,a){"use strict";var n=a("dee9"),s=a.n(n);s.a},"97bf":function(e,t,a){},"9d12":function(e,t){e.exports={getThemeColors:function(e){},changeThemeColor:function(e){}}},a14d:function(e,t,a){"use strict";var n=a("692c"),s=a.n(n);s.a},b644:function(e,t,a){"use strict";var n=a("e166"),s=a.n(n);s.a},b72d:function(e,t,a){"use strict";var n=a("7be9"),s=a.n(n);s.a},bf0d:function(e,t,a){},bf50:function(e,t,a){"use strict";var n=a("0e76"),s=a.n(n);s.a},bf8d:function(e,t,a){"use strict";var n=a("f8ac"),s=a.n(n);s.a},c8c9:function(e,t,a){"use strict";var n=a("7d93"),s=a.n(n);s.a},cb7b:function(e,t,a){"use strict";var n=a("97bf"),s=a.n(n);s.a},d1f9:function(e,t,a){},de19:function(e,t,a){"use strict";var n=a("314d"),s=a.n(n);s.a},dee9:function(e,t,a){},e166:function(e,t,a){},e620:function(e,t,a){},f121:function(e,t,a){e.exports={themeColor:"#1890ff",animates:a("3148"),footerLinks:[{link:"https://pro.ant.design",name:"Pro首页"},{link:"https://github.com/iczer/vue-antd-admin",icon:"github"},{link:"https://ant.design",name:"Ant Design"}]}},f1b2:function(e,t,a){"use strict";var n=a("6a18"),s=a.n(n);s.a},f820:function(e,t,a){},f8ac:function(e,t,a){}});
//# sourceMappingURL=app.7f034b9b.js.map